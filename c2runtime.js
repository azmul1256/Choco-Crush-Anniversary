// Generated by Construct 3, the game and app creator :: https://www.construct.net
/*
 localForage -- Offline Storage, Improved
    Version 1.5.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
'use strict';var cr=window.cr={};cr.plugins_={};cr.behaviors={};"function"!==typeof Object.getPrototypeOf&&(Object.getPrototypeOf="object"===typeof"test".__proto__?function(b){return b.__proto__}:function(b){return b.constructor.prototype});
(function(){function b(f,y){this.x=f;this.y=y;cr.seal(this)}function e(f,y,L,P){this.set(f,y,L,P);cr.seal(this)}function h(){this.bly=this.blx=this.bry=this.brx=this.try_=this.trx=this.tly=this.tlx=0;cr.seal(this)}function r(f,y,L,P){f<y?L<P?(J=f<L?f:L,R=y>P?y:P):(J=f<P?f:P,R=y>L?y:L):L<P?(J=y<L?y:L,R=f>P?f:P):(J=y<P?y:P,R=f>L?f:L)}function z(){this.items=this.s=null;this.item_count=0;E&&(this.s=new Set);this.values_cache=[];this.cache_valid=!0;cr.seal(this)}function N(f){V[Z++]=f}function k(){this.sum=
this.t=this.y=this.c=0;cr.seal(this)}function a(f,y){f||(f=[0,0,1,0,1,1,0,1]);this.pts_cache=[];this.bboxBottom=this.bboxRight=this.bboxTop=this.bboxLeft=0;this.convexpolys=null;this.enabled="undefined"===typeof y?!0:y;this.set_pts(f);cr.seal(this)}function c(f,y){this.cellwidth=f;this.cellheight=y;this.cells={}}function l(f,y){this.cellwidth=f;this.cellheight=y;this.cells={}}function q(f,y,L){c.prototype.totalCellCount++;if(d.length){var P=d.pop();P.grid=f;P.x=y;P.y=L;return P}return new cr.GridCell(f,
y,L)}function p(f,y,L){this.grid=f;this.x=y;this.y=L;this.objects=new cr.ObjectSet}function w(f,y,L){l.prototype.totalCellCount++;if(m.length){var P=m.pop();P.grid=f;P.x=y;P.y=L;return P}return new cr.RenderCell(f,y,L)}function K(f,y,L){this.grid=f;this.x=y;this.y=L;this.objects=[];this.is_sorted=!0;this.pending_removal=new cr.ObjectSet;this.any_pending_removal=!1}function A(f,y){return f.zindex-y.zindex}cr.logexport=function(f){window.console&&window.console.log&&window.console.log(f)};cr.logerror=
function(f){window.console&&window.console.error&&window.console.error(f)};cr.seal=function(f){return f};cr.freeze=function(f){return f};cr.is_undefined=function(f){return"undefined"===typeof f};cr.is_number=function(f){return"number"===typeof f};cr.is_string=function(f){return"string"===typeof f};cr.isPOT=function(f){return 0<f&&0===(f-1&f)};cr.nextHighestPowerOfTwo=function(f){--f;for(var y=1;32>y;y<<=1)f|=f>>y;return f+1};cr.abs=function(f){return 0>f?-f:f};cr.max=function(f,y){return f>y?f:y};
cr.min=function(f,y){return f<y?f:y};cr.PI=Math.PI;cr.round=function(f){return f+.5|0};cr.floor=function(f){return 0<=f?f|0:(f|0)-1};cr.ceil=function(f){var y=f|0;return y===f?y:y+1};b.prototype.offset=function(f,y){this.x+=f;this.y+=y;return this};b.prototype.mul=function(f,y){this.x*=f;this.y*=y;return this};cr.vector2=b;cr.segments_intersect=function(f,y,L,P,X,ba,aa,ca){if(f<L){var ja=f;var ha=L}else ja=L,ha=f;if(X<aa){var g=X;var u=aa}else g=aa,u=X;if(ha<g||ja>u)return!1;y<P?(ja=y,ha=P):(ja=P,
ha=y);ba<ca?(g=ba,u=ca):(g=ca,u=ba);if(ha<g||ja>u)return!1;ha=X-f+aa-L;ja=ba-y+ca-P;f=L-f;y=P-y;X=aa-X;ba=ca-ba;ca=cr.abs(y*X-ba*f);return cr.abs(X*ja-ba*ha)>ca?!1:cr.abs(f*ja-y*ha)<=ca};e.prototype.set=function(f,y,L,P){this.left=f;this.top=y;this.right=L;this.bottom=P};e.prototype.copy=function(f){this.left=f.left;this.top=f.top;this.right=f.right;this.bottom=f.bottom};e.prototype.width=function(){return this.right-this.left};e.prototype.height=function(){return this.bottom-this.top};e.prototype.offset=
function(f,y){this.left+=f;this.top+=y;this.right+=f;this.bottom+=y;return this};e.prototype.normalize=function(){if(this.left>this.right){var f=this.left;this.left=this.right;this.right=f}this.top>this.bottom&&(f=this.top,this.top=this.bottom,this.bottom=f)};e.prototype.intersects_rect=function(f){return!(f.right<this.left||f.bottom<this.top||f.left>this.right||f.top>this.bottom)};e.prototype.intersects_rect_off=function(f,y,L){return!(f.right+y<this.left||f.bottom+L<this.top||f.left+y>this.right||
f.top+L>this.bottom)};e.prototype.contains_pt=function(f,y){return f>=this.left&&f<=this.right&&y>=this.top&&y<=this.bottom};e.prototype.equals=function(f){return this.left===f.left&&this.top===f.top&&this.right===f.right&&this.bottom===f.bottom};cr.rect=e;h.prototype.set_from_rect=function(f){this.tlx=f.left;this.tly=f.top;this.trx=f.right;this.try_=f.top;this.brx=f.right;this.bry=f.bottom;this.blx=f.left;this.bly=f.bottom};h.prototype.set_from_rotated_rect=function(f,y){if(0===y)this.set_from_rect(f);
else{var L=Math.sin(y),P=Math.cos(y);y=f.left*L;var X=f.top*L,ba=f.right*L;L*=f.bottom;var aa=f.left*P,ca=f.top*P,ja=f.right*P;f=f.bottom*P;this.tlx=aa-X;this.tly=ca+y;this.trx=ja-X;this.try_=ca+ba;this.brx=ja-L;this.bry=f+ba;this.blx=aa-L;this.bly=f+y}};h.prototype.offset=function(f,y){this.tlx+=f;this.tly+=y;this.trx+=f;this.try_+=y;this.brx+=f;this.bry+=y;this.blx+=f;this.bly+=y;return this};var J=0,R=0;h.prototype.bounding_box=function(f){r(this.tlx,this.trx,this.brx,this.blx);f.left=J;f.right=
R;r(this.tly,this.try_,this.bry,this.bly);f.top=J;f.bottom=R};h.prototype.contains_pt=function(f,y){var L=this.tlx,P=this.tly,X=this.trx-L,ba=this.try_-P,aa=this.brx-L,ca=this.bry-P;f-=L;y-=P;var ja=X*X+ba*ba,ha=X*aa+ba*ca;ba=X*f+ba*y;var g=aa*aa+ca*ca,u=aa*f+ca*y,D=1/(ja*g-ha*ha);X=(g*ba-ha*u)*D;ja=(ja*u-ha*ba)*D;if(0<=X&&0<ja&&1>X+ja)return!0;X=this.blx-L;ba=this.bly-P;ja=X*X+ba*ba;ha=X*aa+ba*ca;ba=X*f+ba*y;D=1/(ja*g-ha*ha);X=(g*ba-ha*u)*D;ja=(ja*u-ha*ba)*D;return 0<=X&&0<ja&&1>X+ja};h.prototype.at=
function(f,y){if(y)switch(f){case 0:return this.tlx;case 1:return this.trx;case 2:return this.brx;case 3:return this.blx;case 4:return this.tlx;default:return this.tlx}else switch(f){case 0:return this.tly;case 1:return this.try_;case 2:return this.bry;case 3:return this.bly;case 4:return this.tly;default:return this.tly}};h.prototype.midX=function(){return(this.tlx+this.trx+this.brx+this.blx)/4};h.prototype.midY=function(){return(this.tly+this.try_+this.bry+this.bly)/4};h.prototype.intersects_segment=
function(f,y,L,P){if(this.contains_pt(f,y)||this.contains_pt(L,P))return!0;var X;for(X=0;4>X;X++){var ba=this.at(X,!0);var aa=this.at(X,!1);var ca=this.at(X+1,!0);var ja=this.at(X+1,!1);if(cr.segments_intersect(f,y,L,P,ba,aa,ca,ja))return!0}return!1};h.prototype.intersects_quad=function(f){var y=f.midX(),L=f.midY();if(this.contains_pt(y,L))return!0;y=this.midX();L=this.midY();if(f.contains_pt(y,L))return!0;var P,X;for(P=0;4>P;P++)for(X=0;4>X;X++){y=this.at(P,!0);L=this.at(P,!1);var ba=this.at(P+1,
!0);var aa=this.at(P+1,!1);var ca=f.at(X,!0);var ja=f.at(X,!1);var ha=f.at(X+1,!0);var g=f.at(X+1,!1);if(cr.segments_intersect(y,L,ba,aa,ca,ja,ha,g))return!0}return!1};cr.quad=h;cr.RGB=function(f,y,L){return Math.max(Math.min(f,255),0)|Math.max(Math.min(y,255),0)<<8|Math.max(Math.min(L,255),0)<<16};cr.RGBAEx=function(f,y,L,P){f=cr.clamp(Math.floor(1024*f),-8192,8191);y=cr.clamp(Math.floor(1024*y),-8192,8191);L=cr.clamp(Math.floor(1024*L),-8192,8191);P=cr.clamp(Math.floor(1024*P),0,1024);0>f&&(f+=
16384);0>y&&(y+=16384);0>L&&(L+=16384);return-(274877906944*f+16777216*y+1024*L+P)};cr.RGBEx=function(f,y,L){return cr.RGBAEx(f,y,L,1)};cr.GetRValue=function(f){if(0<=f)return(f&255)/255;f=Math.floor(-f/274877906944);8191<f&&(f-=16384);return f/1024};cr.GetGValue=function(f){if(0<=f)return((f&65280)>>8)/255;f=Math.floor(-f%274877906944/16777216);8191<f&&(f-=16384);return f/1024};cr.GetBValue=function(f){if(0<=f)return((f&16711680)>>16)/255;f=Math.floor(-f%16777216/1024);8191<f&&(f-=16384);return f/
1024};cr.GetAValue=function(f){return 0===f&&0>1/f?0:0<=f?1:Math.floor(-f%1024)/1024};cr.shallowCopy=function(f,y,L){for(var P in y)y.hasOwnProperty(P)&&(f[P]=y[P]);return f};cr.arrayRemove=function(f,y){var L;y=cr.floor(y);if(!(0>y||y>=f.length)){for(L=f.length-1;y<L;y++)f[y]=f[y+1];cr.truncateArray(f,L)}};cr.truncateArray=function(f,y){f.length=y};cr.clearArray=function(f){cr.truncateArray(f,0)};cr.shallowAssignArray=function(f,y){cr.clearArray(f);var L;var P=0;for(L=y.length;P<L;++P)f[P]=y[P]};
cr.appendArray=function(f,y){f.push.apply(f,y)};cr.fastIndexOf=function(f,y){var L;var P=0;for(L=f.length;P<L;++P)if(f[P]===y)return P;return-1};cr.arrayFindRemove=function(f,y){y=cr.fastIndexOf(f,y);-1!==y&&cr.arrayRemove(f,y)};cr.clamp=function(f,y,L){return f<y?y:f>L?L:f};cr.to_radians=function(f){return f/(180/cr.PI)};cr.to_degrees=function(f){return 180/cr.PI*f};cr.clamp_angle_degrees=function(f){f%=360;0>f&&(f+=360);return f};cr.clamp_angle=function(f){f%=2*cr.PI;0>f&&(f+=2*cr.PI);return f};
cr.to_clamped_degrees=function(f){return cr.clamp_angle_degrees(cr.to_degrees(f))};cr.to_clamped_radians=function(f){return cr.clamp_angle(cr.to_radians(f))};cr.angleTo=function(f,y,L,P){return Math.atan2(P-y,L-f)};cr.angleDiff=function(f,y){if(f===y)return 0;f=Math.sin(f)*Math.sin(y)+Math.cos(f)*Math.cos(y);return 1<=f?0:-1>=f?cr.PI:Math.acos(f)};cr.angleRotate=function(f,y,L){var P=Math.sin(f),X=Math.cos(f),ba=Math.sin(y),aa=Math.cos(y);return Math.acos(P*ba+X*aa)>L?0<X*ba-P*aa?cr.clamp_angle(f+
L):cr.clamp_angle(f-L):cr.clamp_angle(y)};cr.angleClockwise=function(f,y){return 0>=Math.cos(f)*Math.sin(y)-Math.sin(f)*Math.cos(y)};cr.rotatePtAround=function(f,y,L,P,X,ba){if(0===L)return ba?f:y;var aa=Math.sin(L);L=Math.cos(L);f-=P;y-=X;var ca=f*aa;f=f*L-y*aa;return ba?f+P:y*L+ca+X};cr.distanceTo=function(f,y,L,P){f=L-f;y=P-y;return Math.sqrt(f*f+y*y)};cr.xor=function(f,y){return!f!==!y};cr.lerp=function(f,y,L){return f+(y-f)*L};cr.unlerp=function(f,y,L){return f===y?0:(L-f)/(y-f)};cr.anglelerp=
function(f,y,L){var P=cr.angleDiff(f,y);return cr.angleClockwise(y,f)?f+P*L:f-P*L};cr.qarp=function(f,y,L,P){return cr.lerp(cr.lerp(f,y,P),cr.lerp(y,L,P),P)};cr.cubic=function(f,y,L,P,X){return cr.lerp(cr.qarp(f,y,L,X),cr.qarp(y,L,P,X),X)};cr.cosp=function(f,y,L){return(f+y+(f-y)*Math.cos(L*Math.PI))/2};cr.hasAnyOwnProperty=function(f){for(var y in f)if(f.hasOwnProperty(y))return!0;return!1};cr.wipe=function(f){for(var y in f)f.hasOwnProperty(y)&&delete f[y]};var n=+new Date;cr.performance_now=function(){if("undefined"!==
typeof window.performance){var f=window.performance;if("undefined"!==typeof f.now)return f.now();if("undefined"!==typeof f.webkitNow)return f.webkitNow();if("undefined"!==typeof f.mozNow)return f.mozNow();if("undefined"!==typeof f.msNow)return f.msNow()}return Date.now()-n};var x=!1;"undefined"!==typeof window&&(x=/chrome/i.test(navigator.userAgent)||/chromium/i.test(navigator.userAgent),!x&&/safari/i.test(navigator.userAgent),/(iphone|ipod|ipad)/i.test(navigator.userAgent));var E="undefined"!==typeof Set&&
"undefined"!==typeof Set.prototype.forEach;z.prototype.contains=function(f){return this.isEmpty()?!1:E?this.s.has(f):this.items&&this.items.hasOwnProperty(f)};z.prototype.add=function(f){if(E)this.s.has(f)||(this.s.add(f),this.cache_valid=!1);else{var y=f.toString(),L=this.items;L?L.hasOwnProperty(y)||(L[y]=f,this.item_count++,this.cache_valid=!1):(this.items={},this.items[y]=f,this.item_count=1,this.cache_valid=!1)}};z.prototype.remove=function(f){if(!this.isEmpty())if(E)this.s.has(f)&&(this.s["delete"](f),
this.cache_valid=!1);else if(this.items){f=f.toString();var y=this.items;y.hasOwnProperty(f)&&(delete y[f],this.item_count--,this.cache_valid=!1)}};z.prototype.clear=function(){this.isEmpty()||(E?this.s.clear():(this.items=null,this.item_count=0),cr.clearArray(this.values_cache),this.cache_valid=!0)};z.prototype.isEmpty=function(){return 0===this.count()};z.prototype.count=function(){return E?this.s.size:this.item_count};var V=null,Z=0;z.prototype.update_cache=function(){if(!this.cache_valid){if(E)cr.clearArray(this.values_cache),
V=this.values_cache,Z=0,this.s.forEach(N),V=null,Z=0;else{var f=this.values_cache;cr.clearArray(f);var y,L=0,P=this.items;if(P)for(y in P)P.hasOwnProperty(y)&&(f[L++]=P[y])}this.cache_valid=!0}};z.prototype.valuesRef=function(){this.update_cache();return this.values_cache};cr.ObjectSet=z;var M=new cr.ObjectSet;cr.removeArrayDuplicates=function(f){var y;var L=0;for(y=f.length;L<y;++L)M.add(f[L]);cr.shallowAssignArray(f,M.valuesRef());M.clear()};cr.arrayRemoveAllFromObjectSet=function(f,y){E?cr.arrayRemoveAll_set(f,
y.s):cr.arrayRemoveAll_arr(f,y.valuesRef())};cr.arrayRemoveAll_set=function(f,y){var L,P;var X=L=0;for(P=f.length;L<P;++L){var ba=f[L];y.has(ba)||(f[X++]=ba)}cr.truncateArray(f,X)};cr.arrayRemoveAll_arr=function(f,y){var L,P;var X=L=0;for(P=f.length;L<P;++L){var ba=f[L];-1===cr.fastIndexOf(y,ba)&&(f[X++]=ba)}cr.truncateArray(f,X)};k.prototype.add=function(f){this.y=f-this.c;this.t=this.sum+this.y;this.c=this.t-this.sum-this.y;this.sum=this.t};k.prototype.reset=function(){this.sum=this.t=this.y=this.c=
0};cr.KahanAdder=k;cr.regexp_escape=function(f){return f.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};a.prototype.set_pts=function(f){this.pts_array=f;this.pts_count=f.length/2;this.pts_cache.length=f.length;this.cache_height=this.cache_width=-1;this.cache_angle=0};a.prototype.is_empty=function(){return!this.pts_array.length};a.prototype.update_bbox=function(){for(var f=this.pts_cache,y=f[0],L=y,P=f[1],X=P,ba,aa,ca=1,ja=this.pts_count;ca<ja;++ca)aa=2*ca,ba=f[aa],aa=f[aa+1],ba<y&&(y=ba),ba>L&&(L=ba),
aa<P&&(P=aa),aa>X&&(X=aa);this.bboxLeft=y;this.bboxRight=L;this.bboxTop=P;this.bboxBottom=X};a.prototype.set_from_rect=function(f,y,L){this.pts_cache.length=8;this.pts_count=4;var P=this.pts_cache;P[0]=f.left-y;P[1]=f.top-L;P[2]=f.right-y;P[3]=f.top-L;P[4]=f.right-y;P[5]=f.bottom-L;P[6]=f.left-y;P[7]=f.bottom-L;this.cache_width=f.right-f.left;this.cache_height=f.bottom-f.top;this.update_bbox()};a.prototype.set_from_quad=function(f,y,L,P,X){this.pts_cache.length=8;this.pts_count=4;var ba=this.pts_cache;
ba[0]=f.tlx-y;ba[1]=f.tly-L;ba[2]=f.trx-y;ba[3]=f.try_-L;ba[4]=f.brx-y;ba[5]=f.bry-L;ba[6]=f.blx-y;ba[7]=f.bly-L;this.cache_width=P;this.cache_height=X;this.update_bbox()};a.prototype.set_from_poly=function(f){this.pts_count=f.pts_count;cr.shallowAssignArray(this.pts_cache,f.pts_cache);this.bboxLeft=f.bboxLeft;this.bboxTop-f.bboxTop;this.bboxRight=f.bboxRight;this.bboxBottom=f.bboxBottom};a.prototype.cache_poly=function(f,y,L){if(this.cache_width!==f||this.cache_height!==y||this.cache_angle!==L){this.cache_width=
f;this.cache_height=y;this.cache_angle=L;var P,X=0,ba=1,aa=this.pts_array,ca=this.pts_cache;0!==L&&(X=Math.sin(L),ba=Math.cos(L));L=0;for(P=this.pts_count;L<P;L++){var ja=2*L;var ha=ja+1;var g=aa[ja]*f;var u=aa[ha]*y;ca[ja]=g*ba-u*X;ca[ha]=u*ba+g*X}this.update_bbox()}};a.prototype.contains_pt=function(f,y){var L=this.pts_cache;if(f===L[0]&&y===L[1])return!0;var P,X=this.pts_count,ba=this.bboxLeft-110,aa=this.bboxTop-101,ca=this.bboxRight+131,ja=this.bboxBottom+120,ha=0,g=0;for(P=0;P<X;P++){var u=
2*P;var D=(P+1)%X*2;var I=L[u];u=L[u+1];var B=L[D];D=L[D+1];cr.segments_intersect(ba,aa,f,y,I,u,B,D)&&ha++;cr.segments_intersect(ca,ja,f,y,I,u,B,D)&&g++}return 1===ha%2||1===g%2};a.prototype.intersects_poly=function(f,y,L){var P=f.pts_cache,X=this.pts_cache;if(this.contains_pt(P[0]+y,P[1]+L)||f.contains_pt(X[0]-y,X[1]-L))return!0;var ba,aa;var ca=0;for(ba=this.pts_count;ca<ba;ca++){var ja=2*ca;var ha=(ca+1)%ba*2;var g=X[ja];ja=X[ja+1];var u=X[ha];var D=X[ha+1];ha=0;for(aa=f.pts_count;ha<aa;ha++){var I=
2*ha;var B=(ha+1)%aa*2;var t=P[I]+y;I=P[I+1]+L;var C=P[B]+y;B=P[B+1]+L;if(cr.segments_intersect(g,ja,u,D,t,I,C,B))return!0}}return!1};a.prototype.intersects_segment=function(f,y,L,P,X,ba){var aa=this.pts_cache;if(this.contains_pt(L-f,P-y))return!0;var ca;var ja=0;for(ca=this.pts_count;ja<ca;ja++){var ha=2*ja;var g=(ja+1)%ca*2;var u=aa[ha]+f;ha=aa[ha+1]+y;var D=aa[g]+f;g=aa[g+1]+y;if(cr.segments_intersect(L,P,X,ba,u,ha,D,g))return!0}return!1};a.prototype.mirror=function(f){var y;var L=0;for(y=this.pts_count;L<
y;++L){var P=2*L;this.pts_cache[P]=2*f-this.pts_cache[P]}};a.prototype.flip=function(f){var y;var L=0;for(y=this.pts_count;L<y;++L){var P=2*L+1;this.pts_cache[P]=2*f-this.pts_cache[P]}};a.prototype.diag=function(){var f;var y=0;for(f=this.pts_count;y<f;++y){var L=2*y;var P=L+1;var X=this.pts_cache[L];this.pts_cache[L]=this.pts_cache[P];this.pts_cache[P]=X}};a.prototype.is_enabled=function(){return this.enabled};cr.CollisionPoly=a;c.prototype.totalCellCount=0;c.prototype.getCell=function(f,y,L){var P=
this.cells[f];return P?(P=P[y])?P:L?(P=q(this,f,y),this.cells[f][y]=P):null:L?(P=q(this,f,y),this.cells[f]={},this.cells[f][y]=P):null};c.prototype.XToCell=function(f){return cr.floor(f/this.cellwidth)};c.prototype.YToCell=function(f){return cr.floor(f/this.cellheight)};c.prototype.update=function(f,y,L){var P,X,ba;if(y){var aa=y.left;for(P=y.right;aa<=P;++aa){var ca=y.top;for(X=y.bottom;ca<=X;++ca)if(!L||!L.contains_pt(aa,ca))if(ba=this.getCell(aa,ca,!1))ba.remove(f),ba.isEmpty()&&(c.prototype.totalCellCount--,
ba.objects.clear(),1E3>d.length&&d.push(ba),this.cells[aa][ca]=null)}}if(L)for(aa=L.left,P=L.right;aa<=P;++aa)for(ca=L.top,X=L.bottom;ca<=X;++ca)y&&y.contains_pt(aa,ca)||this.getCell(aa,ca,!0).insert(f)};c.prototype.queryRange=function(f,y){var L,P;var X=this.XToCell(f.left);var ba=this.YToCell(f.top);var aa=this.XToCell(f.right);for(L=this.YToCell(f.bottom);X<=aa;++X)for(f=ba;f<=L;++f)(P=this.getCell(X,f,!1))&&P.dump(y)};cr.SparseGrid=c;l.prototype.totalCellCount=0;l.prototype.getCell=function(f,
y,L){var P=this.cells[f];return P?(P=P[y])?P:L?(P=w(this,f,y),this.cells[f][y]=P):null:L?(P=w(this,f,y),this.cells[f]={},this.cells[f][y]=P):null};l.prototype.XToCell=function(f){return cr.floor(f/this.cellwidth)};l.prototype.YToCell=function(f){return cr.floor(f/this.cellheight)};l.prototype.update=function(f,y,L){var P,X,ba;if(y){var aa=y.left;for(P=y.right;aa<=P;++aa){var ca=y.top;for(X=y.bottom;ca<=X;++ca)if(!L||!L.contains_pt(aa,ca))if(ba=this.getCell(aa,ca,!1))ba.remove(f),ba.isEmpty()&&(l.prototype.totalCellCount--,
ba.reset(),1E3>m.length&&m.push(ba),this.cells[aa][ca]=null)}}if(L)for(aa=L.left,P=L.right;aa<=P;++aa)for(ca=L.top,X=L.bottom;ca<=X;++ca)y&&y.contains_pt(aa,ca)||this.getCell(aa,ca,!0).insert(f)};l.prototype.queryRange=function(f,y,L,P,X){var ba,aa;f=this.XToCell(f);y=this.YToCell(y);L=this.XToCell(L);for(ba=this.YToCell(P);f<=L;++f)for(P=y;P<=ba;++P)(aa=this.getCell(f,P,!1))&&aa.dump(X)};l.prototype.markRangeChanged=function(f){var y,L;var P=f.left;var X=f.top;var ba=f.right;for(y=f.bottom;P<=ba;++P)for(f=
X;f<=y;++f)if(L=this.getCell(P,f,!1))L.is_sorted=!1};cr.RenderGrid=l;var d=[];p.prototype.isEmpty=function(){return this.objects.isEmpty()};p.prototype.insert=function(f){this.objects.add(f)};p.prototype.remove=function(f){this.objects.remove(f)};p.prototype.dump=function(f){cr.appendArray(f,this.objects.valuesRef())};cr.GridCell=p;var m=[];K.prototype.isEmpty=function(){if(!this.objects.length)return!0;if(this.objects.length>this.pending_removal.count())return!1;this.flush_pending();return!0};K.prototype.insert=
function(f){this.pending_removal.contains(f)?(this.pending_removal.remove(f),this.pending_removal.isEmpty()&&(this.any_pending_removal=!1)):this.objects.length?(this.objects[this.objects.length-1].get_zindex()>f.get_zindex()&&(this.is_sorted=!1),this.objects.push(f)):(this.objects.push(f),this.is_sorted=!0)};K.prototype.remove=function(f){this.pending_removal.add(f);this.any_pending_removal=!0;30<=this.pending_removal.count()&&this.flush_pending()};K.prototype.flush_pending=function(){this.any_pending_removal&&
(this.pending_removal.count()===this.objects.length?this.reset():(cr.arrayRemoveAllFromObjectSet(this.objects,this.pending_removal),this.pending_removal.clear(),this.any_pending_removal=!1))};K.prototype.ensure_sorted=function(){this.is_sorted||(this.objects.sort(A),this.is_sorted=!0)};K.prototype.reset=function(){cr.clearArray(this.objects);this.is_sorted=!0;this.pending_removal.clear();this.any_pending_removal=!1};K.prototype.dump=function(f){this.flush_pending();this.ensure_sorted();this.objects.length&&
f.push(this.objects)};cr.RenderCell=K;var G="lighter xor copy destination-over source-in destination-in source-out destination-out source-atop destination-atop".split(" ");cr.effectToCompositeOp=function(f){return 0>=f||11<=f?"source-over":G[f-1]};cr.setGLBlend=function(f,y,L){if(L)switch(f.srcBlend=L.ONE,f.destBlend=L.ONE_MINUS_SRC_ALPHA,y){case 1:f.srcBlend=L.ONE;f.destBlend=L.ONE;break;case 3:f.srcBlend=L.ONE;f.destBlend=L.ZERO;break;case 4:f.srcBlend=L.ONE_MINUS_DST_ALPHA;f.destBlend=L.ONE;break;
case 5:f.srcBlend=L.DST_ALPHA;f.destBlend=L.ZERO;break;case 6:f.srcBlend=L.ZERO;f.destBlend=L.SRC_ALPHA;break;case 7:f.srcBlend=L.ONE_MINUS_DST_ALPHA;f.destBlend=L.ZERO;break;case 8:f.srcBlend=L.ZERO;f.destBlend=L.ONE_MINUS_SRC_ALPHA;break;case 9:f.srcBlend=L.DST_ALPHA;f.destBlend=L.ONE_MINUS_SRC_ALPHA;break;case 10:f.srcBlend=L.ONE_MINUS_DST_ALPHA,f.destBlend=L.SRC_ALPHA}};cr.round6dp=function(f){return Math.round(1E6*f)/1E6};cr.equals_nocase=function(f,y){return"string"!==typeof f||"string"!==typeof y||
f.length!==y.length?!1:f===y?!0:f.toLowerCase()===y.toLowerCase()};cr.cssToCamelCase=function(f){var y="",L,P=!1;var X=0;for(L=f.length;X<L;++X){var ba=f.charAt(X);"-"===ba?P=!0:P?(y+=ba.toUpperCase(),P=!1):y+=ba}return y};cr.isCanvasInputEvent=function(f){f=f.target;return!f||f===document||f===window||document&&document.body&&f===document.body||cr.equals_nocase(f.tagName,"canvas")?!0:!1}})();
var MatrixArray="undefined"!==typeof Float32Array?Float32Array:Array,glMatrixArrayType=MatrixArray,vec3={},mat3={},mat4={},quat4={};vec3.create=function(b){var e=new MatrixArray(3);b&&(e[0]=b[0],e[1]=b[1],e[2]=b[2]);return e};vec3.set=function(b,e){e[0]=b[0];e[1]=b[1];e[2]=b[2];return e};vec3.add=function(b,e,h){if(!h||b===h)return b[0]+=e[0],b[1]+=e[1],b[2]+=e[2],b;h[0]=b[0]+e[0];h[1]=b[1]+e[1];h[2]=b[2]+e[2];return h};
vec3.subtract=function(b,e,h){if(!h||b===h)return b[0]-=e[0],b[1]-=e[1],b[2]-=e[2],b;h[0]=b[0]-e[0];h[1]=b[1]-e[1];h[2]=b[2]-e[2];return h};vec3.negate=function(b,e){e||(e=b);e[0]=-b[0];e[1]=-b[1];e[2]=-b[2];return e};vec3.scale=function(b,e,h){if(!h||b===h)return b[0]*=e,b[1]*=e,b[2]*=e,b;h[0]=b[0]*e;h[1]=b[1]*e;h[2]=b[2]*e;return h};
vec3.normalize=function(b,e){e||(e=b);var h=b[0],r=b[1];b=b[2];var z=Math.sqrt(h*h+r*r+b*b);if(z){if(1===z)return e[0]=h,e[1]=r,e[2]=b,e}else return e[0]=0,e[1]=0,e[2]=0,e;z=1/z;e[0]=h*z;e[1]=r*z;e[2]=b*z;return e};vec3.cross=function(b,e,h){h||(h=b);var r=b[0],z=b[1];b=b[2];var N=e[0],k=e[1];e=e[2];h[0]=z*e-b*k;h[1]=b*N-r*e;h[2]=r*k-z*N;return h};vec3.length=function(b){var e=b[0],h=b[1];b=b[2];return Math.sqrt(e*e+h*h+b*b)};vec3.dot=function(b,e){return b[0]*e[0]+b[1]*e[1]+b[2]*e[2]};
vec3.direction=function(b,e,h){h||(h=b);var r=b[0]-e[0],z=b[1]-e[1];b=b[2]-e[2];e=Math.sqrt(r*r+z*z+b*b);if(!e)return h[0]=0,h[1]=0,h[2]=0,h;e=1/e;h[0]=r*e;h[1]=z*e;h[2]=b*e;return h};vec3.lerp=function(b,e,h,r){r||(r=b);r[0]=b[0]+h*(e[0]-b[0]);r[1]=b[1]+h*(e[1]-b[1]);r[2]=b[2]+h*(e[2]-b[2]);return r};vec3.str=function(b){return"["+b[0]+", "+b[1]+", "+b[2]+"]"};
mat3.create=function(b){var e=new MatrixArray(9);b&&(e[0]=b[0],e[1]=b[1],e[2]=b[2],e[3]=b[3],e[4]=b[4],e[5]=b[5],e[6]=b[6],e[7]=b[7],e[8]=b[8]);return e};mat3.set=function(b,e){e[0]=b[0];e[1]=b[1];e[2]=b[2];e[3]=b[3];e[4]=b[4];e[5]=b[5];e[6]=b[6];e[7]=b[7];e[8]=b[8];return e};mat3.identity=function(b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=1;b[5]=0;b[6]=0;b[7]=0;b[8]=1;return b};
mat3.transpose=function(b,e){if(!e||b===e){e=b[1];var h=b[2],r=b[5];b[1]=b[3];b[2]=b[6];b[3]=e;b[5]=b[7];b[6]=h;b[7]=r;return b}e[0]=b[0];e[1]=b[3];e[2]=b[6];e[3]=b[1];e[4]=b[4];e[5]=b[7];e[6]=b[2];e[7]=b[5];e[8]=b[8];return e};mat3.toMat4=function(b,e){e||(e=mat4.create());e[15]=1;e[14]=0;e[13]=0;e[12]=0;e[11]=0;e[10]=b[8];e[9]=b[7];e[8]=b[6];e[7]=0;e[6]=b[5];e[5]=b[4];e[4]=b[3];e[3]=0;e[2]=b[2];e[1]=b[1];e[0]=b[0];return e};
mat3.str=function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+", "+b[6]+", "+b[7]+", "+b[8]+"]"};mat4.create=function(b){var e=new MatrixArray(16);b&&(e[0]=b[0],e[1]=b[1],e[2]=b[2],e[3]=b[3],e[4]=b[4],e[5]=b[5],e[6]=b[6],e[7]=b[7],e[8]=b[8],e[9]=b[9],e[10]=b[10],e[11]=b[11],e[12]=b[12],e[13]=b[13],e[14]=b[14],e[15]=b[15]);return e};
mat4.set=function(b,e){e[0]=b[0];e[1]=b[1];e[2]=b[2];e[3]=b[3];e[4]=b[4];e[5]=b[5];e[6]=b[6];e[7]=b[7];e[8]=b[8];e[9]=b[9];e[10]=b[10];e[11]=b[11];e[12]=b[12];e[13]=b[13];e[14]=b[14];e[15]=b[15];return e};mat4.identity=function(b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};
mat4.transpose=function(b,e){if(!e||b===e){e=b[1];var h=b[2],r=b[3],z=b[6],N=b[7],k=b[11];b[1]=b[4];b[2]=b[8];b[3]=b[12];b[4]=e;b[6]=b[9];b[7]=b[13];b[8]=h;b[9]=z;b[11]=b[14];b[12]=r;b[13]=N;b[14]=k;return b}e[0]=b[0];e[1]=b[4];e[2]=b[8];e[3]=b[12];e[4]=b[1];e[5]=b[5];e[6]=b[9];e[7]=b[13];e[8]=b[2];e[9]=b[6];e[10]=b[10];e[11]=b[14];e[12]=b[3];e[13]=b[7];e[14]=b[11];e[15]=b[15];return e};
mat4.determinant=function(b){var e=b[0],h=b[1],r=b[2],z=b[3],N=b[4],k=b[5],a=b[6],c=b[7],l=b[8],q=b[9],p=b[10],w=b[11],K=b[12],A=b[13],J=b[14];b=b[15];return K*q*a*z-l*A*a*z-K*k*p*z+N*A*p*z+l*k*J*z-N*q*J*z-K*q*r*c+l*A*r*c+K*h*p*c-e*A*p*c-l*h*J*c+e*q*J*c+K*k*r*w-N*A*r*w-K*h*a*w+e*A*a*w+N*h*J*w-e*k*J*w-l*k*r*b+N*q*r*b+l*h*a*b-e*q*a*b-N*h*p*b+e*k*p*b};
mat4.inverse=function(b,e){e||(e=b);var h=b[0],r=b[1],z=b[2],N=b[3],k=b[4],a=b[5],c=b[6],l=b[7],q=b[8],p=b[9],w=b[10],K=b[11],A=b[12],J=b[13],R=b[14];b=b[15];var n=h*a-r*k,x=h*c-z*k,E=h*l-N*k,V=r*c-z*a,Z=r*l-N*a,M=z*l-N*c,d=q*J-p*A,m=q*R-w*A,G=q*b-K*A,f=p*R-w*J,y=p*b-K*J,L=w*b-K*R,P=1/(n*L-x*y+E*f+V*G-Z*m+M*d);e[0]=(a*L-c*y+l*f)*P;e[1]=(-r*L+z*y-N*f)*P;e[2]=(J*M-R*Z+b*V)*P;e[3]=(-p*M+w*Z-K*V)*P;e[4]=(-k*L+c*G-l*m)*P;e[5]=(h*L-z*G+N*m)*P;e[6]=(-A*M+R*E-b*x)*P;e[7]=(q*M-w*E+K*x)*P;e[8]=(k*y-a*G+l*d)*
P;e[9]=(-h*y+r*G-N*d)*P;e[10]=(A*Z-J*E+b*n)*P;e[11]=(-q*Z+p*E-K*n)*P;e[12]=(-k*f+a*m-c*d)*P;e[13]=(h*f-r*m+z*d)*P;e[14]=(-A*V+J*x-R*n)*P;e[15]=(q*V-p*x+w*n)*P;return e};mat4.toRotationMat=function(b,e){e||(e=mat4.create());e[0]=b[0];e[1]=b[1];e[2]=b[2];e[3]=b[3];e[4]=b[4];e[5]=b[5];e[6]=b[6];e[7]=b[7];e[8]=b[8];e[9]=b[9];e[10]=b[10];e[11]=b[11];e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};
mat4.toMat3=function(b,e){e||(e=mat3.create());e[0]=b[0];e[1]=b[1];e[2]=b[2];e[3]=b[4];e[4]=b[5];e[5]=b[6];e[6]=b[8];e[7]=b[9];e[8]=b[10];return e};mat4.toInverseMat3=function(b,e){var h=b[0],r=b[1],z=b[2],N=b[4],k=b[5],a=b[6],c=b[8],l=b[9];b=b[10];var q=b*k-a*l,p=-b*N+a*c,w=l*N-k*c,K=h*q+r*p+z*w;if(!K)return null;K=1/K;e||(e=mat3.create());e[0]=q*K;e[1]=(-b*r+z*l)*K;e[2]=(a*r-z*k)*K;e[3]=p*K;e[4]=(b*h-z*c)*K;e[5]=(-a*h+z*N)*K;e[6]=w*K;e[7]=(-l*h+r*c)*K;e[8]=(k*h-r*N)*K;return e};
mat4.multiply=function(b,e,h){h||(h=b);var r=b[0],z=b[1],N=b[2],k=b[3],a=b[4],c=b[5],l=b[6],q=b[7],p=b[8],w=b[9],K=b[10],A=b[11],J=b[12],R=b[13],n=b[14];b=b[15];var x=e[0],E=e[1],V=e[2],Z=e[3],M=e[4],d=e[5],m=e[6],G=e[7],f=e[8],y=e[9],L=e[10],P=e[11],X=e[12],ba=e[13],aa=e[14];e=e[15];h[0]=x*r+E*a+V*p+Z*J;h[1]=x*z+E*c+V*w+Z*R;h[2]=x*N+E*l+V*K+Z*n;h[3]=x*k+E*q+V*A+Z*b;h[4]=M*r+d*a+m*p+G*J;h[5]=M*z+d*c+m*w+G*R;h[6]=M*N+d*l+m*K+G*n;h[7]=M*k+d*q+m*A+G*b;h[8]=f*r+y*a+L*p+P*J;h[9]=f*z+y*c+L*w+P*R;h[10]=
f*N+y*l+L*K+P*n;h[11]=f*k+y*q+L*A+P*b;h[12]=X*r+ba*a+aa*p+e*J;h[13]=X*z+ba*c+aa*w+e*R;h[14]=X*N+ba*l+aa*K+e*n;h[15]=X*k+ba*q+aa*A+e*b;return h};mat4.multiplyVec3=function(b,e,h){h||(h=e);var r=e[0],z=e[1];e=e[2];h[0]=b[0]*r+b[4]*z+b[8]*e+b[12];h[1]=b[1]*r+b[5]*z+b[9]*e+b[13];h[2]=b[2]*r+b[6]*z+b[10]*e+b[14];return h};
mat4.multiplyVec4=function(b,e,h){h||(h=e);var r=e[0],z=e[1],N=e[2];e=e[3];h[0]=b[0]*r+b[4]*z+b[8]*N+b[12]*e;h[1]=b[1]*r+b[5]*z+b[9]*N+b[13]*e;h[2]=b[2]*r+b[6]*z+b[10]*N+b[14]*e;h[3]=b[3]*r+b[7]*z+b[11]*N+b[15]*e;return h};
mat4.translate=function(b,e,h){var r=e[0],z=e[1];e=e[2];if(!h||b===h)return b[12]=b[0]*r+b[4]*z+b[8]*e+b[12],b[13]=b[1]*r+b[5]*z+b[9]*e+b[13],b[14]=b[2]*r+b[6]*z+b[10]*e+b[14],b[15]=b[3]*r+b[7]*z+b[11]*e+b[15],b;var N=b[0];var k=b[1];var a=b[2];var c=b[3];var l=b[4];var q=b[5];var p=b[6];var w=b[7];var K=b[8];var A=b[9];var J=b[10];var R=b[11];h[0]=N;h[1]=k;h[2]=a;h[3]=c;h[4]=l;h[5]=q;h[6]=p;h[7]=w;h[8]=K;h[9]=A;h[10]=J;h[11]=R;h[12]=N*r+l*z+K*e+b[12];h[13]=k*r+q*z+A*e+b[13];h[14]=a*r+p*z+J*e+b[14];
h[15]=c*r+w*z+R*e+b[15];return h};mat4.scale=function(b,e,h){var r=e[0],z=e[1];e=e[2];if(!h||b===h)return b[0]*=r,b[1]*=r,b[2]*=r,b[3]*=r,b[4]*=z,b[5]*=z,b[6]*=z,b[7]*=z,b[8]*=e,b[9]*=e,b[10]*=e,b[11]*=e,b;h[0]=b[0]*r;h[1]=b[1]*r;h[2]=b[2]*r;h[3]=b[3]*r;h[4]=b[4]*z;h[5]=b[5]*z;h[6]=b[6]*z;h[7]=b[7]*z;h[8]=b[8]*e;h[9]=b[9]*e;h[10]=b[10]*e;h[11]=b[11]*e;h[12]=b[12];h[13]=b[13];h[14]=b[14];h[15]=b[15];return h};
mat4.rotate=function(b,e,h,r){var z=h[0],N=h[1];h=h[2];var k=Math.sqrt(z*z+N*N+h*h);if(!k)return null;1!==k&&(k=1/k,z*=k,N*=k,h*=k);var a=Math.sin(e);var c=Math.cos(e);var l=1-c;e=b[0];k=b[1];var q=b[2];var p=b[3];var w=b[4];var K=b[5];var A=b[6];var J=b[7];var R=b[8];var n=b[9];var x=b[10];var E=b[11];var V=z*z*l+c;var Z=N*z*l+h*a;var M=h*z*l-N*a;var d=z*N*l-h*a;var m=N*N*l+c;var G=h*N*l+z*a;var f=z*h*l+N*a;z=N*h*l-z*a;N=h*h*l+c;r?b!==r&&(r[12]=b[12],r[13]=b[13],r[14]=b[14],r[15]=b[15]):r=b;r[0]=
e*V+w*Z+R*M;r[1]=k*V+K*Z+n*M;r[2]=q*V+A*Z+x*M;r[3]=p*V+J*Z+E*M;r[4]=e*d+w*m+R*G;r[5]=k*d+K*m+n*G;r[6]=q*d+A*m+x*G;r[7]=p*d+J*m+E*G;r[8]=e*f+w*z+R*N;r[9]=k*f+K*z+n*N;r[10]=q*f+A*z+x*N;r[11]=p*f+J*z+E*N;return r};
mat4.rotateX=function(b,e,h){var r=Math.sin(e);e=Math.cos(e);var z=b[4],N=b[5],k=b[6],a=b[7],c=b[8],l=b[9],q=b[10],p=b[11];h?b!==h&&(h[0]=b[0],h[1]=b[1],h[2]=b[2],h[3]=b[3],h[12]=b[12],h[13]=b[13],h[14]=b[14],h[15]=b[15]):h=b;h[4]=z*e+c*r;h[5]=N*e+l*r;h[6]=k*e+q*r;h[7]=a*e+p*r;h[8]=z*-r+c*e;h[9]=N*-r+l*e;h[10]=k*-r+q*e;h[11]=a*-r+p*e;return h};
mat4.rotateY=function(b,e,h){var r=Math.sin(e);e=Math.cos(e);var z=b[0],N=b[1],k=b[2],a=b[3],c=b[8],l=b[9],q=b[10],p=b[11];h?b!==h&&(h[4]=b[4],h[5]=b[5],h[6]=b[6],h[7]=b[7],h[12]=b[12],h[13]=b[13],h[14]=b[14],h[15]=b[15]):h=b;h[0]=z*e+c*-r;h[1]=N*e+l*-r;h[2]=k*e+q*-r;h[3]=a*e+p*-r;h[8]=z*r+c*e;h[9]=N*r+l*e;h[10]=k*r+q*e;h[11]=a*r+p*e;return h};
mat4.rotateZ=function(b,e,h){var r=Math.sin(e);e=Math.cos(e);var z=b[0],N=b[1],k=b[2],a=b[3],c=b[4],l=b[5],q=b[6],p=b[7];h?b!==h&&(h[8]=b[8],h[9]=b[9],h[10]=b[10],h[11]=b[11],h[12]=b[12],h[13]=b[13],h[14]=b[14],h[15]=b[15]):h=b;h[0]=z*e+c*r;h[1]=N*e+l*r;h[2]=k*e+q*r;h[3]=a*e+p*r;h[4]=z*-r+c*e;h[5]=N*-r+l*e;h[6]=k*-r+q*e;h[7]=a*-r+p*e;return h};
mat4.frustum=function(b,e,h,r,z,N,k){k||(k=mat4.create());var a=e-b,c=r-h,l=N-z;k[0]=2*z/a;k[1]=0;k[2]=0;k[3]=0;k[4]=0;k[5]=2*z/c;k[6]=0;k[7]=0;k[8]=(e+b)/a;k[9]=(r+h)/c;k[10]=-(N+z)/l;k[11]=-1;k[12]=0;k[13]=0;k[14]=-(N*z*2)/l;k[15]=0;return k};mat4.perspective=function(b,e,h,r,z){b=h*Math.tan(b*Math.PI/360);e*=b;return mat4.frustum(-e,e,-b,b,h,r,z)};
mat4.ortho=function(b,e,h,r,z,N,k){k||(k=mat4.create());var a=e-b,c=r-h,l=N-z;k[0]=2/a;k[1]=0;k[2]=0;k[3]=0;k[4]=0;k[5]=2/c;k[6]=0;k[7]=0;k[8]=0;k[9]=0;k[10]=-2/l;k[11]=0;k[12]=-(b+e)/a;k[13]=-(r+h)/c;k[14]=-(N+z)/l;k[15]=1;return k};
mat4.lookAt=function(b,e,h,r){r||(r=mat4.create());var z=b[0],N=b[1];b=b[2];var k=h[0];var a=h[1];var c=h[2];h=e[1];var l=e[2];if(z===e[0]&&N===h&&b===l)return mat4.identity(r);h=z-e[0];l=N-e[1];var q=b-e[2];var p=1/Math.sqrt(h*h+l*l+q*q);h*=p;l*=p;q*=p;e=a*q-c*l;c=c*h-k*q;k=k*l-a*h;(p=Math.sqrt(e*e+c*c+k*k))?(p=1/p,e*=p,c*=p,k*=p):k=c=e=0;a=l*k-q*c;var w=q*e-h*k;var K=h*c-l*e;(p=Math.sqrt(a*a+w*w+K*K))?(p=1/p,a*=p,w*=p,K*=p):K=w=a=0;r[0]=e;r[1]=a;r[2]=h;r[3]=0;r[4]=c;r[5]=w;r[6]=l;r[7]=0;r[8]=k;
r[9]=K;r[10]=q;r[11]=0;r[12]=-(e*z+c*N+k*b);r[13]=-(a*z+w*N+K*b);r[14]=-(h*z+l*N+q*b);r[15]=1;return r};mat4.fromRotationTranslation=function(b,e,h){h||(h=mat4.create());var r=b[0],z=b[1],N=b[2],k=b[3],a=r+r,c=z+z,l=N+N;b=r*a;var q=r*c;r*=l;var p=z*c;z*=l;N*=l;a*=k;c*=k;k*=l;h[0]=1-(p+N);h[1]=q+k;h[2]=r-c;h[3]=0;h[4]=q-k;h[5]=1-(b+N);h[6]=z+a;h[7]=0;h[8]=r+c;h[9]=z-a;h[10]=1-(b+p);h[11]=0;h[12]=e[0];h[13]=e[1];h[14]=e[2];h[15]=1;return h};
mat4.str=function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+", "+b[6]+", "+b[7]+", "+b[8]+", "+b[9]+", "+b[10]+", "+b[11]+", "+b[12]+", "+b[13]+", "+b[14]+", "+b[15]+"]"};quat4.create=function(b){var e=new MatrixArray(4);b&&(e[0]=b[0],e[1]=b[1],e[2]=b[2],e[3]=b[3]);return e};quat4.set=function(b,e){e[0]=b[0];e[1]=b[1];e[2]=b[2];e[3]=b[3];return e};
quat4.calculateW=function(b,e){var h=b[0],r=b[1],z=b[2];if(!e||b===e)return b[3]=-Math.sqrt(Math.abs(1-h*h-r*r-z*z)),b;e[0]=h;e[1]=r;e[2]=z;e[3]=-Math.sqrt(Math.abs(1-h*h-r*r-z*z));return e};quat4.inverse=function(b,e){if(!e||b===e)return b[0]*=-1,b[1]*=-1,b[2]*=-1,b;e[0]=-b[0];e[1]=-b[1];e[2]=-b[2];e[3]=b[3];return e};quat4.length=function(b){var e=b[0],h=b[1],r=b[2];b=b[3];return Math.sqrt(e*e+h*h+r*r+b*b)};
quat4.normalize=function(b,e){e||(e=b);var h=b[0],r=b[1],z=b[2];b=b[3];var N=Math.sqrt(h*h+r*r+z*z+b*b);if(0===N)return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e;N=1/N;e[0]=h*N;e[1]=r*N;e[2]=z*N;e[3]=b*N;return e};quat4.multiply=function(b,e,h){h||(h=b);var r=b[0],z=b[1],N=b[2];b=b[3];var k=e[0],a=e[1],c=e[2];e=e[3];h[0]=r*e+b*k+z*c-N*a;h[1]=z*e+b*a+N*k-r*c;h[2]=N*e+b*c+r*a-z*k;h[3]=b*e-r*k-z*a-N*c;return h};
quat4.multiplyVec3=function(b,e,h){h||(h=e);var r=e[0],z=e[1],N=e[2];e=b[0];var k=b[1],a=b[2];b=b[3];var c=b*r+k*N-a*z,l=b*z+a*r-e*N,q=b*N+e*z-k*r;r=-e*r-k*z-a*N;h[0]=c*b+r*-e+l*-a-q*-k;h[1]=l*b+r*-k+q*-e-c*-a;h[2]=q*b+r*-a+c*-k-l*-e;return h};quat4.toMat3=function(b,e){e||(e=mat3.create());var h=b[0],r=b[1],z=b[2];b=b[3];var N=h+h,k=r+r,a=z+z,c=h*N,l=h*k;h*=a;var q=r*k;r*=a;z*=a;N*=b;k*=b;b*=a;e[0]=1-(q+z);e[1]=l+b;e[2]=h-k;e[3]=l-b;e[4]=1-(c+z);e[5]=r+N;e[6]=h+k;e[7]=r-N;e[8]=1-(c+q);return e};
quat4.toMat4=function(b,e){e||(e=mat4.create());var h=b[0],r=b[1],z=b[2];b=b[3];var N=h+h,k=r+r,a=z+z,c=h*N,l=h*k;h*=a;var q=r*k;r*=a;z*=a;N*=b;k*=b;b*=a;e[0]=1-(q+z);e[1]=l+b;e[2]=h-k;e[3]=0;e[4]=l-b;e[5]=1-(c+z);e[6]=r+N;e[7]=0;e[8]=h+k;e[9]=r-N;e[10]=1-(c+q);e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};
quat4.slerp=function(b,e,h,r){r||(r=b);var z=b[0]*e[0]+b[1]*e[1]+b[2]*e[2]+b[3]*e[3];if(1<=Math.abs(z))return r!==b&&(r[0]=b[0],r[1]=b[1],r[2]=b[2],r[3]=b[3]),r;var N=Math.acos(z);var k=Math.sqrt(1-z*z);if(.001>Math.abs(k))return r[0]=.5*b[0]+.5*e[0],r[1]=.5*b[1]+.5*e[1],r[2]=.5*b[2]+.5*e[2],r[3]=.5*b[3]+.5*e[3],r;z=Math.sin((1-h)*N)/k;h=Math.sin(h*N)/k;r[0]=b[0]*z+e[0]*h;r[1]=b[1]*z+e[1]*h;r[2]=b[2]*z+e[2]*h;r[3]=b[3]*z+e[3]*h;return r};
quat4.str=function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+"]"};
(function(){function b(a,c,l){this.isIE=/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent);this.height=this.width=0;this.enableFrontToBack=!!l;this.isBatchInEarlyZPass=this.isEarlyZPass=!1;this.currentZ=0;this.zNear=1;this.zFar=1E3;this.zIncrement=(this.zFar-this.zNear)/32768;this.zA=this.zFar/(this.zFar-this.zNear);this.zB=this.zFar*this.zNear/(this.zNear-this.zFar);this.kzA=65536*this.zA;this.kzB=65536*this.zB;this.cam=vec3.create([0,0,100]);this.look=vec3.create([0,0,0]);this.up=
vec3.create([0,1,0]);this.worldScale=vec3.create([1,1,1]);this.enable_mipmaps=!0;this.matP=mat4.create();this.matMV=mat4.create();this.lastMV=mat4.create();this.currentMV=mat4.create();this.gl=a;this.version=0===this.gl.getParameter(this.gl.VERSION).indexOf("WebGL 2")?2:1;this.timerExt=null;this.isTiming=!1;this.timerExt=2===this.version?this.gl.getExtension("EXT_disjoint_timer_query_webgl2")||this.gl.getExtension("EXT_disjoint_timer_query"):this.gl.getExtension("EXT_disjoint_timer_query");this.frameNumber=
0;this.timerResults=[];this.initState()}function e(a,c,l){this.gl=a;this.shaderProgram=c;this.name=l;this.locAPos=a.getAttribLocation(c,"aPos");this.locATex=a.getAttribLocation(c,"aTex");this.locMatP=a.getUniformLocation(c,"matP");this.locMatMV=a.getUniformLocation(c,"matMV");this.locOpacity=a.getUniformLocation(c,"opacity");this.locColorFill=a.getUniformLocation(c,"colorFill");this.locSamplerFront=a.getUniformLocation(c,"samplerFront");this.locSamplerBack=a.getUniformLocation(c,"samplerBack");this.locSrcStart=
a.getUniformLocation(c,"srcStart");this.locSrcEnd=a.getUniformLocation(c,"srcEnd");this.locSrcOriginStart=a.getUniformLocation(c,"srcOriginStart");this.locSrcOriginEnd=a.getUniformLocation(c,"srcOriginEnd");this.locLayoutStart=a.getUniformLocation(c,"layoutStart");this.locLayoutEnd=a.getUniformLocation(c,"layoutEnd");this.locDestStart=a.getUniformLocation(c,"destStart");this.locDestEnd=a.getUniformLocation(c,"destEnd");this.locSeconds=a.getUniformLocation(c,"seconds");this.locPixelSize=a.getUniformLocation(c,
"pixelSize");this.locLayerScale=a.getUniformLocation(c,"layerScale");this.locLayerAngle=a.getUniformLocation(c,"layerAngle");this.hasAnyOptionalUniforms=!!(this.locPixelSize||this.locSeconds||this.locSamplerBack||this.locSrcStart||this.locSrcEnd||this.locSrcOriginStart||this.locSrcOriginEnd||this.locLayoutStart||this.locLayoutEnd||this.locDestStart||this.locDestEnd||this.locLayerScale||this.locLayerAngle);this.lpPixelHeight=this.lpPixelWidth=-999;this.lpOpacity=1;this.lpDestStartY=this.lpDestStartX=
this.lpLayoutEndY=this.lpLayoutEndX=this.lpLayoutStartY=this.lpLayoutStartX=this.lpSrcOriginEndY=this.lpSrcOriginEndX=this.lpSrcOriginStartY=this.lpSrcOriginStartX=this.lpSrcEndY=this.lpSrcEndX=this.lpSrcStartY=this.lpSrcStartX=0;this.lpLayerScale=this.lpDestEndY=this.lpDestEndX=1;this.lpSeconds=this.lpLayerAngle=0;this.lastCustomParams=[];this.lpMatMV=mat4.create();this.locOpacity&&a.uniform1f(this.locOpacity,1);this.locColorFill&&a.uniform4f(this.locColorFill,1,1,1,1);this.locSamplerFront&&a.uniform1i(this.locSamplerFront,
0);this.locSamplerBack&&a.uniform1i(this.locSamplerBack,1);this.locSrcStart&&a.uniform2f(this.locSrcStart,0,0);this.locSrcEnd&&a.uniform2f(this.locSrcEnd,1,1);this.locSrcOriginStart&&a.uniform2f(this.locSrcOriginStart,0,0);this.locSrcOriginEnd&&a.uniform2f(this.locSrcOriginEnd,0,0);this.locLayoutStart&&a.uniform2f(this.locLayoutStart,0,0);this.locLayoutEnd&&a.uniform2f(this.locLayoutEnd,0,0);this.locDestStart&&a.uniform2f(this.locDestStart,0,0);this.locDestEnd&&a.uniform2f(this.locDestEnd,1,1);this.locLayerScale&&
a.uniform1f(this.locLayerScale,1);this.locLayerAngle&&a.uniform1f(this.locLayerAngle,0);this.locSeconds&&a.uniform1f(this.locSeconds,0);this.hasCurrentMatMV=!1}function h(a,c){return a[0]===c[0]&&a[1]===c[1]&&a[2]===c[2]&&a[3]===c[3]&&a[4]===c[4]&&a[5]===c[5]&&a[6]===c[6]&&a[7]===c[7]&&a[8]===c[8]&&a[9]===c[9]&&a[10]===c[10]&&a[11]===c[11]&&a[12]===c[12]&&a[13]===c[13]&&a[14]===c[14]&&a[15]===c[15]}function r(a,c){this.type=a;this.glwrap=c;this.gl=c.gl;this.indexCount=this.startIndex=this.opacityParam=
0;this.mat4param=this.texParam=null;this.layoutRect=quat4.create();this.srcOriginRect=quat4.create();this.shaderParams=[];cr.seal(this)}var z=mat4.create();b.prototype.initState=function(){var a=this.gl,c;this.lastOpacity=1;this.lastTexture1=this.lastTexture0=null;this.currentOpacity=1;a.clearColor(0,0,0,0);a.clear(a.COLOR_BUFFER_BIT);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);a.disable(a.CULL_FACE);a.disable(a.STENCIL_TEST);a.disable(a.DITHER);this.enableFrontToBack?(a.enable(a.DEPTH_TEST),
a.depthFunc(a.LEQUAL)):a.disable(a.DEPTH_TEST);this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE);this.lastSrcBlend=a.ONE;this.lastDestBlend=a.ONE_MINUS_SRC_ALPHA;this.vertexData=new Float32Array(8E3*(this.enableFrontToBack?3:2));this.texcoordData=new Float32Array(16E3);this.pointData=new Float32Array(32E3);this.pointBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.pointBuffer);a.bufferData(a.ARRAY_BUFFER,this.pointData.byteLength,a.DYNAMIC_DRAW);this.vertexBuffers=Array(4);this.texcoordBuffers=
Array(4);for(c=0;4>c;c++)this.vertexBuffers[c]=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffers[c]),a.bufferData(a.ARRAY_BUFFER,this.vertexData.byteLength,a.DYNAMIC_DRAW),this.texcoordBuffers[c]=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.texcoordBuffers[c]),a.bufferData(a.ARRAY_BUFFER,this.texcoordData.byteLength,a.DYNAMIC_DRAW);this.curBuffer=0;this.indexBuffer=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);for(var l=new Uint16Array(12E3),q=c=0;12E3>
c;)l[c++]=q,l[c++]=q+1,l[c++]=q+2,l[c++]=q,l[c++]=q+2,l[c++]=q+3,q+=4;a.bufferData(a.ELEMENT_ARRAY_BUFFER,l,a.STATIC_DRAW);this.pointPtr=this.texPtr=this.vertexPtr=0;this.shaderPrograms=[];c=this.enableFrontToBack?"attribute highp vec3 aPos;\nattribute mediump vec2 aTex;\nvarying mediump vec2 vTex;\nuniform highp mat4 matP;\nuniform highp mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, aPos.z, 1.0);\n\tvTex = aTex;\n}":"attribute highp vec2 aPos;\nattribute mediump vec2 aTex;\nvarying mediump vec2 vTex;\nuniform highp mat4 matP;\nuniform highp mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);\n\tvTex = aTex;\n}";
l=this.createShaderProgram({src:"varying mediump vec2 vTex;\nuniform lowp float opacity;\nuniform lowp sampler2D samplerFront;\nvoid main(void) {\n\tgl_FragColor = texture2D(samplerFront, vTex);\n\tgl_FragColor *= opacity;\n}"},c,"<default>");this.shaderPrograms.push(l);l=this.createShaderProgram({src:"uniform mediump sampler2D samplerFront;\nvarying lowp float opacity;\nvoid main(void) {\n\tgl_FragColor = texture2D(samplerFront, gl_PointCoord);\n\tgl_FragColor *= opacity;\n}"},"attribute vec4 aPos;\nvarying float opacity;\nuniform mat4 matP;\nuniform mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);\n\tgl_PointSize = aPos.z;\n\topacity = aPos.w;\n}",
"<point>");this.shaderPrograms.push(l);l=this.createShaderProgram({src:"varying mediump vec2 vTex;\nuniform lowp sampler2D samplerFront;\nvoid main(void) {\n\tif (texture2D(samplerFront, vTex).a < 1.0)\n\t\tdiscard;\n}"},c,"<earlyz>");this.shaderPrograms.push(l);l=this.createShaderProgram({src:"uniform lowp vec4 colorFill;\nvoid main(void) {\n\tgl_FragColor = colorFill;\n}"},c,"<fill>");this.shaderPrograms.push(l);for(var p in cr.shaders)cr.shaders.hasOwnProperty(p)&&this.shaderPrograms.push(this.createShaderProgram(cr.shaders[p],
c,p));a.activeTexture(a.TEXTURE0);a.bindTexture(a.TEXTURE_2D,null);this.batch=[];this.batchPtr=0;this.hasPointBatchTop=this.hasQuadBatchTop=!1;this.currentProgram=this.lastProgram=-1;this.currentShader=null;this.fbo=a.createFramebuffer();this.depthBuffer=this.renderToTex=null;this.attachedDepthBuffer=!1;this.enableFrontToBack&&(this.depthBuffer=a.createRenderbuffer());this.tmpVec3=vec3.create([0,0,0]);a=a.getParameter(a.ALIASED_POINT_SIZE_RANGE);this.minPointSize=a[0];this.maxPointSize=a[1];2048<
this.maxPointSize&&(this.maxPointSize=2048);this.switchProgram(0);cr.seal(this)};e.prototype.updateMatMV=function(a){h(this.lpMatMV,a)||(mat4.set(a,this.lpMatMV),this.gl.uniformMatrix4fv(this.locMatMV,!1,a))};b.prototype.createShaderProgram=function(a,c,l){var q=this.gl,p=q.createShader(q.FRAGMENT_SHADER);q.shaderSource(p,a.src);q.compileShader(p);if(!q.getShaderParameter(p,q.COMPILE_STATUS))throw a=q.getShaderInfoLog(p),q.deleteShader(p),Error("error compiling fragment shader: "+a);var w=q.createShader(q.VERTEX_SHADER);
q.shaderSource(w,c);q.compileShader(w);if(!q.getShaderParameter(w,q.COMPILE_STATUS))throw a=q.getShaderInfoLog(w),q.deleteShader(p),q.deleteShader(w),Error("error compiling vertex shader: "+a);c=q.createProgram();q.attachShader(c,p);q.attachShader(c,w);q.linkProgram(c);if(!q.getProgramParameter(c,q.LINK_STATUS))throw a=q.getProgramInfoLog(c),q.deleteShader(p),q.deleteShader(w),q.deleteProgram(c),Error("error linking shader program: "+a);q.useProgram(c);q.deleteShader(p);q.deleteShader(w);p=new e(q,
c,l);p.extendBoxHorizontal=a.extendBoxHorizontal||0;p.extendBoxVertical=a.extendBoxVertical||0;p.crossSampling=!!a.crossSampling;p.preservesOpaqueness=!!a.preservesOpaqueness;p.animated=!!a.animated;p.parameters=a.parameters||[];a=0;for(w=p.parameters.length;a<w;a++)p.parameters[a][1]=q.getUniformLocation(c,p.parameters[a][0]),p.lastCustomParams.push(0);cr.seal(p);return p};b.prototype.getShaderIndex=function(a){var c;var l=0;for(c=this.shaderPrograms.length;l<c;l++)if(this.shaderPrograms[l].name===
a)return l;return-1};b.prototype.project=function(a,c,l){var q=this.matMV,p=this.matP,w=[0,0,0,0,0,0,0,0];w[0]=q[0]*a+q[4]*c+q[12];w[1]=q[1]*a+q[5]*c+q[13];w[2]=q[2]*a+q[6]*c+q[14];w[3]=q[3]*a+q[7]*c+q[15];w[4]=p[0]*w[0]+p[4]*w[1]+p[8]*w[2]+p[12]*w[3];w[5]=p[1]*w[0]+p[5]*w[1]+p[9]*w[2]+p[13]*w[3];w[6]=p[2]*w[0]+p[6]*w[1]+p[10]*w[2]+p[14]*w[3];w[7]=-w[2];0!==w[7]&&(w[7]=1/w[7],w[4]*=w[7],w[5]*=w[7],w[6]*=w[7],l[0]=(.5*w[4]+.5)*this.width,l[1]=(.5*w[5]+.5)*this.height)};b.prototype.setSize=function(a,
c,l){if(this.width!==a||this.height!==c||l){this.endBatch();l=this.gl;this.width=a;this.height=c;l.viewport(0,0,a,c);mat4.lookAt(this.cam,this.look,this.up,this.matMV);this.enableFrontToBack?(mat4.ortho(-a/2,a/2,c/2,-c/2,this.zNear,this.zFar,this.matP),this.worldScale[0]=1,this.worldScale[1]=1):(mat4.perspective(45,a/c,this.zNear,this.zFar,this.matP),a=[0,0],c=[0,0],this.project(0,0,a),this.project(1,1,c),this.worldScale[0]=1/(c[0]-a[0]),this.worldScale[1]=-1/(c[1]-a[1]));a=0;for(c=this.shaderPrograms.length;a<
c;a++){var q=this.shaderPrograms[a];q.hasCurrentMatMV=!1;q.locMatP&&(l.useProgram(q.shaderProgram),l.uniformMatrix4fv(q.locMatP,!1,this.matP))}l.useProgram(this.shaderPrograms[this.lastProgram].shaderProgram);l.bindTexture(l.TEXTURE_2D,null);l.activeTexture(l.TEXTURE1);l.bindTexture(l.TEXTURE_2D,null);l.activeTexture(l.TEXTURE0);this.lastTexture1=this.lastTexture0=null;this.depthBuffer&&(l.bindFramebuffer(l.FRAMEBUFFER,this.fbo),l.bindRenderbuffer(l.RENDERBUFFER,this.depthBuffer),l.renderbufferStorage(l.RENDERBUFFER,
l.DEPTH_COMPONENT16,this.width,this.height),this.attachedDepthBuffer||(l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,this.depthBuffer),this.attachedDepthBuffer=!0),l.bindRenderbuffer(l.RENDERBUFFER,null),l.bindFramebuffer(l.FRAMEBUFFER,null),this.renderToTex=null)}};b.prototype.resetModelView=function(){mat4.lookAt(this.cam,this.look,this.up,this.matMV);mat4.scale(this.matMV,this.worldScale)};b.prototype.translate=function(a,c){if(0!==a||0!==c)this.tmpVec3[0]=a,this.tmpVec3[1]=
c,this.tmpVec3[2]=0,mat4.translate(this.matMV,this.tmpVec3)};b.prototype.scale=function(a,c){if(1!==a||1!==c)this.tmpVec3[0]=a,this.tmpVec3[1]=c,this.tmpVec3[2]=1,mat4.scale(this.matMV,this.tmpVec3)};b.prototype.rotateZ=function(a){0!==a&&mat4.rotateZ(this.matMV,a)};b.prototype.updateModelView=function(){if(!h(this.lastMV,this.matMV)){var a=this.pushBatch();a.type=5;a.mat4param?mat4.set(this.matMV,a.mat4param):a.mat4param=mat4.create(this.matMV);mat4.set(this.matMV,this.lastMV);this.hasPointBatchTop=
this.hasQuadBatchTop=!1}};b.prototype.setEarlyZIndex=function(a){this.enableFrontToBack&&(32760<a&&(a=32760),this.currentZ=this.cam[2]-this.zNear-a*this.zIncrement)};r.prototype.doSetEarlyZPass=function(){var a=this.gl,c=this.glwrap;0!==this.startIndex?(a.depthMask(!0),a.colorMask(!1,!1,!1,!1),a.disable(a.BLEND),a.bindFramebuffer(a.FRAMEBUFFER,c.fbo),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,null,0),a.clear(a.DEPTH_BUFFER_BIT),a.bindFramebuffer(a.FRAMEBUFFER,null),c.isBatchInEarlyZPass=
!0):(a.depthMask(!1),a.colorMask(!0,!0,!0,!0),a.enable(a.BLEND),c.isBatchInEarlyZPass=!1)};r.prototype.doSetTexture=function(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texParam)};r.prototype.doSetTexture1=function(){var a=this.gl;a.activeTexture(a.TEXTURE1);a.bindTexture(a.TEXTURE_2D,this.texParam);a.activeTexture(a.TEXTURE0)};r.prototype.doSetOpacity=function(){var a=this.opacityParam,c=this.glwrap;c.currentOpacity=a;c=c.currentShader;c.locOpacity&&c.lpOpacity!==a&&(c.lpOpacity=a,this.gl.uniform1f(c.locOpacity,
a))};r.prototype.doQuad=function(){this.gl.drawElements(this.gl.TRIANGLES,this.indexCount,this.gl.UNSIGNED_SHORT,this.startIndex)};r.prototype.doSetBlend=function(){this.gl.blendFunc(this.startIndex,this.indexCount)};r.prototype.doUpdateModelView=function(){var a,c=this.glwrap.shaderPrograms,l=this.glwrap.currentProgram;var q=0;for(a=c.length;q<a;q++){var p=c[q];q===l&&p.locMatMV?(p.updateMatMV(this.mat4param),p.hasCurrentMatMV=!0):p.hasCurrentMatMV=!1}mat4.set(this.mat4param,this.glwrap.currentMV)};
r.prototype.doRenderToTexture=function(){var a=this.gl,c=this.glwrap;this.texParam?(c.lastTexture1===this.texParam&&(a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,null),c.lastTexture1=null,a.activeTexture(a.TEXTURE0)),a.bindFramebuffer(a.FRAMEBUFFER,c.fbo),c.isBatchInEarlyZPass||a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.texParam,0)):(c.enableFrontToBack||a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,null,0),a.bindFramebuffer(a.FRAMEBUFFER,
null))};r.prototype.doClear=function(){var a=this.gl,c=this.startIndex;0===c?(a.clearColor(this.mat4param[0],this.mat4param[1],this.mat4param[2],this.mat4param[3]),a.clear(a.COLOR_BUFFER_BIT)):1===c?(a.enable(a.SCISSOR_TEST),a.scissor(this.mat4param[0],this.mat4param[1],this.mat4param[2],this.mat4param[3]),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT),a.disable(a.SCISSOR_TEST)):a.clear(a.DEPTH_BUFFER_BIT)};r.prototype.doSetDepthTestEnabled=function(){var a=this.gl;0!==this.startIndex?a.enable(a.DEPTH_TEST):
a.disable(a.DEPTH_TEST)};r.prototype.doPoints=function(){var a=this.gl,c=this.glwrap;c.enableFrontToBack&&a.disable(a.DEPTH_TEST);var l=c.shaderPrograms[1];a.useProgram(l.shaderProgram);!l.hasCurrentMatMV&&l.locMatMV&&(l.updateMatMV(c.currentMV),l.hasCurrentMatMV=!0);a.enableVertexAttribArray(l.locAPos);a.bindBuffer(a.ARRAY_BUFFER,c.pointBuffer);a.vertexAttribPointer(l.locAPos,4,a.FLOAT,!1,0,0);a.drawArrays(a.POINTS,this.startIndex/4,this.indexCount);l=c.currentShader;a.useProgram(l.shaderProgram);
0<=l.locAPos&&(a.enableVertexAttribArray(l.locAPos),a.bindBuffer(a.ARRAY_BUFFER,c.vertexBuffers[c.curBuffer]),a.vertexAttribPointer(l.locAPos,c.enableFrontToBack?3:2,a.FLOAT,!1,0,0));0<=l.locATex&&(a.enableVertexAttribArray(l.locATex),a.bindBuffer(a.ARRAY_BUFFER,c.texcoordBuffers[c.curBuffer]),a.vertexAttribPointer(l.locATex,2,a.FLOAT,!1,0,0));c.enableFrontToBack&&a.enable(a.DEPTH_TEST)};r.prototype.doSetProgram=function(){var a=this.gl,c=this.glwrap,l=c.shaderPrograms[this.startIndex];c.currentProgram=
this.startIndex;c.currentShader=l;a.useProgram(l.shaderProgram);!l.hasCurrentMatMV&&l.locMatMV&&(l.updateMatMV(c.currentMV),l.hasCurrentMatMV=!0);l.locOpacity&&l.lpOpacity!==c.currentOpacity&&(l.lpOpacity=c.currentOpacity,a.uniform1f(l.locOpacity,c.currentOpacity));0<=l.locAPos&&(a.enableVertexAttribArray(l.locAPos),a.bindBuffer(a.ARRAY_BUFFER,c.vertexBuffers[c.curBuffer]),a.vertexAttribPointer(l.locAPos,c.enableFrontToBack?3:2,a.FLOAT,!1,0,0));0<=l.locATex&&(a.enableVertexAttribArray(l.locATex),
a.bindBuffer(a.ARRAY_BUFFER,c.texcoordBuffers[c.curBuffer]),a.vertexAttribPointer(l.locATex,2,a.FLOAT,!1,0,0))};r.prototype.doSetColor=function(){var a=this.mat4param;this.gl.uniform4f(this.glwrap.currentShader.locColorFill,a[0],a[1],a[2],a[3])};r.prototype.doSetProgramParameters=function(){var a=this.glwrap.currentShader,c=this.gl;var l=this.mat4param;var q=this.layoutRect;var p=this.srcOriginRect;a.locSamplerBack&&this.glwrap.lastTexture1!==this.texParam&&(c.activeTexture(c.TEXTURE1),c.bindTexture(c.TEXTURE_2D,
this.texParam),this.glwrap.lastTexture1=this.texParam,c.activeTexture(c.TEXTURE0));var w=l[0],K=l[1];!a.locPixelSize||w===a.lpPixelWidth&&K===a.lpPixelHeight||(a.lpPixelWidth=w,a.lpPixelHeight=K,c.uniform2f(a.locPixelSize,w,K));w=l[2];K=l[3];!a.locDestStart||w===a.lpDestStartX&&K===a.lpDestStartY||(a.lpDestStartX=w,a.lpDestStartY=K,c.uniform2f(a.locDestStart,w,K));w=l[4];K=l[5];!a.locDestEnd||w===a.lpDestEndX&&K===a.lpDestEndY||(a.lpDestEndX=w,a.lpDestEndY=K,c.uniform2f(a.locDestEnd,w,K));w=l[6];
a.locLayerScale&&w!==a.lpLayerScale&&(a.lpLayerScale=w,c.uniform1f(a.locLayerScale,w));w=l[7];a.locLayerAngle&&w!==a.lpLayerAngle&&(a.lpLayerAngle=w,c.uniform1f(a.locLayerAngle,w));w=l[12];K=l[13];!a.locSrcStart||w===a.lpSrcStartX&&K===a.lpSrcStartY||(a.lpSrcStartX=w,a.lpSrcStartY=K,c.uniform2f(a.locSrcStart,w,K));w=l[14];K=l[15];!a.locSrcEnd||w===a.lpSrcEndX&&K===a.lpSrcEndY||(a.lpSrcEndX=w,a.lpSrcEndY=K,c.uniform2f(a.locSrcEnd,w,K));w=p[0];K=p[1];!a.locSrcOriginStart||w===a.lpSrcOriginStartX&&K===
a.lpSrcOriginStartY||(a.lpSrcOriginStartX=w,a.lpSrcOriginStartY=K,c.uniform2f(a.locSrcOriginStart,w,K));w=p[2];K=p[3];!a.locSrcOriginEnd||w===a.lpSrcOriginEndX&&K===a.lpSrcOriginEndY||(a.lpSrcOriginEndX=w,a.lpSrcOriginEndY=K,c.uniform2f(a.locSrcOriginEnd,w,K));w=q[0];K=q[1];!a.locLayoutStart||w===a.lpLayoutStartX&&K===a.lpLayoutStartY||(a.lpLayoutStartX=w,a.lpLayoutStartY=K,c.uniform2f(a.locLayoutStart,w,K));w=q[2];K=q[3];!a.locLayoutEnd||w===a.lpLayoutEndX&&K===a.lpLayoutEndY||(a.lpLayoutEndX=w,
a.lpLayoutEndY=K,c.uniform2f(a.locLayoutEnd,w,K));w=this.startIndex;a.locSeconds&&w!==a.lpSeconds&&(a.lpSeconds=w,c.uniform1f(a.locSeconds,w));if(a.parameters.length)for(l=0,q=a.parameters.length;l<q;l++)w=this.shaderParams[l],Array.isArray(w)?c.uniform3fv(a.parameters[l][1],w):w!==a.lastCustomParams[l]&&(a.lastCustomParams[l]=w,c.uniform1f(a.parameters[l][1],w))};b.prototype.pushBatch=function(){this.batchPtr===this.batch.length&&this.batch.push(new r(0,this));return this.batch[this.batchPtr++]};
b.prototype.endBatch=function(){if(0!==this.batchPtr&&!this.gl.isContextLost()){this.maybeStartTiming();var a=this.gl;0<this.pointPtr&&(a.bindBuffer(a.ARRAY_BUFFER,this.pointBuffer),a.bufferSubData(a.ARRAY_BUFFER,0,this.pointData.subarray(0,this.pointPtr)),c&&0<=c.locAPos&&"<point>"===c.name&&a.vertexAttribPointer(c.locAPos,4,a.FLOAT,!1,0,0));if(0<this.vertexPtr){var c=this.currentShader;a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffers[this.curBuffer]);a.bufferSubData(a.ARRAY_BUFFER,0,this.vertexData.subarray(0,
this.vertexPtr));c&&0<=c.locAPos&&"<point>"!==c.name&&a.vertexAttribPointer(c.locAPos,this.enableFrontToBack?3:2,a.FLOAT,!1,0,0);a.bindBuffer(a.ARRAY_BUFFER,this.texcoordBuffers[this.curBuffer]);a.bufferSubData(a.ARRAY_BUFFER,0,this.texcoordData.subarray(0,this.texPtr));c&&0<=c.locATex&&"<point>"!==c.name&&a.vertexAttribPointer(c.locATex,2,a.FLOAT,!1,0,0)}a=0;for(c=this.batchPtr;a<c;a++){var l=this.batch[a];switch(l.type){case 1:l.doQuad();break;case 2:l.doSetTexture();break;case 3:l.doSetOpacity();
break;case 4:l.doSetBlend();break;case 5:l.doUpdateModelView();break;case 6:l.doRenderToTexture();break;case 7:l.doClear();break;case 8:l.doPoints();break;case 9:l.doSetProgram();break;case 10:l.doSetProgramParameters();break;case 11:l.doSetTexture1();break;case 12:l.doSetColor();break;case 13:l.doSetDepthTestEnabled();break;case 14:l.doSetEarlyZPass()}}this.pointPtr=this.texPtr=this.vertexPtr=this.batchPtr=0;this.isBatchInEarlyZPass=this.hasPointBatchTop=this.hasQuadBatchTop=!1;this.curBuffer++;
4<=this.curBuffer&&(this.curBuffer=0)}};b.prototype.maybeStartTiming=function(){if(!this.isTiming&&this.timerExt){this.isTiming=!0;var a={frameNumber:this.frameNumber,query:null,result:0};2===this.version?(a.query=this.gl.createQuery(),this.gl.beginQuery(this.timerExt.TIME_ELAPSED_EXT,a.query)):(a.query=this.timerExt.createQueryEXT(),this.timerExt.beginQueryEXT(this.timerExt.TIME_ELAPSED_EXT,a.query));this.timerResults.push(a);1E3<this.timerResults.length&&(a=this.timerResults.shift(),a.query&&(2===
this.version?this.gl.deleteQuery(a.query):this.timerExt.deleteQueryEXT(a.query)))}};b.prototype.maybeFinishTiming=function(){this.isTiming&&this.timerResults.length&&(2===this.version?this.gl.endQuery(this.timerExt.TIME_ELAPSED_EXT):this.timerExt.endQueryEXT(this.timerExt.TIME_ELAPSED_EXT),this.isTiming=!1)};b.prototype.checkForTimerResults=function(a){var c;var l=0;for(c=this.timerResults.length;l<c;++l){var q=this.timerResults[l];if(q.frameNumber>=a)break;if(q.query){var p=2===this.version?this.gl.getQueryParameter(q.query,
this.gl.QUERY_RESULT_AVAILABLE):this.timerExt.getQueryObjectEXT(q.query,this.timerExt.QUERY_RESULT_AVAILABLE_EXT);var w=this.gl.getParameter(this.timerExt.GPU_DISJOINT_EXT);p&&!w&&(q.result=2===this.version?this.gl.getQueryParameter(q.query,this.gl.QUERY_RESULT):this.timerExt.getQueryObjectEXT(q.query,this.timerExt.QUERY_RESULT_EXT),q.result/=1E9);if(p||w)2===this.version?this.gl.deleteQuery(q.query):this.timerExt.deleteQueryEXT(q.query),q.query=null}}};b.prototype.getFrameRangeTimerResults=function(a,
c){if(c<=a)return-1;var l,q=0,p=0;var w=0;for(l=this.timerResults.length;w<l;++w){var K=this.timerResults[w];if(K.frameNumber>=c)break;if(K.frameNumber>=a){if(K.query)return-1;q+=K.result;p++}}return p<c-a?-1:q};b.prototype.deleteTimerResultsToFrame=function(a){var c;var l=0;for(c=this.timerResults.length;l<c;++l){var q=this.timerResults[l];if(q.frameNumber>=a){0<l&&this.timerResults.splice(0,l);break}}};b.prototype.setOpacity=function(a){if(a!==this.lastOpacity&&!this.isEarlyZPass){var c=this.pushBatch();
c.type=3;this.lastOpacity=c.opacityParam=a;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.setTexture=function(a){if(a!==this.lastTexture0){var c=this.pushBatch();c.type=2;this.lastTexture0=c.texParam=a;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.setBlend=function(a,c){if((a!==this.lastSrcBlend||c!==this.lastDestBlend)&&!this.isEarlyZPass){var l=this.pushBatch();l.type=4;l.startIndex=a;l.indexCount=c;this.lastSrcBlend=a;this.lastDestBlend=c;this.hasPointBatchTop=this.hasQuadBatchTop=
!1}};b.prototype.isPremultipliedAlphaBlend=function(){return this.lastSrcBlend===this.gl.ONE&&this.lastDestBlend===this.gl.ONE_MINUS_SRC_ALPHA};b.prototype.setAlphaBlend=function(){this.setBlend(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)};b.prototype.setNoPremultiplyAlphaBlend=function(){this.setBlend(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)};b.prototype.quad=function(a,c,l,q,p,w,K,A){15992<=this.vertexPtr&&this.endBatch();var J=this.vertexPtr,R=this.texPtr,n=this.vertexData,x=this.texcoordData,
E=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var V=this.pushBatch();V.type=1;V.startIndex=this.enableFrontToBack?J:J/2*3;V.indexCount=6;this.hasQuadBatchTop=!0;this.hasPointBatchTop=!1}this.enableFrontToBack?(n[J++]=a,n[J++]=c,n[J++]=E,n[J++]=l,n[J++]=q,n[J++]=E,n[J++]=p,n[J++]=w,n[J++]=E,n[J++]=K,n[J++]=A,n[J++]=E):(n[J++]=a,n[J++]=c,n[J++]=l,n[J++]=q,n[J++]=p,n[J++]=w,n[J++]=K,n[J++]=A);x[R++]=0;x[R++]=0;x[R++]=1;x[R++]=0;x[R++]=1;x[R++]=1;x[R++]=0;x[R++]=
1;this.vertexPtr=J;this.texPtr=R};b.prototype.quadTex=function(a,c,l,q,p,w,K,A,J){15992<=this.vertexPtr&&this.endBatch();var R=this.vertexPtr,n=this.texPtr,x=this.vertexData,E=this.texcoordData,V=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var Z=this.pushBatch();Z.type=1;Z.startIndex=this.enableFrontToBack?R:R/2*3;Z.indexCount=6;this.hasQuadBatchTop=!0;this.hasPointBatchTop=!1}Z=J.left;var M=J.top,d=J.right;J=J.bottom;this.enableFrontToBack?(x[R++]=a,x[R++]=
c,x[R++]=V,x[R++]=l,x[R++]=q,x[R++]=V,x[R++]=p,x[R++]=w,x[R++]=V,x[R++]=K,x[R++]=A,x[R++]=V):(x[R++]=a,x[R++]=c,x[R++]=l,x[R++]=q,x[R++]=p,x[R++]=w,x[R++]=K,x[R++]=A);E[n++]=Z;E[n++]=M;E[n++]=d;E[n++]=M;E[n++]=d;E[n++]=J;E[n++]=Z;E[n++]=J;this.vertexPtr=R;this.texPtr=n};b.prototype.quadTexUV=function(a,c,l,q,p,w,K,A,J,R,n,x,E,V,Z,M){15992<=this.vertexPtr&&this.endBatch();var d=this.vertexPtr,m=this.texPtr,G=this.vertexData,f=this.texcoordData,y=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-
1].indexCount+=6;else{var L=this.pushBatch();L.type=1;L.startIndex=this.enableFrontToBack?d:d/2*3;L.indexCount=6;this.hasQuadBatchTop=!0;this.hasPointBatchTop=!1}this.enableFrontToBack?(G[d++]=a,G[d++]=c,G[d++]=y,G[d++]=l,G[d++]=q,G[d++]=y,G[d++]=p,G[d++]=w,G[d++]=y,G[d++]=K,G[d++]=A,G[d++]=y):(G[d++]=a,G[d++]=c,G[d++]=l,G[d++]=q,G[d++]=p,G[d++]=w,G[d++]=K,G[d++]=A);f[m++]=J;f[m++]=R;f[m++]=n;f[m++]=x;f[m++]=E;f[m++]=V;f[m++]=Z;f[m++]=M;this.vertexPtr=d;this.texPtr=m};b.prototype.convexPoly=function(a){var c=
a.length/2-2,l=c-1,q=a[0],p=a[1],w;for(w=0;w<c;w+=2){var K=2*w;var A=a[K+2];var J=a[K+3];var R=a[K+4];var n=a[K+5];if(w===l)this.quad(q,p,A,J,R,n,R,n);else{var x=a[K+6];K=a[K+7];this.quad(q,p,A,J,R,n,x,K)}}};b.prototype.point=function(a,c,l,q){7996<=this.pointPtr&&this.endBatch();var p=this.pointPtr,w=this.pointData;if(this.hasPointBatchTop)this.batch[this.batchPtr-1].indexCount++;else{var K=this.pushBatch();K.type=8;K.startIndex=p;K.indexCount=1;this.hasPointBatchTop=!0;this.hasQuadBatchTop=!1}w[p++]=
a;w[p++]=c;w[p++]=l;w[p++]=q;this.pointPtr=p};b.prototype.switchProgram=function(a){if(this.lastProgram!==a){if(!this.shaderPrograms[a]){if(0===this.lastProgram)return;a=0}var c=this.pushBatch();c.type=9;this.lastProgram=c.startIndex=a;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.programUsesDest=function(a){a=this.shaderPrograms[a];return!(!a.locDestStart&&!a.locDestEnd)};b.prototype.programUsesCrossSampling=function(a){a=this.shaderPrograms[a];return!!(a.locDestStart||a.locDestEnd||
a.crossSampling)};b.prototype.programPreservesOpaqueness=function(a){return this.shaderPrograms[a].preservesOpaqueness};b.prototype.programExtendsBox=function(a){a=this.shaderPrograms[a];return 0!==a.extendBoxHorizontal||0!==a.extendBoxVertical};b.prototype.getProgramBoxExtendHorizontal=function(a){return this.shaderPrograms[a].extendBoxHorizontal};b.prototype.getProgramBoxExtendVertical=function(a){return this.shaderPrograms[a].extendBoxVertical};b.prototype.getProgramParameterType=function(a,c){return this.shaderPrograms[a].parameters[c][2]};
b.prototype.programIsAnimated=function(a){return this.shaderPrograms[a].animated};b.prototype.setProgramParameters=function(a,c,l,q,p,w,K,A,J,R,n,x,E,V,Z,M,d,m,G,f,y,L,P){var X=this.shaderPrograms[this.lastProgram];if(X.hasAnyOptionalUniforms||P.length){var ba=this.pushBatch();ba.type=10;ba.mat4param?mat4.set(this.matMV,ba.mat4param):ba.mat4param=mat4.create();var aa=ba.mat4param;aa[0]=c;aa[1]=l;aa[2]=M;aa[3]=d;aa[4]=m;aa[5]=G;aa[6]=f;aa[7]=y;aa[12]=q;aa[13]=p;aa[14]=w;aa[15]=K;c=ba.srcOriginRect;
c[0]=A;c[1]=J;c[2]=R;c[3]=n;A=ba.layoutRect;A[0]=x;A[1]=Z;A[2]=V;A[3]=E;ba.startIndex=L;ba.texParam=X.locSamplerBack?a:null;if(P.length)for(E=ba.shaderParams,E.length=P.length,a=0,x=P.length;a<x;a++)E[a]=P[a];this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.clear=function(a,c,l,q){var p=this.pushBatch();p.type=7;p.startIndex=0;p.mat4param||(p.mat4param=mat4.create());p.mat4param[0]=a;p.mat4param[1]=c;p.mat4param[2]=l;p.mat4param[3]=q;this.hasPointBatchTop=this.hasQuadBatchTop=!1};b.prototype.clearRect=
function(a,c,l,q){if(!(0>l||0>q)){var p=this.pushBatch();p.type=7;p.startIndex=1;p.mat4param||(p.mat4param=mat4.create());p.mat4param[0]=a;p.mat4param[1]=c;p.mat4param[2]=l;p.mat4param[3]=q;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.clearDepth=function(){var a=this.pushBatch();a.type=7;a.startIndex=2;this.hasPointBatchTop=this.hasQuadBatchTop=!1};b.prototype.setEarlyZPass=function(a){if(this.enableFrontToBack&&(a=!!a,this.isEarlyZPass!==a)){var c=this.pushBatch();c.type=14;c.startIndex=
a?1:0;this.hasPointBatchTop=this.hasQuadBatchTop=!1;this.isEarlyZPass=a;this.renderToTex=null;this.isEarlyZPass?this.switchProgram(2):this.switchProgram(0)}};b.prototype.setDepthTestEnabled=function(a){if(this.enableFrontToBack){var c=this.pushBatch();c.type=13;c.startIndex=a?1:0;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};b.prototype.fullscreenQuad=function(){mat4.set(this.lastMV,z);this.resetModelView();this.updateModelView();var a=this.width/2,c=this.height/2;this.quad(-a,c,a,c,a,-c,-a,-c);
mat4.set(z,this.matMV);this.updateModelView()};b.prototype.setColorFillMode=function(a,c,l,q){this.switchProgram(3);var p=this.pushBatch();p.type=12;p.mat4param||(p.mat4param=mat4.create());p.mat4param[0]=a;p.mat4param[1]=c;p.mat4param[2]=l;p.mat4param[3]=q;this.hasPointBatchTop=this.hasQuadBatchTop=!1};b.prototype.setTextureFillMode=function(){this.switchProgram(0)};b.prototype.restoreEarlyZMode=function(){this.switchProgram(2)};b.prototype.getFrameNumber=function(){return this.frameNumber};b.prototype.present=
function(){this.endBatch();this.maybeFinishTiming();this.gl.flush();this.checkForTimerResults(this.frameNumber);this.frameNumber++};b.prototype.supportsGpuProfiling=function(){return!!this.timerExt};var N=[],k={};b.prototype.contextLost=function(){cr.clearArray(N);k={}};b.prototype.loadTexture=function(a,c,l,q,p,w){c=!!c;l=!!l;var K=a.src+","+c+","+l+(c?","+p:"");if("undefined"!==typeof a.src&&k.hasOwnProperty(K)){var A=k[K];A.c2refcount++;return A}this.endBatch();var J=this.gl,R=cr.isPOT(a.width)&&
cr.isPOT(a.height);A=J.createTexture();J.bindTexture(J.TEXTURE_2D,A);J.pixelStorei(J.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);var n=J.RGBA,x=J.RGBA,E=J.UNSIGNED_BYTE;if(q&&!this.isIE)switch(q){case 1:x=n=J.RGB;break;case 2:E=J.UNSIGNED_SHORT_4_4_4_4;break;case 3:E=J.UNSIGNED_SHORT_5_5_5_1;break;case 4:x=n=J.RGB,E=J.UNSIGNED_SHORT_5_6_5}if(1===this.version&&!R&&c){q=document.createElement("canvas");q.width=cr.nextHighestPowerOfTwo(a.width);q.height=cr.nextHighestPowerOfTwo(a.height);var V=q.getContext("2d");
V.imageSmoothingEnabled=l;V.drawImage(a,0,0,a.width,a.height,0,0,q.width,q.height);J.texImage2D(J.TEXTURE_2D,0,n,x,E,q)}else J.texImage2D(J.TEXTURE_2D,0,n,x,E,a);c?"repeat-x"===p?(J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_S,J.REPEAT),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_T,J.CLAMP_TO_EDGE)):("repeat-y"===p?J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_S,J.CLAMP_TO_EDGE):J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_S,J.REPEAT),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_T,J.REPEAT)):(J.texParameteri(J.TEXTURE_2D,
J.TEXTURE_WRAP_S,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_WRAP_T,J.CLAMP_TO_EDGE));l?(J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MAG_FILTER,J.LINEAR),(R||2<=this.version)&&this.enable_mipmaps&&!w?(J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MIN_FILTER,J.LINEAR_MIPMAP_LINEAR),J.generateMipmap(J.TEXTURE_2D)):J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MIN_FILTER,J.LINEAR)):(J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MAG_FILTER,J.NEAREST),J.texParameteri(J.TEXTURE_2D,J.TEXTURE_MIN_FILTER,J.NEAREST));J.bindTexture(J.TEXTURE_2D,
null);this.lastTexture0=null;A.c2width=a.width;A.c2height=a.height;A.c2refcount=1;A.c2texkey=K;N.push(A);return k[K]=A};b.prototype.createEmptyTexture=function(a,c,l,q,p){this.endBatch();var w=this.gl;this.isIE&&(q=!1);var K=w.createTexture();w.bindTexture(w.TEXTURE_2D,K);w.texImage2D(w.TEXTURE_2D,0,w.RGBA,a,c,0,w.RGBA,q?w.UNSIGNED_SHORT_4_4_4_4:w.UNSIGNED_BYTE,null);p?(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.REPEAT),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.REPEAT)):(w.texParameteri(w.TEXTURE_2D,
w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE));w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,l?w.LINEAR:w.NEAREST);w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,l?w.LINEAR:w.NEAREST);w.bindTexture(w.TEXTURE_2D,null);this.lastTexture0=null;K.c2width=a;K.c2height=c;N.push(K);return K};b.prototype.videoToTexture=function(a,c,l){this.endBatch();var q=this.gl;this.isIE&&(l=!1);q.bindTexture(q.TEXTURE_2D,c);q.pixelStorei(q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
!0);try{q.texImage2D(q.TEXTURE_2D,0,q.RGBA,q.RGBA,l?q.UNSIGNED_SHORT_4_4_4_4:q.UNSIGNED_BYTE,a)}catch(p){console&&console.error&&console.error("Error updating WebGL texture: ",p)}q.bindTexture(q.TEXTURE_2D,null);this.lastTexture0=null};b.prototype.deleteTexture=function(a){a&&("undefined"!==typeof a.c2refcount&&1<a.c2refcount?a.c2refcount--:(this.endBatch(),a===this.lastTexture0&&(this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.lastTexture0=null),a===this.lastTexture1&&(this.gl.activeTexture(this.gl.TEXTURE1),
this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.activeTexture(this.gl.TEXTURE0),this.lastTexture1=null),cr.arrayFindRemove(N,a),"undefined"!==typeof a.c2texkey&&delete k[a.c2texkey],this.gl.deleteTexture(a)))};b.prototype.estimateVRAM=function(){var a=this.width*this.height*8,c;var l=0;for(c=N.length;l<c;l++){var q=N[l];a+=q.c2width*q.c2height*4}return a};b.prototype.textureCount=function(){return N.length};b.prototype.setRenderingToTexture=function(a){if(a!==this.renderToTex){var c=this.pushBatch();
c.type=6;this.renderToTex=c.texParam=a;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};cr.GLWrap=b})();
(function(){function b(g){var u=g.canvas,D=g.projectDataUrl;u||(u=document.createElement("canvas"),document.body.appendChild(u));if(u&&u.getContext){window.c3runtime=this;window.c3canvas=u;var I=this;this.exportType=g.exportType;this.isPreview="preview"===this.exportType;this.isRemotePreview=!!g.isRemotePreview;this.isCrosswalk=/crosswalk/i.test(navigator.userAgent)||/xwalk/i.test(navigator.userAgent)||!("undefined"===typeof window.c2isCrosswalk||!window.c2isCrosswalk);this.isPhoneGap=this.isCordova=
"cordova"===this.exportType;this.isMicrosoftEdge=/edge\//i.test(navigator.userAgent);this.isIE=(/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent)||/iemobile/i.test(navigator.userAgent))&&!this.isMicrosoftEdge;this.isTizen=/tizen/i.test(navigator.userAgent);this.isAndroid=/android/i.test(navigator.userAgent)&&!this.isTizen&&!this.isIE&&!this.isMicrosoftEdge;this.isiPhone=(/iphone/i.test(navigator.userAgent)||/ipod/i.test(navigator.userAgent))&&!this.isIE&&!this.isMicrosoftEdge;
this.isiPad=/ipad/i.test(navigator.userAgent);this.isiOS=this.isiPhone||this.isiPad;this.isChrome=(/chrome/i.test(navigator.userAgent)||/chromium/i.test(navigator.userAgent))&&!this.isIE&&!this.isMicrosoftEdge;this.isAmazonWebApp=/amazonwebappplatform/i.test(navigator.userAgent);this.isFirefox=/firefox/i.test(navigator.userAgent);this.isSafari=/safari/i.test(navigator.userAgent)&&!this.isChrome&&!this.isIE&&!this.isMicrosoftEdge;this.isWindows=/windows/i.test(navigator.userAgent);this.isNodeWebkit=
this.isNWjs="nwjs"===this.exportType||/nodewebkit/i.test(navigator.userAgent)||/nwjs/i.test(navigator.userAgent);this.isArcade="scirra-arcade"===this.exportType;this.isWindows8App=!("undefined"===typeof window.c2isWindows8||!window.c2isWindows8);this.isWindowsPhone8=!("undefined"===typeof window.c2isWindowsPhone8||!window.c2isWindowsPhone8);this.isWindowsPhone81=!("undefined"===typeof window.c2isWindowsPhone81||!window.c2isWindowsPhone81);this.isWindows10="windows-uwp"===this.exportType;this.isWinJS=
this.isWindows8App||this.isWindowsPhone81||this.isWindows10;this.isBlackberry10=!("undefined"===typeof window.c2isBlackberry10||!window.c2isBlackberry10);this.isAndroidStockBrowser=this.isAndroid&&!this.isChrome&&!this.isCrosswalk&&!this.isFirefox&&!this.isAmazonWebApp;this.devicePixelRatio=1;this.isMobile=this.isCordova||this.isCrosswalk||this.isAndroid||this.isiOS||this.isWindowsPhone8||this.isWindowsPhone81||this.isBlackberry10||this.isTizen;this.isMobile||(this.isMobile=/(blackberry|bb10|playbook|palm|symbian|nokia|windows\s+ce|phone|mobile|tablet|kindle|silk)/i.test(navigator.userAgent));
this.isWKWebView=!(!this.isiOS||!this.isCordova);this.isPreview&&!this.isNWjs&&("?nw"===window.location.search||/nodewebkit/i.test(navigator.userAgent)||/nwjs/i.test(navigator.userAgent))&&(this.isNWjs=!0);this.isDebug=this.isPreview&&-1<window.location.search.indexOf("debug");this.useFbInstant="undefined"!==typeof FBInstant&&!this.isPreview&&!this.isCordova;this.hasInitialized=!1;this.canvas=u;this.glwrap=this.gl=null;this.glUnmaskedRenderer="(unavailable)";this.enableFrontToBack=!1;this.earlyz_index=
0;this.ctx=null;this.firstInFullscreen=!1;this.oldHeight=this.oldWidth=0;this.canvas.oncontextmenu=function(B){B.preventDefault&&B.preventDefault();return!1};this.canvas.onselectstart=function(B){B.preventDefault&&B.preventDefault();return!1};this.canvas.ontouchstart=function(B){B.preventDefault&&B.preventDefault();return!1};this.isNWjs&&(window.ondragover=function(B){B.preventDefault();return!1},window.ondrop=function(B){B.preventDefault();return!1},window.nwgui&&window.nwgui.App.clearCache&&window.nwgui.App.clearCache());
if(this.isCordova&&this.isiOS){function B(){var t=document.activeElement;if(!t)return!1;var C=t.tagName.toLowerCase(),F="email number password search tel text url".split(" ");if("textarea"===C)return!0;if("input"===C)return-1<F.indexOf(t.type.toLowerCase()||"text");a:{do{if(t.parentNode&&t.hasAttribute("contenteditable")){t=!0;break a}t=t.parentNode}while(t);t=!1}return t}window.addEventListener("focusout",function(){B()||(document.scrollingElement.scrollTop=0)})}this.projectDataUrl=D||"";this.width=
u.width;this.height=u.height;this.draw_width=this.width;this.draw_height=this.height;this.cssWidth=this.width;this.cssHeight=this.height;this.lastWindowWidth=window.innerWidth;this.lastWindowHeight=window.innerHeight;this.forceCanvasAlpha=!1;this.redraw=!0;this.isSuspended=!1;Date.now||(Date.now=function(){return+new Date});this.plugins=[];this.types={};this.types_lowercase={};this.types_by_index=[];this.behaviors=[];this.layouts={};this.layouts_by_index=[];this.eventsheets={};this.eventsheets_by_index=
[];this.wait_for_textures=[];this.triggers_to_postinit=[];this.all_global_vars=[];this.all_local_vars=[];this.shadowcasterBehavior=this.jumpthruBehavior=this.solidBehavior=null;this.deathRow={};this.isInClearDeathRow=this.hasPendingInstances=!1;this.isInOnDestroy=0;this.isEndingLayout=this.isRunningEvents=!1;this.createRow=[];this.isLoadingState=!1;this.loadFromSlot=this.saveToSlot="";this.loadFromJson=null;this.lastSaveJson="";this.suspendDrawing=this.signalledContinuousPreview=!1;this.fireOnCreateAfterLoad=
[];this.dt1=this.dt=0;this.minimumFramerate=30;this.cpuutilisation=this.logictime=0;this.timescale=1;this.kahanTime=new cr.KahanAdder;this.wallTime=new cr.KahanAdder;this.gpuTimeEndFrame=this.gpuTimeStartFrame=this.objectcount=this.framecount=this.execcount=this.tickcount_nosave=this.tickcount=this.last_fps_time=this.fps=this.last_tick_time=0;this.gpuCurUtilisation=-1;this.gpuLastUtilisation=0;this.changelayout=null;this.destroycallbacks=[];this.event_stack=[];this.event_stack_index=-1;this.localvar_stack=
[[]];this.trigger_depth=this.localvar_stack_index=0;this.pushEventStack(null);this.loop_stack=[];this.loop_stack_index=-1;this.next_puid=this.next_uid=0;this.layout_first_tick=!0;this.family_count=0;this.suspend_events=[];this.timeout_id=this.raf_id=-1;this.isloading=!0;this.stackLocalCount=this.loadingprogress=0;this.audioInstance=null;this.isInUserInputEvent=this.had_a_click=!1;this.objects_to_pretick=new cr.ObjectSet;this.objects_to_tick=new cr.ObjectSet;this.objects_to_tick2=new cr.ObjectSet;
this.registered_collisions=[];this.temp_poly=new cr.CollisionPoly([]);this.temp_poly2=new cr.CollisionPoly([]);this.allGroups=[];this.groups_by_name={};this.cndsBySid={};this.actsBySid={};this.varsBySid={};this.blocksBySid={};this.layout_ctx=this.layout_canvas=this.layout_tex=this.layer_tex=this.layer_ctx=this.layer_canvas=this.running_layout=null;this.uses_background_blending=this.is_WebGL_context_lost=!1;this.fx_tex=[null,null];this.fullscreen_scaling=0;this.files_subfolder="";this.objectsByUid=
{};this.webFontNames=this.loaderlogos=null;this.enhancedAccelerationPrecision=!0;this.snapshotCanvas=null;this.snapshotData="";this.objectRefTable=[];"html5"===this.exportType&&"file"===location.protocol.substr(0,4)&&alert("Exported games won't work until you upload them. (When running on the file: protocol, browsers block many features from working for security reasons.)");this.useFbInstant?(FBInstant.initializeAsync().then(function(){I.requestProjectData()}).catch(function(B){console.warn("[Instant Games] Unable to load: ",
B);I.requestProjectData()}),window.setTimeout(function(){I.hasInitialized||(console.warn("[Instant Games] Initialization timed out after 4 seconds. Continuing with Instant Games disabled."),I.useFbInstant=!1,I.requestProjectData())},4E3)):this.requestProjectData()}}function e(){var g=window.cordova&&window.cordova.plugins&&window.cordova.plugins.permissions;"object"!==typeof g&&Promise.reject("Permission API is not loaded");return Promise.resolve(g)}function h(g){return e().then(function(u){return new Promise(function(D,
I){u.requestPermission(u[g],function(B){D(B.hasPermission)},I)})})}function r(g){return e().then(function(u){return new Promise(function(D,I){u.checkPermission(u[g],function(B){D(B.hasPermission)},I)})})}function z(){try{return!!window.indexedDB}catch(g){return!1}}function N(g){g.target.result.createObjectStore("saves",{keyPath:"slot"})}function k(g,u,D,I){try{var B=indexedDB.open("_C2SaveStates");B.onupgradeneeded=N;B.onerror=I;B.onsuccess=function(t){t=t.target.result;t.onerror=I;t.transaction(["saves"],
"readwrite").objectStore("saves").put({slot:g,data:u}).onsuccess=D}}catch(t){I(t)}}function a(g,u,D){try{var I=indexedDB.open("_C2SaveStates");I.onupgradeneeded=N;I.onerror=D;I.onsuccess=function(B){B=B.target.result;B.onerror=D;var t=B.transaction(["saves"]).objectStore("saves").get(g);t.onsuccess=function(C){t.result?u(t.result.data):u(null)}}}catch(B){D(B)}}function c(){cr.logexport("Reloading for continuous preview");-1<window.location.search.indexOf("continuous")?window.location.reload(!0):window.location+=
"?continuous"}function l(g){var u,D={};for(u in g)!g.hasOwnProperty(u)||g[u]instanceof cr.ObjectSet||g[u]&&"undefined"!==typeof g[u].c2userdata||"spriteCreatedDestroyCallback"!==u&&(D[u]=g[u]);return D}var q=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame,p=new Audio,w={"audio/webm; codecs=opus":!!p.canPlayType("audio/webm; codecs=opus"),"audio/ogg; codecs=opus":!!p.canPlayType("audio/ogg; codecs=opus"),
"audio/webm; codecs=vorbis":!!p.canPlayType("audio/webm; codecs=vorbis"),"audio/ogg; codecs=vorbis":!!p.canPlayType("audio/ogg; codecs=vorbis"),"audio/mp4":!!p.canPlayType("audio/mp4"),"audio/mpeg":!!p.canPlayType("audio/mpeg")};p=null;b.prototype.requestProjectData=function(){if(!this.hasInitialized){this.hasInitialized=!0;var g=this;if(this.isWKWebView)this.fetchLocalFileViaCordovaAsText("data.js",function(B){g.loadProject(JSON.parse(B))},function(B){alert("Error fetching data.js")});else{var u=
this.isWindowsPhone8?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;var D=this.projectDataUrl||"data.js";if(this.isWindows8App||this.isWindowsPhone8||this.isWindowsPhone81||this.isWindows10)D="data.json";u.open("GET",D,!0);var I=!1;if("response"in u&&"responseType"in u)try{u.responseType="json",I="json"===u.responseType}catch(B){I=!1}if(!I&&"responseType"in u)try{u.responseType="text"}catch(B){}if("overrideMimeType"in u)try{u.overrideMimeType("application/json; charset=utf-8")}catch(B){}this.isWindowsPhone8?
u.onreadystatechange=function(){4===u.readyState&&g.loadProject(JSON.parse(u.responseText))}:(u.onload=function(){I?g.loadProject(u.response):g.loadProject(JSON.parse(u.responseText))},u.onerror=function(B){cr.logerror("Error requesting "+D+":");cr.logerror(B)});u.send()}}};b.prototype.initRendererAndLoader=function(){var g=this,u,D;this.isRetina=this.useHighDpi&&!this.isAndroidStockBrowser;0===this.fullscreen_mode&&this.isiOS&&(this.isRetina=!1);var I=window.devicePixelRatio||window.webkitDevicePixelRatio||
window.mozDevicePixelRatio||window.msDevicePixelRatio||1;this.devicePixelRatio=this.isRetina?I:1;"object"===typeof window.StatusBar&&window.StatusBar.hide();"object"===typeof window.AndroidFullScreen&&window.AndroidFullScreen.immersiveMode();this.ClearDeathRow();0<this.fullscreen_mode&&this.setSize(window.innerWidth,window.innerHeight,!0);try{if(this.enableWebGL){var B={alpha:!0,depth:!1,antialias:!1,failIfMajorPerformanceCaveat:!0};this.isAndroid||(this.gl=this.canvas.getContext("webgl2",B));this.gl||
(this.gl=this.canvas.getContext("webgl",B)||this.canvas.getContext("experimental-webgl",B))}}catch(T){}if(this.gl){this.gl.getParameter(this.gl.VERSION).indexOf("WebGL 2");if(I=this.gl.getExtension("WEBGL_debug_renderer_info"))B=this.gl.getParameter(I.UNMASKED_VENDOR_WEBGL),this.glUnmaskedRenderer=this.gl.getParameter(I.UNMASKED_RENDERER_WEBGL)+" ["+B+"]";this.enableFrontToBack&&(this.glUnmaskedRenderer+=" [front-to-back enabled]");this.overlay_canvas=document.createElement("canvas");this.canvas.parentNode.appendChild(this.overlay_canvas);
this.overlay_canvas.oncontextmenu=function(T){return!1};this.overlay_canvas.onselectstart=function(T){return!1};this.overlay_canvas.width=Math.round(this.cssWidth*this.devicePixelRatio);this.overlay_canvas.height=Math.round(this.cssHeight*this.devicePixelRatio);this.overlay_canvas.style.width=this.cssWidth+"px";this.overlay_canvas.style.height=this.cssHeight+"px";this.overlay_canvas.style.position="absolute";this.overlay_ctx=this.overlay_canvas.getContext("2d");this.glwrap=new cr.GLWrap(this.gl,this.isMobile,
this.enableFrontToBack);this.glwrap.setSize(this.canvas.width,this.canvas.height);this.glwrap.enable_mipmaps=0!==this.downscalingQuality;this.ctx=null;this.canvas.addEventListener("webglcontextlost",function(T){T.preventDefault();g.onContextLost();cr.logexport("[Construct 2] WebGL context lost");window.cr_setSuspended(!0)},!1);this.canvas.addEventListener("webglcontextrestored",function(T){g.glwrap.initState();g.glwrap.setSize(g.glwrap.width,g.glwrap.height,!0);g.layer_tex=null;g.layout_tex=null;
g.fx_tex[0]=null;g.fx_tex[1]=null;g.onContextRestored();g.redraw=!0;cr.logexport("[Construct 2] WebGL context restored");window.cr_setSuspended(!1)},!1);this.glwrap.supportsGpuProfiling()||(this.gpuLastUtilisation=NaN);I=0;for(B=this.types_by_index.length;I<B;I++){var t=this.types_by_index[I];var C=0;for(u=t.effect_types.length;C<u;C++){var F=t.effect_types[C];F.shaderindex=this.glwrap.getShaderIndex(F.id);F.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(F.shaderindex);this.uses_background_blending=
this.uses_background_blending||this.glwrap.programUsesDest(F.shaderindex)}}I=0;for(B=this.layouts_by_index.length;I<B;I++){var O=this.layouts_by_index[I];C=0;for(u=O.effect_types.length;C<u;C++)F=O.effect_types[C],F.shaderindex=this.glwrap.getShaderIndex(F.id),F.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(F.shaderindex);O.updateActiveEffects();C=0;for(u=O.layers.length;C<u;C++){var W=O.layers[C];t=0;for(D=W.effect_types.length;t<D;t++)F=W.effect_types[t],F.shaderindex=this.glwrap.getShaderIndex(F.id),
F.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(F.shaderindex),this.uses_background_blending=this.uses_background_blending||this.glwrap.programUsesDest(F.shaderindex);W.updateActiveEffects()}}}else B={alpha:!0},this.ctx=this.canvas.getContext("2d",B),this.ctx.imageSmoothingEnabled=this.linearSampling,this.overlay_ctx=this.overlay_canvas=null,this.gpuLastUtilisation=NaN,this.fullscreenScalingQuality=this.wantFullscreenScalingQuality=!0;this.tickFunc=function(T){g.tick(!1,T)};window==window.top||
this.isWinJS||this.isWindowsPhone8||(document.addEventListener("mousedown",function(){window.focus()},!0),document.addEventListener("touchstart",function(){window.focus()},!0));this.isPreview&&(-1<window.location.search.indexOf("continuous")&&(cr.logexport("Reloading for continuous preview"),this.loadFromSlot="__c2_continuouspreview",this.suspendDrawing=!0),this.pauseOnBlur&&!this.isMobile&&(window.addEventListener("focus",function(){g.setSuspended(!1)}),window.addEventListener("blur",function(){var T=
window.parent;T&&T.document.hasFocus()||g.setSuspended(!0)})));window.addEventListener("blur",function(){g.onWindowBlur()});I=function(T){"mousedown"===T.type&&1===T.button&&T.preventDefault();if(cr.isCanvasInputEvent(T)&&document.activeElement&&document.activeElement!==document.getElementsByTagName("body")[0]&&document.activeElement.blur)try{document.activeElement.blur()}catch(U){}};"undefined"!==typeof PointerEvent?document.addEventListener("pointerdown",I):window.navigator.msPointerEnabled?document.addEventListener("MSPointerDown",
I):document.addEventListener("touchstart",I);document.addEventListener("mousedown",I);0===this.fullscreen_mode&&this.isRetina&&1<this.devicePixelRatio?this.setSize(this.original_width,this.original_height,!0):this.setSize(window.innerWidth,window.innerHeight,!0);this.tryLockOrientation();this.getready();this.go();this.extra={};cr.seal(this)};b.prototype.setSize=function(g,u,D){var I=0,B=0;if(this.lastWindowWidth!==g||this.lastWindowHeight!==u||D){if(this.isiPhone&&this.isCordova&&window.screen){var t=
document.documentElement.style;var C=document.body.style;var F=window.innerWidth<window.innerHeight;var O=F?window.screen.height:window.screen.width;F=F?window.screen.width:window.screen.height;O&&F&&(C.height=t.height=O+"px",C.width=t.width=F+"px")}this.lastWindowWidth=g;this.lastWindowHeight=u;t=this.fullscreen_mode;if((C=(document.mozFullScreen||document.webkitIsFullScreen||!!document.msFullscreenElement||document.fullScreen)&&!this.isCordova)||0!==this.fullscreen_mode||D)C&&(t=this.fullscreen_scaling),
D=this.devicePixelRatio,4<=t?(5===t&&1!==D&&(g+=1,u+=1),C=this.original_width/this.original_height,g/u>C?(C*=u,5===t?(I=C*D/this.original_width,1<I?I=Math.floor(I):1>I&&(I=1/Math.ceil(1/I)),C=this.original_width*I/D,O=this.original_height*I/D,I=(g-C)/2,B=(u-O)/2,g=C,u=O):(I=(g-C)/2,g=C)):(O=g/C,5===t?(I=O*D/this.original_height,1<I?I=Math.floor(I):1>I&&(I=1/Math.ceil(1/I)),C=this.original_width*I/D,O=this.original_height*I/D,I=(g-C)/2,B=(u-O)/2,g=C):B=(u-O)/2,u=O)):C&&0===t&&(I=Math.floor((g-this.original_width)/
2),B=Math.floor((u-this.original_height)/2),g=this.original_width,u=this.original_height),2>t&&(this.aspect_scale=D),this.cssWidth=Math.round(g),this.cssHeight=Math.round(u),this.width=Math.round(g*D),this.height=Math.round(u*D),this.redraw=!0,this.wantFullscreenScalingQuality?(this.draw_width=this.width,this.draw_height=this.height,this.fullscreenScalingQuality=!0):this.width<this.original_width&&this.height<this.original_height||1===t?(this.draw_width=this.width,this.draw_height=this.height,this.fullscreenScalingQuality=
!0):(this.draw_width=this.original_width,this.draw_height=this.original_height,this.fullscreenScalingQuality=!1,2===t?(C=this.original_width/this.original_height,t=this.lastWindowWidth/this.lastWindowHeight,t<C?this.draw_width=this.draw_height*t:t>C&&(this.draw_height=this.draw_width/t)):3===t&&(C=this.original_width/this.original_height,t=this.lastWindowWidth/this.lastWindowHeight,t>C?this.draw_width=this.draw_height*t:t<C&&(this.draw_height=this.draw_width/t))),this.canvas&&(this.canvas.width=Math.round(g*
D),this.canvas.height=Math.round(u*D),this.isRetina&&(this.canvas.style.width=Math.round(g)+"px",this.canvas.style.height=Math.round(u)+"px"),this.canvas.style.marginLeft=Math.floor(I)+"px",this.canvas.style.marginTop=Math.floor(B)+"px"),this.overlay_canvas&&(this.overlay_canvas.width=Math.round(g*D),this.overlay_canvas.height=Math.round(u*D),this.overlay_canvas.style.width=this.cssWidth+"px",this.overlay_canvas.style.height=this.cssHeight+"px",this.overlay_canvas.style.left=Math.floor(I)+"px",this.overlay_canvas.style.top=
Math.floor(B)+"px"),this.glwrap&&this.glwrap.setSize(Math.round(g*D),Math.round(u*D)),this.ctx&&(this.ctx.imageSmoothingEnabled=this.linearSampling),this.tryLockOrientation(),this.isiPhone&&!this.isCordova&&window.scrollTo(0,0)}};b.prototype.tryLockOrientation=function(){if(this.autoLockOrientation&&0!==this.orientations){var g="portrait";2===this.orientations&&(g="landscape");try{screen.orientation&&screen.orientation.lock?screen.orientation.lock(g).catch(function(){}):screen.lockOrientation?screen.lockOrientation(g):
screen.webkitLockOrientation?screen.webkitLockOrientation(g):screen.mozLockOrientation?screen.mozLockOrientation(g):screen.msLockOrientation&&screen.msLockOrientation(g)}catch(u){console&&console.warn&&console.warn("Failed to lock orientation: ",u)}}};b.prototype.onContextLost=function(){this.glwrap.contextLost();this.is_WebGL_context_lost=!0;var g;var u=0;for(g=this.types_by_index.length;u<g;u++){var D=this.types_by_index[u];if(D.onLostWebGLContext)D.onLostWebGLContext()}};b.prototype.onContextRestored=
function(){this.is_WebGL_context_lost=!1;var g;var u=0;for(g=this.types_by_index.length;u<g;u++){var D=this.types_by_index[u];if(D.onRestoreWebGLContext)D.onRestoreWebGLContext()}};var K=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame;b.prototype.setSuspended=function(g){var u;if(g&&!this.isSuspended)for(cr.logexport("[Construct 2] Suspending"),this.isSuspended=!0,-1!==this.raf_id&&K(this.raf_id),
-1!==this.timeout_id&&clearTimeout(this.timeout_id),g=0,u=this.suspend_events.length;g<u;g++)this.suspend_events[g](!0);else if(!g&&this.isSuspended){cr.logexport("[Construct 2] Resuming");this.isSuspended=!1;this.last_tick_time=cr.performance_now();this.last_fps_time=cr.performance_now();g=this.logictime=this.framecount=0;for(u=this.suspend_events.length;g<u;g++)this.suspend_events[g](!1);this.tick(!1)}};b.prototype.addSuspendCallback=function(g){this.suspend_events.push(g)};b.prototype.GetObjectReference=
function(g){return this.objectRefTable[g]};b.prototype.loadProject=function(g){g&&g.project||cr.logerror("Project model unavailable");g=g.project;this.name=g[0];this.first_layout=g[1];this.fullscreen_mode=g[12];this.fullscreen_mode_set=g[12];this.original_width=g[10];this.original_height=g[11];this.parallax_x_origin=this.original_width/2;this.parallax_y_origin=this.original_height/2;this.uses_loader_layout=g[18];this.loaderstyle=g[19];this.iconsFolder=g[28];this.webFontNames=g[29].map(function(ia){return ia[0]});
if(0===this.loaderstyle){var u=new Image;u.crossOrigin="anonymous";var D=this.loaderlogos={logo:u};u.addEventListener("error",function(){D.logo=null});var I=g[39];I=this.isPreview?this.getProjectFileUrl(I):this.iconsFolder+I;this.setImageSrc(u,I)}else if(4===this.loaderstyle){u=new Image;u.src="splash-images/splash-logo.svg";I=new Image;I.src="splash-images/splash-poweredby-512.png";var B=new Image;B.src="splash-images/splash-poweredby-256.png";var t=new Image;t.src="splash-images/splash-poweredby-128.png";
var C=new Image;C.src="splash-images/splash-website-512.png";var F=new Image;F.src="splash-images/splash-website-256.png";var O=new Image;O.src="splash-images/splash-website-128.png";this.loaderlogos={logo:u,powered:[I,B,t],website:[C,F,O]}}this.next_uid=g[21];this.objectRefTable=cr.getObjectRefTable();this.system=new cr.system_object(this);u=0;for(I=g[2].length;u<I;u++){O=g[2][u];B=this.GetObjectReference(O[0]);cr.add_common_aces(O,B.prototype);var W=new B(this);W.singleglobal=O[1];W.is_world=O[2];
W.is_rotatable=O[5];W.must_predraw=O[9];if(W.onCreate)W.onCreate();cr.seal(W);this.plugins.push(W)}this.objectRefTable=cr.getObjectRefTable();u=0;for(I=g[3].length;u<I;u++){O=g[3][u];C=this.GetObjectReference(O[1]);W=null;B=0;for(t=this.plugins.length;B<t;B++)if(this.plugins[B]instanceof C){W=this.plugins[B];break}var T=new W.Type(W);T.name=O[0];T.is_family=O[2];T.instvar_sids=O[3].slice(0);T.vars_count=O[3].length;T.behs_count=O[4];T.fx_count=O[5];T.sid=O[11];T.is_family?(T.members=[],T.family_index=
this.family_count++,T.families=null):(T.members=null,T.family_index=-1,T.families=[]);T.family_var_map=null;T.family_beh_map=null;T.family_fx_map=null;T.is_contained=!1;T.container=null;O[6]?(T.texture_file=O[6][0],T.texture_filesize=O[6][1],T.texture_pixelformat=O[6][2],T.texture_data=O[6]):(T.texture_file=null,T.texture_filesize=0,T.texture_pixelformat=0,T.texture_data=null);T.animations=O[7]?O[7]:null;T.index=u;T.instances=[];T.deadCache=[];T.solstack=[new cr.selection(T)];T.cur_sol=0;T.default_instance=
null;T.default_layerindex=0;T.stale_iids=!0;T.updateIIDs=cr.type_updateIIDs;T.getFirstPicked=cr.type_getFirstPicked;T.getPairedInstance=cr.type_getPairedInstance;T.getCurrentSol=cr.type_getCurrentSol;T.pushCleanSol=cr.type_pushCleanSol;T.pushCopySol=cr.type_pushCopySol;T.popSol=cr.type_popSol;T.getBehaviorByName=cr.type_getBehaviorByName;T.getBehaviorIndexByName=cr.type_getBehaviorIndexByName;T.getEffectIndexByName=cr.type_getEffectIndexByName;T.applySolToContainer=cr.type_applySolToContainer;T.getInstanceByIID=
cr.type_getInstanceByIID;T.collision_grid=new cr.SparseGrid(this.original_width,this.original_height);T.any_cell_changed=!0;T.any_instance_parallaxed=!1;T.extra={};T.toString=cr.type_toString;T.behaviors=[];B=0;for(t=O[8].length;B<t;B++){var U=O[8][B];var Y=this.GetObjectReference(U[1]),da=null;C=0;for(F=this.behaviors.length;C<F;C++)if(this.behaviors[C]instanceof Y){da=this.behaviors[C];break}if(!da){da=new Y(this);da.my_types=[];da.my_instances=new cr.ObjectSet;if(da.onCreate)da.onCreate();cr.seal(da);
this.behaviors.push(da);cr.behaviors.solid&&da instanceof cr.behaviors.solid&&(this.solidBehavior=da);cr.behaviors.jumpthru&&da instanceof cr.behaviors.jumpthru&&(this.jumpthruBehavior=da);cr.behaviors.shadowcaster&&da instanceof cr.behaviors.shadowcaster&&(this.shadowcasterBehavior=da)}-1===da.my_types.indexOf(T)&&da.my_types.push(T);C=new da.Type(da,T);C.name=U[0];C.sid=U[2];C.onCreate();cr.seal(C);T.behaviors.push(C)}T.global=O[9];T.isOnLoaderLayout=O[10];T.effect_types=[];B=0;for(t=O[12].length;B<
t;B++)T.effect_types.push({id:O[12][B][0],name:O[12][B][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:B});B=O[13];T.tile_poly_data=B?B[0]:null;if(!this.uses_loader_layout||T.is_family||T.isOnLoaderLayout||!W.is_world)T.onCreate(),cr.seal(T);T.name&&(this.types[T.name]=T,this.types_lowercase[T.name.toLowerCase()]=T);this.types_by_index.push(T);W.singleglobal&&(B=new W.Instance(T),B.uid=this.next_uid++,B.puid=this.next_puid++,B.iid=0,B.get_iid=cr.inst_get_iid,B.toString=cr.inst_toString,
B.properties=O[16],B.onCreate(),cr.seal(B),T.instances.push(B),this.objectsByUid[B.uid.toString()]=B)}u=0;for(I=g[4].length;u<I;u++)for(C=g[4][u],F=this.types_by_index[C[0]],B=1,t=C.length;B<t;B++)O=this.types_by_index[C[B]],O.families.push(F),F.members.push(O);u=0;for(I=g[27].length;u<I;u++){C=g[27][u];F=[];B=0;for(t=C.length;B<t;B++)F.push(this.types_by_index[C[B]]);B=0;for(t=F.length;B<t;B++)F[B].is_contained=!0,F[B].container=F}if(0<this.family_count)for(u=0,I=this.types_by_index.length;u<I;u++)if(O=
this.types_by_index[u],!O.is_family&&O.families.length){O.family_var_map=Array(this.family_count);O.family_beh_map=Array(this.family_count);O.family_fx_map=Array(this.family_count);T=[];B=da=Y=U=0;for(t=O.families.length;B<t;B++)for(W=O.families[B],O.family_var_map[W.family_index]=U,U+=W.vars_count,O.family_beh_map[W.family_index]=Y,Y+=W.behs_count,O.family_fx_map[W.family_index]=da,da+=W.fx_count,C=0,F=W.effect_types.length;C<F;C++)T.push(cr.shallowCopy({},W.effect_types[C]));O.effect_types=T.concat(O.effect_types);
B=0;for(t=O.effect_types.length;B<t;B++)O.effect_types[B].index=B}u=0;for(I=g[5].length;u<I;u++)O=g[5][u],B=new cr.layout(this,O),cr.seal(B),this.layouts[B.name]=B,this.layouts_by_index.push(B);u=0;for(I=g[6].length;u<I;u++)O=g[6][u],B=new cr.eventsheet(this,O),cr.seal(B),this.eventsheets[B.name]=B,this.eventsheets_by_index.push(B);u=0;for(I=this.eventsheets_by_index.length;u<I;u++)this.eventsheets_by_index[u].postInit();u=0;for(I=this.eventsheets_by_index.length;u<I;u++)this.eventsheets_by_index[u].updateDeepIncludes();
u=0;for(I=this.triggers_to_postinit.length;u<I;u++)this.triggers_to_postinit[u].postInit();cr.clearArray(this.triggers_to_postinit);this.audio_files_info=g[7];this.audio_files_map={};u=0;for(I=this.audio_files_info.length;u<I;++u)B=this.audio_files_info[u],this.audio_files_map[B[0]]=B[1];this.files_subfolder=g[8];this.pixel_rounding=g[9];this.aspect_scale=1;this.enableWebGL=g[13];this.linearSampling=g[14];this.clearBackground=g[15];this.versionstr=g[16];this.useHighDpi=g[17];this.orientations=g[20];
this.autoLockOrientation=0<this.orientations;this.pauseOnBlur=g[22];this.fullscreenScalingQuality=this.wantFullscreenScalingQuality=g[23];this.downscalingQuality=g[24];this.preloadSounds=g[25];this.enableFrontToBack=g[26]&&!this.isIE;this.enhancedAccelerationPrecision=g[30];this.start_time=Date.now();cr.clearArray(this.objectRefTable);this.preloadSounds||w["audio/webm; codecs=opus"]||!window.OpusDecoder||window.OpusDecoder.Initialise();this.initRendererAndLoader()};var A=!1;b.prototype.waitForImageLoad=
function(g,u){window.cr_remotePreviewImageFiles&&u&&"blob:"!==u.substr(0,5)&&(u=window.cr_remotePreviewImageFiles[u]);g.onerror=function(D){A=g.c2error=!0;console&&console.error&&console.error("Error loading image '"+g.src+"': ",D)};g.src||("undefined"!==typeof XAPKReader?XAPKReader.get(u,function(D){g.src=D},function(D){A=g.c2error=!0;console&&console.error&&console.error("Error extracting image '"+u+"' from expansion file: ",D)}):(g.crossOrigin="anonymous",this.setImageSrc(g,u)));this.wait_for_textures.push(g)};
b.prototype.findWaitingTexture=function(g){var u;var D=0;for(u=this.wait_for_textures.length;D<u;D++)if(this.wait_for_textures[D].cr_src===g)return this.wait_for_textures[D];return null};var J=0,R=!1;b.prototype.getready=function(){if(this.audioInstance&&this.preloadSounds){var g=[],u;var D=0;for(u=this.audio_files_info.length;D<u;++D){var I=this.audio_files_info[D];var B=I[0];var t=I[2];(I=this.getPreferredAudioFile(B))&&!t&&g.push({filename:B+I[1],size:I[2],type:I[0]})}J=this.audioInstance.setPreloadList(g)}};
b.prototype.areAllTexturesAndSoundsLoaded=function(){var g=J,u=0,D=!0,I;var B=0;for(I=this.wait_for_textures.length;B<I;B++){var t=this.wait_for_textures[B];var C=t.cr_filesize;if(!C||0>=C)C=5E4;g+=C;t.src&&t.complete&&!t.c2error?u+=C:D=!1}D&&this.preloadSounds&&this.audioInstance&&(R||(this.audioInstance.startPreloads(),R=!0),B=this.audioInstance.getPreloadedSize(),u+=B,B<J&&(D=!1));this.progress=0==g?1:u/g;return D};var n=!1;b.prototype.go=function(){if(this.ctx||this.glwrap){var g=this.ctx||this.overlay_ctx;
if(0<this.fullscreen_mode){var u=window.innerWidth,D=window.innerHeight;this.lastWindowWidth===u&&this.lastWindowHeight===D||this.setSize(u,D)}this.progress=0;this.last_progress=-1;var I=this;if(this.areAllTexturesAndSoundsLoaded()&&(4!==this.loaderstyle||n))this.useFbInstant?FBInstant.startGameAsync().then(function(){I.go_loading_finished()}):this.go_loading_finished();else{this.useFbInstant&&FBInstant.setLoadingProgress(100*this.progress);D=Date.now()-this.start_time;if(g){var B=this.width,t=this.height;
u=this.devicePixelRatio;if(3>this.loaderstyle&&500<=D&&this.last_progress!=this.progress){g.clearRect(0,0,B,t);D=B/2;t/=2;B=0===this.loaderstyle&&this.loaderlogos.logo&&this.loaderlogos.logo.complete;var C=40*u,F=0,O=80*u;if(B){var W=this.loaderlogos.logo;O=W.width*u;var T=W.height*u;C=O/2;F=T/2;g.drawImage(W,cr.floor(D-C),cr.floor(t-F),O,T)}1>=this.loaderstyle?(t+=F+(B?12*u:0),D=cr.floor(D-C)+.5,t=cr.floor(t)+.5,g.fillStyle=A?"red":"DodgerBlue",g.fillRect(D,t,Math.floor(O*this.progress),6*u),g.strokeStyle=
"black",g.strokeRect(D,t,O,6*u),g.strokeStyle="white",g.strokeRect(D-1*u,t-1*u,O+2*u,8*u)):2===this.loaderstyle&&(g.font="12pt Arial",g.fillStyle=A?"#f00":"#999",g.textBaseLine="middle",u=Math.round(100*this.progress)+"%",B=g.measureText?g.measureText(u):null,g.fillText(u,D-(B?B.width:0)/2,t));this.last_progress=this.progress}else if(4===this.loaderstyle){this.draw_c3_splash_loader(g);q?q(function(){I.go()}):setTimeout(function(){I.go()},16);return}}setTimeout(function(){I.go()},100)}}};var x=-1,
E=!0,V=!1,Z=0,M=0,d=null,m=null,G=0;b.prototype.draw_c3_splash_loader=function(g){if(!n){var u=this.isPreview||this.useFbInstant,D=u?0:200,I=u?0:3E3,B=Math.ceil(this.width),t=Math.ceil(this.height),C=this.loaderlogos.logo,F=this.loaderlogos.powered,O=this.loaderlogos.website;if(C.complete){for(var W=0;3>W;++W)if(!F[W].complete||!O[W].complete)return;0===G&&(x=Date.now());W=Date.now();var T=!1,U=g;E||V?(g.clearRect(0,0,B,t),d&&d.width===B&&d.height===t||(d=document.createElement("canvas"),d.width=
B,d.height=t,m=d.getContext("2d")),U=m,T=!0,E&&1===G&&(x=Date.now())):g.globalAlpha=1;U.fillStyle="#3B4045";U.fillRect(0,0,B,t);try{if(256<this.cssHeight){var Y=1.5*cr.clamp(.22*t,105,.6*B);var da=Y/8;U.drawImage(128>=Y?F[2]:256>=Y?F[1]:F[0],.5*B-Y/2,.2*t-da/2,Y,da);da=Y=Math.min(.395*t,.95*B);U.drawImage(C,.5*B-Y/2,.485*t-da/2,Y,da);Y=1.5*cr.clamp(.22*t,105,.6*B);da=Y/8;U.drawImage(128>=Y?O[2]:256>=Y?O[1]:O[0],.5*B-Y/2,.868*t-da/2,Y,da);U.fillStyle="#4D565D";Y=B;da=Math.max(.005*t,2);U.fillRect(0,
.8*t-da/2,Y,da);U.fillStyle=A?"red":"#29F3D0";Y=B*this.progress;U.fillRect(.5*B-Y/2,.8*t-da/2,Y,da)}else da=Y=.55*t,U.drawImage(C,.5*B-Y/2,.45*t-da/2,Y,da),U.fillStyle="#4D565D",Y=B,da=Math.max(.005*t,2),U.fillRect(0,.85*t-da/2,Y,da),U.fillStyle=A?"red":"#29F3D0",Y=B*this.progress,U.fillRect(.5*B-Y/2,.85*t-da/2,Y,da);T&&(E?g.globalAlpha=0===G?0:Math.min((W-x)/300,1):V&&(g.globalAlpha=Math.max(1-(W-M)/300,0)),g.drawImage(d,0,0,B,t))}catch(ia){}E&&300<=W-x&&2<=G&&(E=!1,Z=W);!E&&W-Z>=I&&!V&&1<=this.progress&&
(V=!0,M=W);if(V&&W-M>=300+D||u&&1<=this.progress&&500>Date.now()-x)n=!0,V=E=!1,this.loaderlogos=m=d=null;++G}}};b.prototype.go_loading_finished=function(){if(this.webFontNames.length&&document.fonts&&document.fonts.load){var g=this;Promise.all(this.webFontNames.map(function(u){return document.fonts.load("1em '"+u+"'")})).then(function(){g.start_first_layout()})}else this.start_first_layout()};b.prototype.start_first_layout=function(){this.overlay_canvas&&(this.canvas.parentNode.removeChild(this.overlay_canvas),
this.overlay_canvas=this.overlay_ctx=null);this.start_time=Date.now();this.last_fps_time=cr.performance_now();var g;if(this.uses_loader_layout){var u=0;for(g=this.types_by_index.length;u<g;u++){var D=this.types_by_index[u];D.is_family||D.isOnLoaderLayout||!D.plugin.is_world||(D.onCreate(),cr.seal(D))}}else this.isloading=!1;u=0;for(g=this.layouts_by_index.length;u<g;u++)this.layouts_by_index[u].createGlobalNonWorlds();2<=this.fullscreen_mode&&(u=this.original_width/this.original_height,g=this.width/
this.height,this.aspect_scale=2!==this.fullscreen_mode&&g>u||2===this.fullscreen_mode&&g<u?this.height/this.original_height:this.width/this.original_width);u=0;for(g=this.types_by_index.length;u<g;u++)if(D=this.types_by_index[u],D.onBeforeAppBegin)D.onBeforeAppBegin();this.first_layout?this.layouts[this.first_layout].startRunning():this.layouts_by_index[0].startRunning();this.uses_loader_layout||(this.loadingprogress=1,this.trigger(cr.system_object.prototype.cnds.OnLoadFinished,null),window.C3_RegisterSW&&
window.C3_RegisterSW());navigator.splashscreen&&navigator.splashscreen.hide&&navigator.splashscreen.hide();u=0;for(g=this.types_by_index.length;u<g;u++)if(D=this.types_by_index[u],D.onAppBegin)D.onAppBegin();u=function(){document.hidden||document.webkitHidden||document.mozHidden||document.msHidden?window.cr_setSuspended(!0):window.cr_setSuspended(!1)};document.addEventListener("visibilitychange",u,!1);document.addEventListener("mozvisibilitychange",u,!1);document.addEventListener("webkitvisibilitychange",
u,!1);document.addEventListener("msvisibilitychange",u,!1);this.isCordova&&(document.addEventListener("pause",function(){window.cr_setSuspended(!0)}),document.addEventListener("resume",function(){window.cr_setSuspended(!1)}));document.hidden||document.webkitHidden||document.mozHidden||document.msHidden?window.cr_setSuspended(!0):this.tick(!1)};b.prototype.tick=function(g,u,D){if(this.running_layout){var I=cr.performance_now();if(D||!this.isSuspended||g){g||(q?this.raf_id=q(this.tickFunc):this.timeout_id=
setTimeout(this.tickFunc,this.isMobile?1:16));u=u||I;var B=this.fullscreen_mode;(D=(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||!!document.msFullscreenElement)&&!this.isCordova)&&0<this.fullscreen_scaling&&(B=this.fullscreen_scaling);if(0<B){B=window.innerWidth;var t=window.innerHeight;this.lastWindowWidth===B&&this.lastWindowHeight===t||this.setSize(B,t)}D?this.firstInFullscreen||(this.firstInFullscreen=!0):this.firstInFullscreen?(this.firstInFullscreen=!1,0===this.fullscreen_mode&&
this.setSize(Math.round(this.oldWidth/this.devicePixelRatio),Math.round(this.oldHeight/this.devicePixelRatio),!0)):(this.oldWidth=this.width,this.oldHeight=this.height);this.isloading&&(D=this.areAllTexturesAndSoundsLoaded(),this.loadingprogress=this.progress,D&&(this.isloading=!1,this.progress=1,this.trigger(cr.system_object.prototype.cnds.OnLoadFinished,null),window.C3_RegisterSW&&window.C3_RegisterSW()));this.logic(u);!this.redraw||this.is_WebGL_context_lost||this.suspendDrawing||g||(this.redraw=
!1,this.glwrap?this.drawGL():this.draw(),this.snapshotCanvas&&(this.canvas&&this.canvas.toDataURL&&(this.snapshotData=this.canvas.toDataURL(this.snapshotCanvas[0],this.snapshotCanvas[1]),window.cr_onSnapshot&&window.cr_onSnapshot(this.snapshotData),this.trigger(cr.system_object.prototype.cnds.OnCanvasSnapshot,null)),this.snapshotCanvas=null));this.hit_breakpoint||(this.tickcount++,this.tickcount_nosave++,this.execcount++,this.framecount++);this.logictime+=cr.performance_now()-I}}};b.prototype.logic=
function(g){var u;1E3<=g-this.last_fps_time&&(this.last_fps_time+=1E3,1E3<=g-this.last_fps_time&&(this.last_fps_time=g),this.fps=this.framecount,this.framecount=0,this.cpuutilisation=Math.min(this.logictime,1E3),this.logictime=0,this.glwrap&&0===this.gpuTimeEndFrame&&(this.gpuTimeEndFrame=this.glwrap.getFrameNumber(),this.gpuCurUtilisation=-1));this.glwrap&&-1===this.gpuCurUtilisation&&this.glwrap.supportsGpuProfiling()&&(this.gpuCurUtilisation=this.glwrap.getFrameRangeTimerResults(this.gpuTimeStartFrame,
this.gpuTimeEndFrame),-1!==this.gpuCurUtilisation&&(this.glwrap.deleteTimerResultsToFrame(this.gpuTimeEndFrame),this.gpuLastUtilisation=Math.min(this.gpuCurUtilisation,1),this.gpuTimeStartFrame=this.gpuTimeEndFrame,this.gpuTimeEndFrame=0));if(0!==this.last_tick_time){var D=g-this.last_tick_time;0>D&&(D=0);this.dt1=D/1E3;.5<this.dt1?this.dt1=0:this.dt1>1/this.minimumFramerate&&(this.dt1=1/this.minimumFramerate)}this.last_tick_time=g;this.dt=this.dt1*this.timescale;this.kahanTime.add(this.dt);this.wallTime.add(this.dt1);
g=(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||!!document.msFullscreenElement)&&!this.isCordova;if(2<=this.fullscreen_mode||g&&0<this.fullscreen_scaling){D=this.original_width/this.original_height;var I=this.width/this.height;var B=this.fullscreen_mode;g&&0<this.fullscreen_scaling&&(B=this.fullscreen_scaling);this.aspect_scale=2!==B&&I>D||2===B&&I<D?this.height/this.original_height:this.width/this.original_width;this.running_layout&&(this.running_layout.scrollToX(this.running_layout.scrollX),
this.running_layout.scrollToY(this.running_layout.scrollY))}else this.aspect_scale=this.isRetina?this.devicePixelRatio:1;this.ClearDeathRow();this.isInOnDestroy++;this.system.runWaits();this.isInOnDestroy--;this.ClearDeathRow();this.isInOnDestroy++;I=this.objects_to_pretick.valuesRef();g=0;for(D=I.length;g<D;g++)I[g].pretick();g=0;for(D=this.types_by_index.length;g<D;g++){var t=this.types_by_index[g];if(!t.is_family&&(t.behaviors.length||t.families.length))for(I=0,B=t.instances.length;I<B;I++){var C=
t.instances[I];var F=0;for(u=C.behavior_insts.length;F<u;F++)C.behavior_insts[F].tick()}}g=0;for(D=this.types_by_index.length;g<D;g++)if(t=this.types_by_index[g],!t.is_family&&(t.behaviors.length||t.families.length))for(I=0,B=t.instances.length;I<B;I++)for(C=t.instances[I],F=0,u=C.behavior_insts.length;F<u;F++){var O=C.behavior_insts[F];O.posttick&&O.posttick()}I=this.objects_to_tick.valuesRef();g=0;for(D=I.length;g<D;g++)I[g].tick();this.isInOnDestroy--;this.handleSaveLoad();for(g=0;this.changelayout&&
10>g++;)this.doChangeLayout(this.changelayout);g=0;for(D=this.eventsheets_by_index.length;g<D;g++)this.eventsheets_by_index[g].hasRun=!1;this.running_layout.event_sheet&&this.running_layout.event_sheet.run();cr.clearArray(this.registered_collisions);this.layout_first_tick=!1;this.isInOnDestroy++;g=0;for(D=this.types_by_index.length;g<D;g++)if(t=this.types_by_index[g],!t.is_family&&(t.behaviors.length||t.families.length))for(I=0,B=t.instances.length;I<B;I++)for(C=t.instances[I],F=0,u=C.behavior_insts.length;F<
u;F++)O=C.behavior_insts[F],O.tick2&&O.tick2();I=this.objects_to_tick2.valuesRef();g=0;for(D=I.length;g<D;g++)I[g].tick2();this.isInOnDestroy--};b.prototype.onWindowBlur=function(){var g,u,D;var I=0;for(g=this.types_by_index.length;I<g;I++){var B=this.types_by_index[I];if(!B.is_family){var t=0;for(u=B.instances.length;t<u;t++){var C=B.instances[t];if(C.onWindowBlur)C.onWindowBlur();if(C.behavior_insts){var F=0;for(D=C.behavior_insts.length;F<D;F++){var O=C.behavior_insts[F];if(O.onWindowBlur)O.onWindowBlur()}}}}}};
b.prototype.doChangeLayout=function(g){var u=this.running_layout;this.running_layout.stopRunning();var D;if(this.glwrap){var I=0;for(D=this.types_by_index.length;I<D;I++){var B=this.types_by_index[I];B.is_family||!B.unloadTextures||B.global&&0!==B.instances.length||-1!==g.initial_types.indexOf(B)||B.unloadTextures()}}u==g&&cr.clearArray(this.system.waits);cr.clearArray(this.registered_collisions);this.runLayoutChangeMethods(!0);g.startRunning();this.runLayoutChangeMethods(!1);this.layout_first_tick=
this.redraw=!0;this.ClearDeathRow()};b.prototype.runLayoutChangeMethods=function(g){var u,D,I;var B=0;for(u=this.behaviors.length;B<u;B++){var t=this.behaviors[B];if(g){if(t.onBeforeLayoutChange)t.onBeforeLayoutChange()}else if(t.onLayoutChange)t.onLayoutChange()}B=0;for(u=this.types_by_index.length;B<u;B++)if(t=this.types_by_index[B],t.global||t.plugin.singleglobal){var C=0;for(D=t.instances.length;C<D;C++){var F=t.instances[C];if(g){if(F.onBeforeLayoutChange)F.onBeforeLayoutChange()}else if(F.onLayoutChange)F.onLayoutChange();
if(F.behavior_insts){var O=0;for(I=F.behavior_insts.length;O<I;O++){var W=F.behavior_insts[O];if(g){if(W.onBeforeLayoutChange)W.onBeforeLayoutChange()}else if(W.onLayoutChange)W.onLayoutChange()}}}}};b.prototype.pretickMe=function(g){this.objects_to_pretick.add(g)};b.prototype.unpretickMe=function(g){this.objects_to_pretick.remove(g)};b.prototype.tickMe=function(g){this.objects_to_tick.add(g)};b.prototype.untickMe=function(g){this.objects_to_tick.remove(g)};b.prototype.tick2Me=function(g){this.objects_to_tick2.add(g)};
b.prototype.untick2Me=function(g){this.objects_to_tick2.remove(g)};b.prototype.getDt=function(g){return g&&-1!==g.my_timescale?this.dt1*g.my_timescale:this.dt};b.prototype.draw=function(){this.running_layout.draw(this.ctx)};b.prototype.drawGL=function(){this.enableFrontToBack&&(this.earlyz_index=1,this.running_layout.drawGL_earlyZPass(this.glwrap));this.running_layout.drawGL(this.glwrap);this.glwrap.present()};b.prototype.addDestroyCallback=function(g){g&&this.destroycallbacks.push(g)};b.prototype.removeDestroyCallback=
function(g){cr.arrayFindRemove(this.destroycallbacks,g)};b.prototype.getObjectByUID=function(g){g=g.toString();return this.objectsByUid.hasOwnProperty(g)?this.objectsByUid[g]:null};var f=[];b.prototype.DestroyInstance=function(g){var u;var D=g.type.name;if(this.deathRow.hasOwnProperty(D)){var I=this.deathRow[D];if(I.contains(g))return}else I=f.length?f.pop():new cr.ObjectSet,this.deathRow[D]=I;g.isDestroyed=!0;I.add(g);this.hasPendingInstances=!0;if(g.is_contained)for(D=0,u=g.siblings.length;D<u;D++)this.DestroyInstance(g.siblings[D]);
this.isInClearDeathRow&&I.values_cache.push(g);this.isEndingLayout||(this.isInOnDestroy++,this.trigger(Object.getPrototypeOf(g.type.plugin).cnds.OnDestroyed,g),this.isInOnDestroy--)};b.prototype.ClearDeathRow=function(){if(this.hasPendingInstances){var g,u;this.isInClearDeathRow=!0;var D=0;for(g=this.createRow.length;D<g;++D){var I=this.createRow[D];var B=I.type;B.instances.push(I);var t=0;for(u=B.families.length;t<u;++t)B.families[t].instances.push(I),B.families[t].stale_iids=!0}cr.clearArray(this.createRow);
this.IterateDeathRow();cr.wipe(this.deathRow);this.hasPendingInstances=this.isInClearDeathRow=!1}};b.prototype.IterateDeathRow=function(){for(var g in this.deathRow)this.deathRow.hasOwnProperty(g)&&this.ClearDeathRowForType(this.deathRow[g])};b.prototype.ClearDeathRowForType=function(g){var u=g.valuesRef(),D=u[0].type,I,B;cr.arrayRemoveAllFromObjectSet(D.instances,g);D.stale_iids=!0;0===D.instances.length&&(D.any_instance_parallaxed=!1);var t=0;for(I=D.families.length;t<I;++t){var C=D.families[t];
cr.arrayRemoveAllFromObjectSet(C.instances,g);C.stale_iids=!0}t=0;for(I=this.system.waits.length;t<I;++t){var F=this.system.waits[t];F.sols.hasOwnProperty(D.index)&&cr.arrayRemoveAllFromObjectSet(F.sols[D.index].insts,g);if(!D.is_family){var O=0;for(B=D.families.length;O<B;++O)C=D.families[O],F.sols.hasOwnProperty(C.index)&&cr.arrayRemoveAllFromObjectSet(F.sols[C.index].insts,g)}}if(F=u[0].layer){if(F.useRenderCells)for(O=F.instances,t=0,I=O.length;t<I;++t)B=O[t],g.contains(B)&&(B.update_bbox(),F.render_grid.update(B,
B.rendercells,null),B.rendercells.set(0,0,-1,-1));cr.arrayRemoveAllFromObjectSet(F.instances,g);F.setZIndicesStaleFrom(0)}for(t=0;t<u.length;++t)this.ClearDeathRowForSingleInstance(u[t],D);g.clear();f.push(g);this.redraw=!0};b.prototype.ClearDeathRowForSingleInstance=function(g,u){var D;var I=0;for(D=this.destroycallbacks.length;I<D;++I)this.destroycallbacks[I](g);g.collcells&&u.collision_grid.update(g,g.collcells,null);(I=g.layer)&&I.removeFromInstanceList(g,!0);if(g.behavior_insts)for(I=0,D=g.behavior_insts.length;I<
D;++I){var B=g.behavior_insts[I];if(B.onDestroy)B.onDestroy();B.behavior.my_instances.remove(g)}this.objects_to_pretick.remove(g);this.objects_to_tick.remove(g);this.objects_to_tick2.remove(g);if(g.onDestroy)g.onDestroy();this.objectsByUid.hasOwnProperty(g.uid.toString())&&delete this.objectsByUid[g.uid.toString()];this.objectcount--;100>u.deadCache.length&&u.deadCache.push(g)};b.prototype.createInstance=function(g,u,D,I){if(g.is_family){var B=cr.floor(Math.random()*g.members.length);return this.createInstance(g.members[B],
u,D,I)}return g.default_instance?this.createInstanceFromInit(g.default_instance,u,!1,D,I,!1):null};var y=[];b.prototype.createInstanceFromInit=function(g,u,D,I,B,t){var C,F;if(!g)return null;var O=this.types_by_index[g[1]],W=O.plugin.is_world;if(this.isloading&&W&&!O.isOnLoaderLayout||W&&!this.glwrap&&11===g[0][11])return null;var T=u;W||(u=null);if(O.deadCache.length){var U=O.deadCache.pop();U.recycled=!0;O.plugin.Instance.call(U,O)}else U=new O.plugin.Instance(O),U.recycled=!1;!D||t||this.objectsByUid.hasOwnProperty(g[2].toString())?
U.uid=this.next_uid++:U.uid=g[2];this.objectsByUid[U.uid.toString()]=U;U.puid=this.next_puid++;U.iid=O.instances.length;var Y=0;for(C=this.createRow.length;Y<C;++Y)this.createRow[Y].type===O&&U.iid++;U.get_iid=cr.inst_get_iid;U.toString=cr.inst_toString;U.isDestroyed=!1;var da=g[3];if(U.recycled)cr.wipe(U.extra);else{U.extra={};if(this.isPreview)for(U.instance_var_names=[],U.instance_var_names.length=da.length,Y=0,C=da.length;Y<C;Y++)U.instance_var_names[Y]=da[Y][1];U.instance_vars=[];U.instance_vars.length=
da.length}Y=0;for(C=da.length;Y<C;Y++)U.instance_vars[Y]=da[Y][0];if(W){var ia=g[0];U.x=cr.is_undefined(I)?ia[0]:I;U.y=cr.is_undefined(B)?ia[1]:B;U.z=ia[2];U.width=ia[3];U.height=ia[4];U.depth=ia[5];U.angle=ia[6];U.opacity=ia[7];U.hotspotX=ia[8];U.hotspotY=ia[9];U.blend_mode=ia[10];Y=ia[11];!this.glwrap&&O.effect_types.length&&(U.blend_mode=Y);U.compositeOp=cr.effectToCompositeOp(U.blend_mode);this.gl&&cr.setGLBlend(U,U.blend_mode,this.gl);if(U.recycled){Y=0;for(C=ia[12].length;Y<C;Y++)for(da=0,F=
ia[12][Y].length;da<F;da++)U.effect_params[Y][da]=ia[12][Y][da],Array.isArray(U.effect_params[Y][da])&&(U.effect_params[Y][da]=U.effect_params[Y][da].slice(0));U.bbox.set(0,0,0,0);U.collcells.set(0,0,-1,-1);U.rendercells.set(0,0,-1,-1);U.bquad.set_from_rect(U.bbox);cr.clearArray(U.bbox_changed_callbacks)}else{U.effect_params=ia[12].slice(0);Y=0;for(C=U.effect_params.length;Y<C;Y++)for(U.effect_params[Y]=ia[12][Y].slice(0),da=0,F=U.effect_params[Y].length;da<F;++da)Array.isArray(U.effect_params[Y][da])&&
(U.effect_params[Y][da]=U.effect_params[Y][da].slice(0));U.active_effect_types=[];U.active_effect_flags=[];U.active_effect_flags.length=O.effect_types.length;U.bbox=new cr.rect(0,0,0,0);U.collcells=new cr.rect(0,0,-1,-1);U.rendercells=new cr.rect(0,0,-1,-1);U.bquad=new cr.quad;U.bbox_changed_callbacks=[];U.set_bbox_changed=cr.set_bbox_changed;U.add_bbox_changed_callback=cr.add_bbox_changed_callback;U.contains_pt=cr.inst_contains_pt;U.update_bbox=cr.update_bbox;U.update_render_cell=cr.update_render_cell;
U.update_collision_cell=cr.update_collision_cell;U.get_zindex=cr.inst_get_zindex}U.tilemap_exists=!1;U.tilemap_width=0;U.tilemap_height=0;U.tilemap_data=null;ia[13]&&(U.tilemap_exists=!0,U.tilemap_width=ia[13][0],U.tilemap_height=ia[13][1],U.tilemap_data=ia[13][2]);Y=0;for(C=O.effect_types.length;Y<C;Y++)U.active_effect_flags[Y]=!0;U.shaders_preserve_opaqueness=!0;U.updateActiveEffects=cr.inst_updateActiveEffects;U.updateActiveEffects();U.uses_shaders=!!U.active_effect_types.length;U.bbox_changed=
!0;U.cell_changed=!0;O.any_cell_changed=!0;U.visible=!0;U.my_timescale=-1;U.layer=u;U.zindex=u.instances.length;U.earlyz_index=0;"undefined"===typeof U.collision_poly&&(U.collision_poly=null);this.redraw=U.collisionsEnabled=!0}cr.clearArray(y);Y=0;for(C=O.families.length;Y<C;Y++)y.push.apply(y,O.families[Y].behaviors);y.push.apply(y,O.behaviors);if(U.recycled)for(Y=0,C=y.length;Y<C;Y++){var la=y[Y];var na=U.behavior_insts[Y];na.recycled=!0;la.behavior.Instance.call(na,la,U);ia=g[4][Y];da=0;for(F=
ia.length;da<F;da++)na.properties[da]=ia[da];na.onCreate();la.behavior.my_instances.add(U)}else for(U.behavior_insts=[],Y=0,C=y.length;Y<C;Y++)la=y[Y],na=new la.behavior.Instance(la,U),na.recycled=!1,na.properties=g[4][Y].slice(0),na.onCreate(),cr.seal(na),U.behavior_insts.push(na),la.behavior.my_instances.add(U);ia=g[5];if(U.recycled)for(Y=0,C=ia.length;Y<C;Y++)U.properties[Y]=ia[Y];else U.properties=ia.slice(0);this.createRow.push(U);this.hasPendingInstances=!0;u&&(u.appendToInstanceList(U,!0),
1!==u.parallaxX||1!==u.parallaxY)&&(O.any_instance_parallaxed=!0);this.objectcount++;if(O.is_contained){if(U.is_contained=!0,U.recycled?cr.clearArray(U.siblings):U.siblings=[],!D&&!t){Y=0;for(C=O.container.length;Y<C;Y++)if(O.container[Y]!==O){if(!O.container[Y].default_instance)return null;U.siblings.push(this.createInstanceFromInit(O.container[Y].default_instance,T,!1,W?U.x:I,W?U.y:B,!0))}Y=0;for(C=U.siblings.length;Y<C;Y++)for(U.siblings[Y].siblings.push(U),da=0;da<C;da++)Y!==da&&U.siblings[Y].siblings.push(U.siblings[da])}}else U.is_contained=
!1,U.siblings=null;U.onCreate();U.recycled||cr.seal(U);Y=0;for(C=U.behavior_insts.length;Y<C;Y++)U.behavior_insts[Y].postCreate&&U.behavior_insts[Y].postCreate();return U};b.prototype.getLayerByName=function(g){var u;var D=0;for(u=this.running_layout.layers.length;D<u;D++){var I=this.running_layout.layers[D];if(cr.equals_nocase(I.name,g))return I}return null};b.prototype.getLayerByNumber=function(g){g=cr.floor(g);0>g&&(g=0);g>=this.running_layout.layers.length&&(g=this.running_layout.layers.length-
1);return this.running_layout.layers[g]};b.prototype.getLayer=function(g){return cr.is_number(g)?this.getLayerByNumber(g):this.getLayerByName(g.toString())};b.prototype.clearSol=function(g){var u;var D=0;for(u=g.length;D<u;D++)g[D].getCurrentSol().select_all=!0};b.prototype.pushCleanSol=function(g){var u;var D=0;for(u=g.length;D<u;D++)g[D].pushCleanSol()};b.prototype.pushCopySol=function(g){var u;var D=0;for(u=g.length;D<u;D++)g[D].pushCopySol()};b.prototype.popSol=function(g){var u;var D=0;for(u=
g.length;D<u;D++)g[D].popSol()};b.prototype.updateAllCells=function(g){if(g.any_cell_changed){var u,D=g.instances;var I=0;for(u=D.length;I<u;++I)D[I].update_collision_cell();D=this.createRow;I=0;for(u=D.length;I<u;++I)D[I].type===g&&D[I].update_collision_cell();g.any_cell_changed=!1}};b.prototype.getCollisionCandidates=function(g,u,D,I){var B,t=g?1!==g.parallaxX||1!==g.parallaxY:!1;if(u.is_family)for(g=0,B=u.members.length;g<B;++g){var C=u.members[g];t||C.any_instance_parallaxed?cr.appendArray(I,
C.instances):(this.updateAllCells(C),C.collision_grid.queryRange(D,I))}else t||u.any_instance_parallaxed?cr.appendArray(I,u.instances):(this.updateAllCells(u),u.collision_grid.queryRange(D,I))};b.prototype.getTypesCollisionCandidates=function(g,u,D,I){var B;var t=0;for(B=u.length;t<B;++t)this.getCollisionCandidates(g,u[t],D,I)};b.prototype.getSolidCollisionCandidates=function(g,u,D){var I=this.getSolidBehavior();if(!I)return null;this.getTypesCollisionCandidates(g,I.my_types,u,D)};b.prototype.getJumpthruCollisionCandidates=
function(g,u,D){var I=this.getJumpthruBehavior();if(!I)return null;this.getTypesCollisionCandidates(g,I.my_types,u,D)};b.prototype.testAndSelectCanvasPointOverlap=function(g,u,D,I){var B=g.getCurrentSol(),t,C=this.getCurrentEventStack().current_event.orblock;if(B.select_all){I||(B.select_all=!1,cr.clearArray(B.instances));var F=0;for(t=g.instances.length;F<t;F++){var O=g.instances[F];O.update_bbox();var W=O.layer.canvasToLayer(u,D,!0);var T=O.layer.canvasToLayer(u,D,!1);if(O.contains_pt(W,T)){if(I)return!1;
B.instances.push(O)}else C&&B.else_instances.push(O)}}else{var U=0;var Y=C?B.else_instances:B.instances;F=0;for(t=Y.length;F<t;F++)if(O=Y[F],O.update_bbox(),W=O.layer.canvasToLayer(u,D,!0),T=O.layer.canvasToLayer(u,D,!1),O.contains_pt(W,T)){if(I)return!1;C?B.instances.push(O):(B.instances[U]=B.instances[F],U++)}I||(Y.length=U)}g.applySolToContainer();return I?!0:B.hasObjects()};b.prototype.testOverlap=function(g,u){if(!(g&&u&&g!==u&&g.collisionsEnabled&&u.collisionsEnabled))return!1;g.update_bbox();
u.update_bbox();var D=g.layer,I=u.layer,B;if(D===I||D.parallaxX===I.parallaxX&&I.parallaxY===I.parallaxY&&D.scale===I.scale&&D.angle===I.angle&&D.zoomRate===I.zoomRate){if(!g.bbox.intersects_rect(u.bbox)||!g.bquad.intersects_quad(u.bquad)||g.tilemap_exists&&u.tilemap_exists)return!1;if(g.tilemap_exists)return this.testTilemapOverlap(g,u);if(u.tilemap_exists)return this.testTilemapOverlap(u,g);var t=g.collision_poly&&!g.collision_poly.is_empty();var C=u.collision_poly&&!u.collision_poly.is_empty();
if(!t&&!C)return!0;t?(g.collision_poly.cache_poly(g.width,g.height,g.angle),t=g.collision_poly):(this.temp_poly.set_from_quad(g.bquad,g.x,g.y,g.width,g.height),t=this.temp_poly);if(C){u.collision_poly.cache_poly(u.width,u.height,u.angle);var F=u.collision_poly}else this.temp_poly.set_from_quad(u.bquad,u.x,u.y,u.width,u.height),F=this.temp_poly;return t.intersects_poly(F,u.x-g.x,u.y-g.y)}t=g.collision_poly&&!g.collision_poly.is_empty();C=u.collision_poly&&!u.collision_poly.is_empty();t?(g.collision_poly.cache_poly(g.width,
g.height,g.angle),this.temp_poly.set_from_poly(g.collision_poly)):this.temp_poly.set_from_quad(g.bquad,g.x,g.y,g.width,g.height);t=this.temp_poly;C?(u.collision_poly.cache_poly(u.width,u.height,u.angle),this.temp_poly2.set_from_poly(u.collision_poly)):this.temp_poly2.set_from_quad(u.bquad,u.x,u.y,u.width,u.height);F=this.temp_poly2;C=0;for(B=t.pts_count;C<B;C++){var O=2*C;var W=O+1;var T=t.pts_cache[O];var U=t.pts_cache[W];t.pts_cache[O]=D.layerToCanvas(T+g.x,U+g.y,!0);t.pts_cache[W]=D.layerToCanvas(T+
g.x,U+g.y,!1)}t.update_bbox();C=0;for(B=F.pts_count;C<B;C++)O=2*C,W=O+1,T=F.pts_cache[O],U=F.pts_cache[W],F.pts_cache[O]=I.layerToCanvas(T+u.x,U+u.y,!0),F.pts_cache[W]=I.layerToCanvas(T+u.x,U+u.y,!1);F.update_bbox();return t.intersects_poly(F,0,0)};var L=new cr.quad,P=new cr.rect(0,0,0,0),X=[];b.prototype.testTilemapOverlap=function(g,u){var D,I=u.bbox,B=g.x,t=g.y;g.getCollisionRectCandidates(I,X);var C=u.collision_poly&&!u.collision_poly.is_empty();g=0;for(D=X.length;g<D;++g){var F=X[g];var O=F.rc;
if(I.intersects_rect_off(O,B,t)&&(L.set_from_rect(O),L.offset(B,t),L.intersects_quad(u.bquad)))if(C)if(u.collision_poly.cache_poly(u.width,u.height,u.angle),F.poly){if(F.poly.intersects_poly(u.collision_poly,u.x-(B+O.left),u.y-(t+O.top)))return cr.clearArray(X),!0}else{if(this.temp_poly.set_from_quad(L,0,0,O.right-O.left,O.bottom-O.top),this.temp_poly.intersects_poly(u.collision_poly,u.x,u.y))return cr.clearArray(X),!0}else if(F.poly){if(this.temp_poly.set_from_quad(u.bquad,0,0,u.width,u.height),
F.poly.intersects_poly(this.temp_poly,-(B+O.left),-(t+O.top)))return cr.clearArray(X),!0}else return cr.clearArray(X),!0}cr.clearArray(X);return!1};b.prototype.testRectOverlap=function(g,u){if(!u||!u.collisionsEnabled)return!1;u.update_bbox();if(!u.bbox.intersects_rect(g))return!1;if(u.tilemap_exists){u.getCollisionRectCandidates(g,X);var D,I=u.x,B=u.y;u=0;for(D=X.length;u<D;++u){var t=X[u];var C=t.rc;if(g.intersects_rect_off(C,I,B))if(t.poly){if(this.temp_poly.set_from_rect(g,0,0),t.poly.intersects_poly(this.temp_poly,
-(I+C.left),-(B+C.top)))return cr.clearArray(X),!0}else return cr.clearArray(X),!0}cr.clearArray(X);return!1}L.set_from_rect(g);if(!u.bquad.intersects_quad(L))return!1;if(!u.collision_poly||u.collision_poly.is_empty())return!0;u.collision_poly.cache_poly(u.width,u.height,u.angle);L.offset(-g.left,-g.top);this.temp_poly.set_from_quad(L,0,0,1,1);return u.collision_poly.intersects_poly(this.temp_poly,g.left-u.x,g.top-u.y)};b.prototype.testSegmentOverlap=function(g,u,D,I,B){if(!B||!B.collisionsEnabled)return!1;
B.update_bbox();P.set(cr.min(g,D),cr.min(u,I),cr.max(g,D),cr.max(u,I));if(!B.bbox.intersects_rect(P))return!1;if(B.tilemap_exists){B.getCollisionRectCandidates(P,X);var t,C=B.x,F=B.y;B=0;for(t=X.length;B<t;++B){var O=X[B];var W=O.rc;if(P.intersects_rect_off(W,C,F)&&(L.set_from_rect(W),L.offset(C,F),L.intersects_segment(g,u,D,I)))if(O.poly){if(O.poly.intersects_segment(C+W.left,F+W.top,g,u,D,I))return cr.clearArray(X),!0}else return cr.clearArray(X),!0}cr.clearArray(X);return!1}if(!B.bquad.intersects_segment(g,
u,D,I))return!1;if(!B.collision_poly||B.collision_poly.is_empty())return!0;B.collision_poly.cache_poly(B.width,B.height,B.angle);return B.collision_poly.intersects_segment(B.x,B.y,g,u,D,I)};b.prototype.typeHasBehavior=function(g,u){if(!u)return!1;var D,I;var B=0;for(D=g.behaviors.length;B<D;B++)if(g.behaviors[B].behavior instanceof u)return!0;if(!g.is_family)for(B=0,D=g.families.length;B<D;B++){var t=g.families[B];var C=0;for(I=t.behaviors.length;C<I;C++)if(t.behaviors[C].behavior instanceof u)return!0}return!1};
b.prototype.typeHasNoSaveBehavior=function(g){return this.typeHasBehavior(g,cr.behaviors.NoSave)};b.prototype.typeHasPersistBehavior=function(g){return this.typeHasBehavior(g,cr.behaviors.Persist)};b.prototype.getSolidBehavior=function(){return this.solidBehavior};b.prototype.getJumpthruBehavior=function(){return this.jumpthruBehavior};var ba=[];b.prototype.testOverlapSolid=function(g){var u;g.update_bbox();this.getSolidCollisionCandidates(g.layer,g.bbox,ba);var D=0;for(u=ba.length;D<u;++D){var I=
ba[D];if(I.extra.solidEnabled&&this.testOverlap(g,I))return cr.clearArray(ba),I}cr.clearArray(ba);return null};b.prototype.testRectOverlapSolid=function(g){var u;this.getSolidCollisionCandidates(null,g,ba);var D=0;for(u=ba.length;D<u;++D){var I=ba[D];if(I.extra.solidEnabled&&this.testRectOverlap(g,I))return cr.clearArray(ba),I}cr.clearArray(ba);return null};var aa=[];b.prototype.testOverlapJumpThru=function(g,u){var D=null;u&&(D=aa,cr.clearArray(D));g.update_bbox();this.getJumpthruCollisionCandidates(g.layer,
g.bbox,ba);var I;var B=0;for(I=ba.length;B<I;++B){var t=ba[B];if(t.extra.jumpthruEnabled&&this.testOverlap(g,t))if(u)D.push(t);else return cr.clearArray(ba),t}cr.clearArray(ba);return D};b.prototype.pushOutSolid=function(g,u,D,I,B,t){I=I||50;var C=g.x,F=g.y,O,W=null,T=null;for(O=0;O<I;O++)if(g.x=C+u*O,g.y=F+D*O,g.set_bbox_changed(),!this.testOverlap(g,W)&&((W=this.testOverlapSolid(g))&&(T=W),!W&&(B&&(W=t?this.testOverlap(g,t)?t:null:this.testOverlapJumpThru(g))&&(T=W),!W)))return T&&this.pushInFractional(g,
u,D,T,16),!0;g.x=C;g.y=F;g.set_bbox_changed();return!1};b.prototype.pushOutSolidAxis=function(g,u,D,I){I=I||50;var B=g.x,t=g.y,C=null,F=null,O,W;for(O=0;O<I;++O)for(W=0;2>W;++W){var T=2*W-1;g.x=B+u*O*T;g.y=t+D*O*T;g.set_bbox_changed();if(!this.testOverlap(g,C))if(C=this.testOverlapSolid(g))F=C;else return F&&this.pushInFractional(g,u*T,D*T,F,16),!0}g.x=B;g.y=t;g.set_bbox_changed();return!1};b.prototype.pushOut=function(g,u,D,I,B){I=I||50;var t=g.x,C=g.y,F;for(F=0;F<I;F++)if(g.x=t+u*F,g.y=C+D*F,g.set_bbox_changed(),
!this.testOverlap(g,B))return!0;g.x=t;g.y=C;g.set_bbox_changed();return!1};b.prototype.pushInFractional=function(g,u,D,I,B){var t=2,C=!1;var F=!1;for(var O=g.x,W=g.y;t<=B;)F=1/t,t*=2,g.x+=u*F*(C?1:-1),g.y+=D*F*(C?1:-1),g.set_bbox_changed(),this.testOverlap(g,I)?F=C=!0:(F=C=!1,O=g.x,W=g.y);F&&(g.x=O,g.y=W,g.set_bbox_changed())};b.prototype.pushOutSolidNearest=function(g,u){u=cr.is_undefined(u)?100:u;var D=0,I=g.x,B=g.y,t=0,C=0,F=0,O=this.testOverlapSolid(g);if(!O)return!0;for(;D<=u;){switch(t){case 0:C=
0;F=-1;D++;break;case 1:C=1;F=-1;break;case 2:C=1;F=0;break;case 3:F=C=1;break;case 4:C=0;F=1;break;case 5:C=-1;F=1;break;case 6:C=-1;F=0;break;case 7:F=C=-1}t=(t+1)%8;g.x=cr.floor(I+C*D);g.y=cr.floor(B+F*D);g.set_bbox_changed();if(!this.testOverlap(g,O)&&(O=this.testOverlapSolid(g),!O))return!0}g.x=I;g.y=B;g.set_bbox_changed();return!1};b.prototype.registerCollision=function(g,u){g.collisionsEnabled&&u.collisionsEnabled&&this.registered_collisions.push([g,u])};b.prototype.addRegisteredCollisionCandidates=
function(g,u,D){var I;var B=0;for(I=this.registered_collisions.length;B<I;++B){var t=this.registered_collisions[B];if(t[0]===g)t=t[1];else if(t[1]===g)t=t[0];else continue;if(u.is_family){if(-1===u.members.indexOf(u))continue}else if(t.type!==u)continue;-1===D.indexOf(t)&&D.push(t)}};b.prototype.checkRegisteredCollision=function(g,u){var D;var I=0;for(D=this.registered_collisions.length;I<D;I++){var B=this.registered_collisions[I];if(B[0]===g&&B[1]===u||B[0]===u&&B[1]===g)return!0}return!1};b.prototype.calculateSolidBounceAngle=
function(g,u,D,I){var B=g.x,t=g.y,C=cr.max(10,cr.distanceTo(u,D,B,t)),F=cr.angleTo(u,D,B,t),O=I||this.testOverlapSolid(g);if(!O)return cr.clamp_angle(F+cr.PI);var W=O,T,U=cr.to_radians(5);for(T=1;36>T;T++){var Y=F-T*U;g.x=u+Math.cos(Y)*C;g.y=D+Math.sin(Y)*C;g.set_bbox_changed();if(!this.testOverlap(g,W)&&(W=I?null:this.testOverlapSolid(g),!W)){var da=Y;break}}36===T&&(da=cr.clamp_angle(F+cr.PI));W=O;for(T=1;36>T;T++)if(Y=F+T*U,g.x=u+Math.cos(Y)*C,g.y=D+Math.sin(Y)*C,g.set_bbox_changed(),!this.testOverlap(g,
W)&&(W=I?null:this.testOverlapSolid(g),!W)){var ia=Y;break}36===T&&(ia=cr.clamp_angle(F+cr.PI));g.x=B;g.y=t;g.set_bbox_changed();if(ia===da)return ia;g=cr.angleDiff(ia,da)/2;g=cr.angleClockwise(ia,da)?cr.clamp_angle(da+g+cr.PI):cr.clamp_angle(ia+g);da=Math.cos(F);F=Math.sin(F);ia=Math.cos(g);g=Math.sin(g);u=da*ia+F*g;return cr.angleTo(0,0,da-2*u*ia,F-2*u*g)};var ca=-1;b.prototype.trigger=function(g,u,D){if(!this.running_layout)return!1;var I=this.running_layout.event_sheet;if(!I)return!1;var B=!1,
t;ca++;var C=I.deep_includes;var F=0;for(t=C.length;F<t;++F){var O=this.triggerOnSheet(g,u,C[F],D);B=B||O}O=this.triggerOnSheet(g,u,I,D);ca--;return B||O};b.prototype.triggerOnSheet=function(g,u,D,I){var B=!1,t;if(u){var C=this.triggerOnSheetForTypeName(g,u,u.type.name,D,I);B=B||C;var F=u.type.families;var O=0;for(t=F.length;O<t;++O)C=this.triggerOnSheetForTypeName(g,u,F[O].name,D,I),B=B||C}else C=this.triggerOnSheetForTypeName(g,u,"system",D,I),B=B||C;return B};b.prototype.triggerOnSheetForTypeName=
function(g,u,D,I,B){var t,C=!1;var F="undefined"!==typeof B;var O=(F?I.fasttriggers:I.triggers)[D];if(!O)return C;var W=null;I=0;for(t=O.length;I<t;++I)if(O[I].method==g){W=O[I].evs;break}if(!W)return C;g=F?W[B]:W;if(!g)return null;I=0;for(t=g.length;I<t;I++)B=g[I][0],F=g[I][1],B=this.executeSingleTrigger(u,D,B,F),C=C||B;return C};b.prototype.executeSingleTrigger=function(g,u,D,I){var B,t=!1;this.trigger_depth++;var C=this.getCurrentEventStack().current_event;C&&this.pushCleanSol(C.solModifiersIncludingParents);
var F=1<this.trigger_depth;this.pushCleanSol(D.solModifiersIncludingParents);F&&this.pushLocalVarStack();var O=this.pushEventStack(D);O.current_event=D;if(g){var W=this.types[u].getCurrentSol();W.select_all=!1;cr.clearArray(W.instances);W.instances[0]=g;this.types[u].applySolToContainer()}g=!0;if(D.parent){u=O.temp_parents_arr;for(W=D.parent;W;)u.push(W),W=W.parent;u.reverse();W=0;for(B=u.length;W<B;W++)if(!u[W].run_pretrigger()){g=!1;break}}g&&(this.execcount++,D.orblock?D.run_orblocktrigger(I):
D.run(),t=t||O.last_event_true);this.popEventStack();F&&this.popLocalVarStack();this.popSol(D.solModifiersIncludingParents);C&&this.popSol(C.solModifiersIncludingParents);this.hasPendingInstances&&0===this.isInOnDestroy&&0===ca&&!this.isRunningEvents&&this.ClearDeathRow();this.trigger_depth--;return t};b.prototype.getCurrentCondition=function(){var g=this.getCurrentEventStack();return g.current_event.conditions[g.cndindex]};b.prototype.getCurrentConditionObjectType=function(){return this.getCurrentCondition().type};
b.prototype.isCurrentConditionFirst=function(){return 0===this.getCurrentEventStack().cndindex};b.prototype.getCurrentAction=function(){var g=this.getCurrentEventStack();return g.current_event.actions[g.actindex]};b.prototype.pushLocalVarStack=function(){this.localvar_stack_index++;this.localvar_stack_index>=this.localvar_stack.length&&this.localvar_stack.push([])};b.prototype.popLocalVarStack=function(){this.localvar_stack_index--};b.prototype.getCurrentLocalVarStack=function(){return this.localvar_stack[this.localvar_stack_index]};
b.prototype.pushEventStack=function(g){this.event_stack_index++;this.event_stack_index>=this.event_stack.length&&this.event_stack.push(new cr.eventStackFrame);var u=this.getCurrentEventStack();u.reset(g);return u};b.prototype.popEventStack=function(){this.event_stack_index--};b.prototype.getCurrentEventStack=function(){return this.event_stack[this.event_stack_index]};b.prototype.pushLoopStack=function(g){this.loop_stack_index++;this.loop_stack_index>=this.loop_stack.length&&this.loop_stack.push(cr.seal({name:g,
index:0,stopped:!1}));var u=this.getCurrentLoop();u.name=g;u.index=0;u.stopped=!1;return u};b.prototype.popLoopStack=function(){this.loop_stack_index--};b.prototype.getCurrentLoop=function(){return this.loop_stack[this.loop_stack_index]};b.prototype.getEventVariableByName=function(g,u){for(var D,I,B,t,C;u;){D=0;for(I=u.subevents.length;D<I;D++)if(C=u.subevents[D],C instanceof cr.eventvariable&&cr.equals_nocase(g,C.name))return C;u=u.parent}D=0;for(I=this.eventsheets_by_index.length;D<I;D++)for(t=
this.eventsheets_by_index[D],u=0,B=t.events.length;u<B;u++)if(C=t.events[u],C instanceof cr.eventvariable&&cr.equals_nocase(g,C.name))return C;return null};b.prototype.getLayoutBySid=function(g){var u;var D=0;for(u=this.layouts_by_index.length;D<u;D++)if(this.layouts_by_index[D].sid===g)return this.layouts_by_index[D];return null};b.prototype.getObjectTypeBySid=function(g){var u;var D=0;for(u=this.types_by_index.length;D<u;D++)if(this.types_by_index[D].sid===g)return this.types_by_index[D];return null};
b.prototype.getGroupBySid=function(g){var u;var D=0;for(u=this.allGroups.length;D<u;D++)if(this.allGroups[D].sid===g)return this.allGroups[D];return null};b.prototype.requirePermissions=function(g){return this.getPermissions(g).then(function(u){if(!1===u)return Promise.reject("Permission not granted")})};b.prototype.getPermissions=function(g){return this.isCordova&&this.isAndroid?g.reduce(function(u,D){return u.then(function(I){return!1===I?!1:r(D).then(function(B){return B?!0:h(D)})})},Promise.resolve(!0)):
Promise.resolve(!0)};b.prototype.doCanvasSnapshot=function(g,u){this.snapshotCanvas=[g,u];this.redraw=!0};b.prototype.signalContinuousPreview=function(){this.signalledContinuousPreview=!0};b.prototype.handleSaveLoad=function(){var g=this,u=this.saveToSlot,D=this.lastSaveJson,I=this.loadFromSlot,B=!1;this.signalledContinuousPreview&&(B=!0,u="__c2_continuouspreview",this.signalledContinuousPreview=!1);if(u.length){this.ClearDeathRow();D=this.saveToJSONString();if(z())k(u,D,function(){cr.logexport("Saved state to IndexedDB storage ("+
D.length+" bytes)");g.lastSaveJson=D;g.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null);D=g.lastSaveJson="";B&&c()},function(t){try{localStorage.setItem("__c2save_"+u,D),cr.logexport("Saved state to WebStorage ("+D.length+" bytes)"),g.lastSaveJson=D,g.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null),D=g.lastSaveJson="",B&&c()}catch(C){cr.logexport("Failed to save game state: "+t+"; "+C),g.trigger(cr.system_object.prototype.cnds.OnSaveFailed,null)}});else try{localStorage.setItem("__c2save_"+
u,D),cr.logexport("Saved state to WebStorage ("+D.length+" bytes)"),g.lastSaveJson=D,this.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null),D=g.lastSaveJson="",B&&c()}catch(t){cr.logexport("Error saving to WebStorage: "+t),g.trigger(cr.system_object.prototype.cnds.OnSaveFailed,null)}this.loadFromSlot=this.saveToSlot="";this.loadFromJson=null}if(I.length){if(z())a(I,function(t){t?(g.loadFromJson=t,cr.logexport("Loaded state from IndexedDB storage ("+g.loadFromJson.length+" bytes)")):(g.loadFromJson=
localStorage.getItem("__c2save_"+I)||"",cr.logexport("Loaded state from WebStorage ("+g.loadFromJson.length+" bytes)"));g.suspendDrawing=!1;g.loadFromJson||(g.loadFromJson=null,g.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null))},function(t){g.loadFromJson=localStorage.getItem("__c2save_"+I)||"";cr.logexport("Loaded state from WebStorage ("+g.loadFromJson.length+" bytes)");g.suspendDrawing=!1;g.loadFromJson||(g.loadFromJson=null,g.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null))});
else{try{this.loadFromJson=localStorage.getItem("__c2save_"+I)||"",cr.logexport("Loaded state from WebStorage ("+this.loadFromJson.length+" bytes)")}catch(t){this.loadFromJson=null}this.suspendDrawing=!1;g.loadFromJson||(g.loadFromJson=null,g.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null))}this.saveToSlot=this.loadFromSlot=""}null!==this.loadFromJson&&(this.ClearDeathRow(),this.loadFromJSONString(this.loadFromJson)?(this.lastSaveJson=this.loadFromJson,this.trigger(cr.system_object.prototype.cnds.OnLoadComplete,
null),this.lastSaveJson=""):g.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null),this.loadFromJson=null)};b.prototype.saveToJSONString=function(){var g,u,D,I={c2save:!0,version:1,rt:{time:this.kahanTime.sum,walltime:this.wallTime.sum,timescale:this.timescale,tickcount:this.tickcount,execcount:this.execcount,next_uid:this.next_uid,running_layout:this.running_layout.sid,start_time_offset:Date.now()-this.start_time},types:{},layouts:{},events:{groups:{},cnds:{},acts:{},vars:{}}};var B=0;for(g=
this.types_by_index.length;B<g;B++){var t=this.types_by_index[B];if(!t.is_family&&!this.typeHasNoSaveBehavior(t)){var C={instances:[]};cr.hasAnyOwnProperty(t.extra)&&(C.ex=l(t.extra));var F=0;for(u=t.instances.length;F<u;F++)C.instances.push(this.saveInstanceToJSON(t.instances[F]));I.types[t.sid.toString()]=C}}B=0;for(g=this.layouts_by_index.length;B<g;B++)F=this.layouts_by_index[B],I.layouts[F.sid.toString()]=F.saveToJSON();u=I.events.groups;B=0;for(g=this.allGroups.length;B<g;B++)F=this.allGroups[B],
u[F.sid.toString()]=this.groups_by_name[F.group_name].group_active;g=I.events.cnds;for(D in this.cndsBySid)this.cndsBySid.hasOwnProperty(D)&&(B=this.cndsBySid[D],cr.hasAnyOwnProperty(B.extra)&&(g[D]={ex:l(B.extra)}));g=I.events.acts;for(D in this.actsBySid)this.actsBySid.hasOwnProperty(D)&&(B=this.actsBySid[D],cr.hasAnyOwnProperty(B.extra)&&(g[D]={ex:l(B.extra)}));g=I.events.vars;for(D in this.varsBySid)this.varsBySid.hasOwnProperty(D)&&(B=this.varsBySid[D],B.is_constant||B.parent&&!B.is_static||
(g[D]=B.data));I.system=this.system.saveToJSON();return JSON.stringify(I)};b.prototype.refreshUidMap=function(){var g,u;this.objectsByUid={};var D=0;for(g=this.types_by_index.length;D<g;D++){var I=this.types_by_index[D];if(!I.is_family){var B=0;for(u=I.instances.length;B<u;B++){var t=I.instances[B];this.objectsByUid[t.uid.toString()]=t}}}};b.prototype.loadFromJSONString=function(g){try{var u=JSON.parse(g)}catch(T){return!1}if(!u.c2save||1<u.version)return!1;this.isLoadingState=!0;g=u.rt;this.kahanTime.reset();
this.kahanTime.sum=g.time;this.wallTime.reset();this.wallTime.sum=g.walltime||0;this.timescale=g.timescale;this.tickcount=g.tickcount;this.execcount=g.execcount;this.start_time=Date.now()-g.start_time_offset;var D=g.running_layout;if(D!==this.running_layout.sid)if(D=this.getLayoutBySid(D))this.doChangeLayout(D);else return;var I,B,t;var C=u.types;for(B in C)if(C.hasOwnProperty(B)&&(t=this.getObjectTypeBySid(parseInt(B,10)))&&!t.is_family&&!this.typeHasNoSaveBehavior(t)){C[B].ex?t.extra=C[B].ex:cr.wipe(t.extra);
var F=t.instances;var O=C[B].instances;D=0;for(I=cr.min(F.length,O.length);D<I;D++)this.loadInstanceFromJSON(F[D],O[D]);D=O.length;for(I=F.length;D<I;D++)this.DestroyInstance(F[D]);D=F.length;for(I=O.length;D<I;D++){F=null;if(t.plugin.is_world&&(F=this.running_layout.getLayerBySid(O[D].w.l),!F))continue;F=this.createInstanceFromInit(t.default_instance,F,!1,0,0,!0);this.loadInstanceFromJSON(F,O[D])}t.stale_iids=!0}this.ClearDeathRow();this.refreshUidMap();I=u.layouts;for(B in I)I.hasOwnProperty(B)&&
(D=this.getLayoutBySid(parseInt(B,10)))&&D.loadFromJSON(I[B]);I=u.events.groups;for(B in I)I.hasOwnProperty(B)&&(D=this.getGroupBySid(parseInt(B,10)))&&this.groups_by_name[D.group_name]&&this.groups_by_name[D.group_name].setGroupActive(I[B]);D=u.events.cnds;for(B in this.cndsBySid)this.cndsBySid.hasOwnProperty(B)&&(D.hasOwnProperty(B)?this.cndsBySid[B].extra=D[B].ex:this.cndsBySid[B].extra={});D=u.events.acts;for(B in this.actsBySid)this.actsBySid.hasOwnProperty(B)&&(D.hasOwnProperty(B)?this.actsBySid[B].extra=
D[B].ex:this.actsBySid[B].extra={});D=u.events.vars;for(B in D)D.hasOwnProperty(B)&&this.varsBySid.hasOwnProperty(B)&&(this.varsBySid[B].data=D[B]);this.next_uid=g.next_uid;this.isLoadingState=!1;D=0;for(I=this.fireOnCreateAfterLoad.length;D<I;++D)F=this.fireOnCreateAfterLoad[D],this.trigger(Object.getPrototypeOf(F.type.plugin).cnds.OnCreated,F);cr.clearArray(this.fireOnCreateAfterLoad);this.system.loadFromJSON(u.system);D=0;for(I=this.types_by_index.length;D<I;D++)if(t=this.types_by_index[D],!t.is_family&&
!this.typeHasNoSaveBehavior(t))for(u=0,B=t.instances.length;u<B;u++){F=t.instances[u];if(t.is_contained)for(C=F.get_iid(),cr.clearArray(F.siblings),g=0,O=t.container.length;g<O;g++){var W=t.container[g];t!==W&&F.siblings.push(W.instances[C])}F.afterLoad&&F.afterLoad();if(F.behavior_insts)for(g=0,O=F.behavior_insts.length;g<O;g++)C=F.behavior_insts[g],C.afterLoad&&C.afterLoad()}return this.redraw=!0};b.prototype.saveInstanceToJSON=function(g,u){var D;var I=g.type;var B=I.plugin;var t={};u?t.c2=!0:
t.uid=g.uid;cr.hasAnyOwnProperty(g.extra)&&(t.ex=l(g.extra));if(g.instance_vars&&g.instance_vars.length)for(t.ivs={},u=0,D=g.instance_vars.length;u<D;u++)t.ivs[g.type.instvar_sids[u].toString()]=g.instance_vars[u];if(B.is_world){B={x:g.x,y:g.y,w:g.width,h:g.height,l:g.layer.sid,zi:g.get_zindex()};0!==g.angle&&(B.a=g.angle);1!==g.opacity&&(B.o=g.opacity);.5!==g.hotspotX&&(B.hX=g.hotspotX);.5!==g.hotspotY&&(B.hY=g.hotspotY);0!==g.blend_mode&&(B.bm=g.blend_mode);g.visible||(B.v=g.visible);g.collisionsEnabled||
(B.ce=g.collisionsEnabled);-1!==g.my_timescale&&(B.mts=g.my_timescale);if(I.effect_types.length)for(B.fx=[],u=0,D=I.effect_types.length;u<D;u++){var C=I.effect_types[u];B.fx.push({name:C.name,active:g.active_effect_flags[C.index],params:g.effect_params[C.index]})}t.w=B}if(g.behavior_insts&&g.behavior_insts.length)for(t.behs={},u=0,D=g.behavior_insts.length;u<D;u++)I=g.behavior_insts[u],I.saveToJSON&&(t.behs[I.type.sid.toString()]=I.saveToJSON());g.saveToJSON&&(t.data=g.saveToJSON());return t};b.prototype.getInstanceVarIndexBySid=
function(g,u){var D;var I=0;for(D=g.instvar_sids.length;I<D;I++)if(g.instvar_sids[I]===u)return I;return-1};b.prototype.getBehaviorIndexBySid=function(g,u){var D;var I=0;for(D=g.behavior_insts.length;I<D;I++)if(g.behavior_insts[I].type.sid===u)return I;return-1};b.prototype.loadInstanceFromJSON=function(g,u,D){var I,B;var t=g.type;var C=t.plugin;if(D){if(!u.c2)return}else g.uid=u.uid;u.ex?g.extra=u.ex:cr.wipe(g.extra);if(B=u.ivs)for(I in B)if(B.hasOwnProperty(I)){var F=this.getInstanceVarIndexBySid(t,
parseInt(I,10));if(!(0>F||F>=g.instance_vars.length)){var O=B[I];null===O&&(O=NaN);g.instance_vars[F]=O}}if(C.is_world){F=u.w;g.layer.sid!==F.l&&(B=g.layer,g.layer=this.running_layout.getLayerBySid(F.l),g.layer?(B.removeFromInstanceList(g,!0),g.layer.appendToInstanceList(g,!0),g.set_bbox_changed(),g.layer.setZIndicesStaleFrom(0)):(g.layer=B,D||this.DestroyInstance(g)));g.x=F.x;g.y=F.y;g.width=F.w;g.height=F.h;g.zindex=F.zi;g.angle=F.hasOwnProperty("a")?F.a:0;g.opacity=F.hasOwnProperty("o")?F.o:1;
g.hotspotX=F.hasOwnProperty("hX")?F.hX:.5;g.hotspotY=F.hasOwnProperty("hY")?F.hY:.5;g.visible=F.hasOwnProperty("v")?F.v:!0;g.collisionsEnabled=F.hasOwnProperty("ce")?F.ce:!0;g.my_timescale=F.hasOwnProperty("mts")?F.mts:-1;g.blend_mode=F.hasOwnProperty("bm")?F.bm:0;g.compositeOp=cr.effectToCompositeOp(g.blend_mode);this.gl&&cr.setGLBlend(g,g.blend_mode,this.gl);g.set_bbox_changed();if(F.hasOwnProperty("fx"))for(D=0,B=F.fx.length;D<B;D++)O=t.getEffectIndexByName(F.fx[D].name),0>O||(g.active_effect_flags[O]=
F.fx[D].active,g.effect_params[O]=F.fx[D].params);g.updateActiveEffects()}if(t=u.behs)for(I in t)t.hasOwnProperty(I)&&(D=this.getBehaviorIndexBySid(g,parseInt(I,10)),0>D||g.behavior_insts[D].loadFromJSON(t[I]));u.data&&g.loadFromJSON(u.data)};b.prototype.getProjectFileUrl=function(g){return this.isPreview?window.cr_previewProjectFiles.hasOwnProperty(g.toLowerCase())?window.cr_previewProjectFiles[g.toLowerCase()]:g:this.files_subfolder+g};b.prototype.getProjectFileBlob=function(g){return this.isPreview?
window.cr_previewProjectFileBlobs&&window.cr_previewProjectFiles.hasOwnProperty(g.toLowerCase())?window.cr_previewProjectFileBlobs[g.toLowerCase()]:null:null};b.prototype.getLocalFileUrl=function(g){return this.isPreview?window.cr_previewProjectFiles.hasOwnProperty(g.toLowerCase())?window.cr_previewProjectFiles[g.toLowerCase()]:g:g};b.prototype.fetchLocalFileViaCordova=function(g,u,D){window.resolveLocalFileSystemURL(window.cordova.file.applicationDirectory+"www/"+g,function(I){I.file(u,D)},D)};b.prototype.fetchLocalFileViaCordovaAsText=
function(g,u,D){this.fetchLocalFileViaCordova(g,function(I){var B=new FileReader;B.onload=function(t){u(t.target.result)};B.onerror=D;B.readAsText(I)},D)};var ja=[],ha=0;b.prototype.maybeStartNextArrayBufferRead=function(){if(ja.length&&!(8<=ha)){ha++;var g=ja.shift();this.doFetchLocalFileViaCordovaAsArrayBuffer(g.filename,g.successCallback,g.errorCallback)}};b.prototype.fetchLocalFileViaCordovaAsArrayBuffer=function(g,u,D){var I=this;ja.push({filename:g,successCallback:function(B){ha--;I.maybeStartNextArrayBufferRead();
u(B)},errorCallback:function(B){ha--;I.maybeStartNextArrayBufferRead();D(B)}});this.maybeStartNextArrayBufferRead()};b.prototype.doFetchLocalFileViaCordovaAsArrayBuffer=function(g,u,D){this.fetchLocalFileViaCordova(g,function(I){var B=new FileReader;B.onload=function(t){u(t.target.result)};B.readAsArrayBuffer(I)},D)};b.prototype.fetchLocalFileViaCordovaAsURL=function(g,u,D){var I="",B=g.toLowerCase(),t=B.substr(B.length-4);B=B.substr(B.length-5);".mp4"===t?I="video/mp4":".webm"===B?I="video/webm":
".m4a"===t?I="audio/mp4":".mp3"===t&&(I="audio/mpeg");this.fetchLocalFileViaCordovaAsArrayBuffer(g,function(C){C=new Blob([C],{type:I});C=URL.createObjectURL(C);u(C)},D)};b.prototype.isAbsoluteUrl=function(g){return/^(?:[a-z]+:)?\/\//.test(g)||"data:"===g.substr(0,5)||"blob:"===g.substr(0,5)};b.prototype.setImageSrc=function(g,u){this.isWKWebView&&!this.isAbsoluteUrl(u)?this.fetchLocalFileViaCordovaAsURL(u,function(D){g.src=D},function(D){alert("Failed to load image: "+D)}):this.isPreview&&!this.isAbsoluteUrl(u)?
g.src=this.getLocalFileUrl(u):(this.isAbsoluteUrl(u)||(u=u.toLowerCase()),g.src=u)};b.prototype.getPreferredAudioFile=function(g){g=g.toLowerCase();if(!this.audio_files_map.hasOwnProperty(g))return null;g=this.audio_files_map[g];var u=null,D;var I=0;for(D=g.length;I<D;++I){var B=g[I];var t=B[0];u||"audio/webm; codecs=opus"!==t||(u=B);if(w[t])return B}return u};b.prototype.getProjectAudioFileUrl=function(g){var u=g.toLowerCase();return(g=this.getPreferredAudioFile(g))?{url:this.getProjectFileUrl(u+
g[1]),type:g[0]}:null};b.prototype.getStatusInfo=function(){return{fps:this.fps,cpu:this.cpuutilisation/1E3,gpu:this.gpuLastUtilisation,layout:this.running_layout?this.running_layout.name:"",renderer:this.glUnmaskedRenderer}};b.prototype.accelerate=function(g,u,D,I,B){return this.enhancedAccelerationPrecision?cr.clamp(g*B+.5*I*B*B,u*B,D*B):g*B};cr.runtime=b;cr.createRuntime=function(g){return new b(g)};window.cr_createRuntime=cr.createRuntime})();
window.cr_getSnapshot=function(b,e){var h=window.c3runtime;h&&h.doCanvasSnapshot(b,e)};window.cr_sizeCanvas=function(b,e){if(0!==b&&0!==e){var h=window.c3runtime;h&&h.setSize(b,e)}};window.cr_setSuspended=function(b){var e=window.c3runtime;e&&e.setSuspended(b)};
(function(){function b(a,c){return a.zindex-c.zindex}function e(a,c){this.layout=a;this.runtime=a.runtime;this.instances=[];this.scale=1;this.angle=0;this.disableAngle=!1;this.tmprect=new cr.rect(0,0,0,0);this.tmpquad=new cr.quad;this.viewBottom=this.viewTop=this.viewRight=this.viewLeft=0;this.zindices_stale=!1;this.zindices_stale_from=-1;this.clear_earlyz_index=0;this.name=c[0];this.index=c[1];this.sid=c[2];this.visible=c[3];this.background_color=c[4];this.transparent=c[5];this.parallaxX=c[6];this.parallaxY=
c[7];this.opacity=c[8];this.forceOwnTexture=c[9];this.useRenderCells=c[10];this.zoomRate=c[11];this.blend_mode=c[12];this.effect_fallback=c[13];this.compositeOp="source-over";this.destBlend=this.srcBlend=0;this.render_grid=null;this.last_render_list=h();this.render_list_stale=!0;this.last_render_cells=new cr.rect(0,0,-1,-1);this.cur_render_cells=new cr.rect(0,0,-1,-1);this.useRenderCells&&(this.render_grid=new cr.RenderGrid(this.runtime.original_width,this.runtime.original_height));this.render_offscreen=
!1;a=c[14];var l;this.startup_initial_instances=[];this.initial_instances=[];this.created_globals=[];var q=0;for(l=a.length;q<l;q++){var p=a[q],w=this.runtime.types_by_index[p[1]];w.default_instance||(w.default_instance=p,w.default_layerindex=this.index);this.initial_instances.push(p);-1===this.layout.initial_types.indexOf(w)&&this.layout.initial_types.push(w)}cr.shallowAssignArray(this.startup_initial_instances,this.initial_instances);this.effect_types=[];this.active_effect_types=[];this.shaders_preserve_opaqueness=
!0;this.effect_params=[];q=0;for(l=c[15].length;q<l;q++)this.effect_types.push({id:c[15][q][0],name:c[15][q][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:q}),this.effect_params.push(c[15][q][2].slice(0));this.updateActiveEffects();this.rcTexBounce=new cr.rect(0,0,1,1);this.rcTexDest=new cr.rect(0,0,1,1);this.rcTexOrigin=new cr.rect(0,0,1,1)}function h(){return z.length?z.pop():[]}function r(a){cr.clearArray(a);z.push(a)}e.prototype.updateActiveEffects=function(){cr.clearArray(this.active_effect_types);
this.shaders_preserve_opaqueness=!0;var a;var c=0;for(a=this.effect_types.length;c<a;c++){var l=this.effect_types[c];l.active&&(this.active_effect_types.push(l),l.preservesOpaqueness||(this.shaders_preserve_opaqueness=!1))}};e.prototype.getEffectByName=function(a){var c;var l=0;for(c=this.effect_types.length;l<c;l++){var q=this.effect_types[l];if(q.name===a)return q}return null};e.prototype.createInitialInstances=function(a){var c,l;var q=c=0;for(l=this.initial_instances.length;c<l;c++){var p=this.initial_instances[c];
var w=this.runtime.types_by_index[p[1]];var K=this.runtime.typeHasPersistBehavior(w);w=!0;if(!K||this.layout.first_visit){p=this.runtime.createInstanceFromInit(p,this,!0);if(!p)continue;a.push(p);p.type.global&&(w=!1,this.created_globals.push(p.uid))}w&&(this.initial_instances[q]=this.initial_instances[c],q++)}this.initial_instances.length=q;this.runtime.ClearDeathRow();!this.runtime.glwrap&&this.effect_types.length&&(this.blend_mode=this.effect_fallback);this.compositeOp=cr.effectToCompositeOp(this.blend_mode);
this.runtime.gl&&cr.setGLBlend(this,this.blend_mode,this.runtime.gl);this.render_list_stale=!0};e.prototype.recreateInitialObjects=function(a,c){var l,q=this.runtime.types_by_index,p=a.is_family,w=a.members;var K=0;for(l=this.initial_instances.length;K<l;++K){var A=this.initial_instances[K];var J=A[0];var R=J[0];J=J[1];if(c.contains_pt(R,J)){R=q[A[1]];if(R!==a)if(p){if(0>w.indexOf(R))continue}else continue;A=this.runtime.createInstanceFromInit(A,this,!1);this.runtime.isInOnDestroy++;this.runtime.trigger(Object.getPrototypeOf(R.plugin).cnds.OnCreated,
A);if(A.is_contained)for(R=0,J=A.siblings.length;R<J;R++){var n=A.siblings[K];this.runtime.trigger(Object.getPrototypeOf(n.type.plugin).cnds.OnCreated,n)}this.runtime.isInOnDestroy--}}};e.prototype.removeFromInstanceList=function(a,c){var l=cr.fastIndexOf(this.instances,a);0>l||(c&&this.useRenderCells&&a.rendercells&&a.rendercells.right>=a.rendercells.left&&(a.update_bbox(),this.render_grid.update(a,a.rendercells,null),a.rendercells.set(0,0,-1,-1)),l===this.instances.length-1?this.instances.pop():
(cr.arrayRemove(this.instances,l),this.setZIndicesStaleFrom(l)),this.render_list_stale=!0)};e.prototype.appendToInstanceList=function(a,c){a.zindex=this.instances.length;this.instances.push(a);c&&this.useRenderCells&&a.rendercells&&a.set_bbox_changed();this.render_list_stale=!0};e.prototype.prependToInstanceList=function(a,c){this.instances.unshift(a);this.setZIndicesStaleFrom(0);c&&this.useRenderCells&&a.rendercells&&a.set_bbox_changed()};e.prototype.moveInstanceAdjacent=function(a,c,l){var q=a.get_zindex();
c=c.get_zindex();cr.arrayRemove(this.instances,q);q<c&&c--;l&&c++;c===this.instances.length?this.instances.push(a):this.instances.splice(c,0,a);this.setZIndicesStaleFrom(q<c?q:c)};e.prototype.setZIndicesStaleFrom=function(a){-1===this.zindices_stale_from?this.zindices_stale_from=a:a<this.zindices_stale_from&&(this.zindices_stale_from=a);this.render_list_stale=this.zindices_stale=!0};e.prototype.updateZIndices=function(){if(this.zindices_stale){-1===this.zindices_stale_from&&(this.zindices_stale_from=
0);var a;if(this.useRenderCells){var c=this.zindices_stale_from;for(a=this.instances.length;c<a;++c){var l=this.instances[c];l.zindex=c;this.render_grid.markRangeChanged(l.rendercells)}}else for(c=this.zindices_stale_from,a=this.instances.length;c<a;++c)this.instances[c].zindex=c;this.zindices_stale=!1;this.zindices_stale_from=-1}};e.prototype.getScale=function(a){return this.getNormalScale()*(this.runtime.fullscreenScalingQuality||a?this.runtime.aspect_scale:1)};e.prototype.getNormalScale=function(){return(this.scale*
this.layout.scale-1)*this.zoomRate+1};e.prototype.getAngle=function(){return this.disableAngle?0:cr.clamp_angle(this.layout.angle+this.angle)};var z=[],N=[],k=[];e.prototype.getRenderCellInstancesToDraw=function(){this.updateZIndices();this.render_grid.queryRange(this.viewLeft,this.viewTop,this.viewRight,this.viewBottom,k);if(!k.length)return h();if(1===k.length){var a=h();cr.shallowAssignArray(a,k[0]);cr.clearArray(k);return a}for(var c=!0;1<k.length;){var l;a=k;var q=c;var p=0;for(l=a.length;p<
l-1;p+=2){var w=a[p];var K=a[p+1];c=h();var A=w,J=K,R=c,n=0,x=0,E=0,V=A.length,Z=J.length;for(R.length=V+Z;n<V&&x<Z;++E){var M=A[n];var d=J[x];M.zindex<d.zindex?(R[E]=M,++n):(R[E]=d,++x)}for(;n<V;++n,++E)R[E]=A[n];for(;x<Z;++x,++E)R[E]=J[x];q||(r(w),r(K));N.push(c)}1===l%2&&(q?(w=h(),cr.shallowAssignArray(w,a[l-1]),N.push(w)):N.push(a[l-1]));cr.shallowAssignArray(a,N);cr.clearArray(N);c=!1}a=k[0];cr.clearArray(k);return a};e.prototype.draw=function(a){this.render_offscreen=this.forceOwnTexture||1!==
this.opacity||0!==this.blend_mode;var c=this.runtime.canvas,l=a,q=!1;this.render_offscreen&&(this.runtime.layer_canvas||(this.runtime.layer_canvas=document.createElement("canvas"),c=this.runtime.layer_canvas,c.width=this.runtime.draw_width,c.height=this.runtime.draw_height,this.runtime.layer_ctx=c.getContext("2d"),q=!0),c=this.runtime.layer_canvas,l=this.runtime.layer_ctx,c.width!==this.runtime.draw_width&&(c.width=this.runtime.draw_width,q=!0),c.height!==this.runtime.draw_height&&(c.height=this.runtime.draw_height,
q=!0),q&&(l.imageSmoothingEnabled=this.runtime.linearSampling),this.transparent&&l.clearRect(0,0,this.runtime.draw_width,this.runtime.draw_height));l.globalAlpha=1;l.globalCompositeOperation="source-over";this.transparent||(l.fillStyle="rgb("+this.background_color[0]+","+this.background_color[1]+","+this.background_color[2]+")",l.fillRect(0,0,this.runtime.draw_width,this.runtime.draw_height));l.save();this.disableAngle=!0;q=this.canvasToLayer(0,0,!0,!0);var p=this.canvasToLayer(0,0,!1,!0);this.disableAngle=
!1;this.runtime.pixel_rounding&&(q=Math.round(q),p=Math.round(p));this.rotateViewport(q,p,l);var w=this.getScale();l.scale(w,w);l.translate(-q,-p);this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?
(r(this.last_render_list),q=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):q=this.last_render_list):q=this.instances;var K=null;p=0;for(w=q.length;p<w;++p){var A=q[p];A!==K&&(this.drawInstance(A,l),K=A)}this.useRenderCells&&(this.last_render_list=q);l.restore();this.render_offscreen&&(a.globalCompositeOperation=this.compositeOp,a.globalAlpha=this.opacity,a.drawImage(c,0,0))};e.prototype.drawInstance=function(a,c){if(a.visible&&0!==
a.width&&0!==a.height){a.update_bbox();var l=a.bbox;l.right<this.viewLeft||l.bottom<this.viewTop||l.left>this.viewRight||l.top>this.viewBottom||(c.globalCompositeOperation=a.compositeOp,a.draw(c))}};e.prototype.updateViewport=function(a){this.disableAngle=!0;var c=this.canvasToLayer(0,0,!0,!0),l=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(c=Math.round(c),l=Math.round(l));this.rotateViewport(c,l,a)};e.prototype.rotateViewport=function(a,c,l){var q=this.getScale();
this.viewLeft=a;this.viewTop=c;this.viewRight=a+1/q*this.runtime.draw_width;this.viewBottom=c+1/q*this.runtime.draw_height;a=this.getAngle();0!==a&&(l&&(l.translate(this.runtime.draw_width/2,this.runtime.draw_height/2),l.rotate(-a),l.translate(this.runtime.draw_width/-2,this.runtime.draw_height/-2)),this.tmprect.set(this.viewLeft,this.viewTop,this.viewRight,this.viewBottom),this.tmprect.offset((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),this.tmpquad.set_from_rotated_rect(this.tmprect,
a),this.tmpquad.bounding_box(this.tmprect),this.tmprect.offset((this.viewLeft+this.viewRight)/2,(this.viewTop+this.viewBottom)/2),this.viewLeft=this.tmprect.left,this.viewTop=this.tmprect.top,this.viewRight=this.tmprect.right,this.viewBottom=this.tmprect.bottom)};e.prototype.drawGL_earlyZPass=function(a){if(this.render_offscreen=this.forceOwnTexture){this.runtime.layer_tex||(this.runtime.layer_tex=a.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));
if(this.runtime.layer_tex.c2width!==this.runtime.draw_width||this.runtime.layer_tex.c2height!==this.runtime.draw_height)a.deleteTexture(this.runtime.layer_tex),this.runtime.layer_tex=a.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);a.setRenderingToTexture(this.runtime.layer_tex)}this.disableAngle=!0;var c=this.canvasToLayer(0,0,!0,!0),l=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(c=Math.round(c),l=Math.round(l));
this.rotateViewport(c,l,null);c=this.getScale();a.resetModelView();a.scale(c,c);a.rotateZ(-this.getAngle());a.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2);a.updateModelView();this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),
this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(r(this.last_render_list),c=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):c=this.last_render_list):c=this.instances;var q=null;for(l=c.length-1;0<=l;--l){var p=c[l];p!==q&&(this.drawInstanceGL_earlyZPass(c[l],a),q=p)}this.useRenderCells&&(this.last_render_list=c);this.transparent||(this.clear_earlyz_index=this.runtime.earlyz_index++,a.setEarlyZIndex(this.clear_earlyz_index),
a.setColorFillMode(1,1,1,1),a.fullscreenQuad(),a.restoreEarlyZMode())};e.prototype.drawGL=function(a){if(this.render_offscreen=this.forceOwnTexture||1!==this.opacity||0<this.active_effect_types.length||0!==this.blend_mode){this.runtime.layer_tex||(this.runtime.layer_tex=a.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layer_tex.c2width!==this.runtime.draw_width||this.runtime.layer_tex.c2height!==this.runtime.draw_height)a.deleteTexture(this.runtime.layer_tex),
this.runtime.layer_tex=a.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);a.setRenderingToTexture(this.runtime.layer_tex);this.transparent&&a.clear(0,0,0,0)}this.transparent||(this.runtime.enableFrontToBack?(a.setEarlyZIndex(this.clear_earlyz_index),a.setColorFillMode(this.background_color[0]/255,this.background_color[1]/255,this.background_color[2]/255,1),a.fullscreenQuad(),a.setTextureFillMode()):a.clear(this.background_color[0]/255,this.background_color[1]/
255,this.background_color[2]/255,1));this.disableAngle=!0;var c=this.canvasToLayer(0,0,!0,!0);var l=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(c=Math.round(c),l=Math.round(l));this.rotateViewport(c,l,null);c=this.getScale();a.resetModelView();a.scale(c,c);a.rotateZ(-this.getAngle());a.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2);a.updateModelView();this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),
this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(r(this.last_render_list),l=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):l=this.last_render_list):l=this.instances;var q,p=null;if(2.220446049250313E-16<
this.getNormalScale()){var w=0;for(q=l.length;w<q;++w){var K=l[w];K!==p&&(this.drawInstanceGL(l[w],a),p=K)}}this.useRenderCells&&(this.last_render_list=l);this.render_offscreen&&(l=this.active_effect_types.length?this.active_effect_types[0].shaderindex:0,w=this.active_effect_types.length?this.active_effect_types[0].index:0,0===this.active_effect_types.length||1===this.active_effect_types.length&&!a.programUsesCrossSampling(l)&&1===this.opacity?(1===this.active_effect_types.length?(a.switchProgram(l),
a.setProgramParameters(this.layout.getRenderTarget(),1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,0,0,1,1,this.viewLeft,this.viewTop,this.viewRight,this.viewBottom,0,0,1,1,c,this.getAngle(),this.runtime.kahanTime.sum,this.effect_params[w]),a.programIsAnimated(l)&&(this.runtime.redraw=!0)):a.switchProgram(0),a.setRenderingToTexture(this.layout.getRenderTarget()),a.setOpacity(this.opacity),a.setTexture(this.runtime.layer_tex),a.setBlend(this.srcBlend,this.destBlend),a.resetModelView(),
a.updateModelView(),c=this.runtime.draw_width/2,l=this.runtime.draw_height/2,a.quad(-c,l,c,l,c,-l,-c,-l),a.setTexture(null)):this.layout.renderEffectChain(a,this,null,this.layout.getRenderTarget()))};e.prototype.drawInstanceGL=function(a,c){if(a.visible&&0!==a.width&&0!==a.height){a.update_bbox();var l=a.bbox;l.right<this.viewLeft||l.bottom<this.viewTop||l.left>this.viewRight||l.top>this.viewBottom||(c.setEarlyZIndex(a.earlyz_index),a.uses_shaders?this.drawInstanceWithShadersGL(a,c):(c.switchProgram(0),
c.setBlend(a.srcBlend,a.destBlend),a.drawGL(c)))}};e.prototype.drawInstanceGL_earlyZPass=function(a,c){if(a.visible&&0!==a.width&&0!==a.height){a.update_bbox();var l=a.bbox;l.right<this.viewLeft||l.bottom<this.viewTop||l.left>this.viewRight||l.top>this.viewBottom||(a.earlyz_index=this.runtime.earlyz_index++,0===a.blend_mode&&1===a.opacity&&a.shaders_preserve_opaqueness&&a.drawGL_earlyZPass&&(c.setEarlyZIndex(a.earlyz_index),a.drawGL_earlyZPass(c)))}};e.prototype.drawInstanceWithShadersGL=function(a,
c){var l=a.active_effect_types[0].shaderindex,q=a.active_effect_types[0].index,p=this.getScale(),w=this.runtime.draw_width,K=this.runtime.draw_height;if(1!==a.active_effect_types.length||c.programUsesCrossSampling(l)||c.programExtendsBox(l)||(a.angle||a.layer.getAngle())&&c.programUsesDest(l)||1!==a.opacity||a.type.plugin.must_predraw)this.layout.renderEffectChain(c,this,a,this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget()),c.resetModelView(),c.scale(p,p),c.rotateZ(-this.getAngle()),
c.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),c.updateModelView();else{c.switchProgram(l);c.setBlend(a.srcBlend,a.destBlend);c.programIsAnimated(l)&&(this.runtime.redraw=!0);var A=0,J=0,R=0,n=0;c.programUsesDest(l)&&(n=a.bbox,A=this.layerToCanvas(n.left,n.top,!0,!0),J=this.layerToCanvas(n.left,n.top,!1,!0),R=this.layerToCanvas(n.right,n.bottom,!0,!0),n=this.layerToCanvas(n.right,n.bottom,!1,!0),A/=w,J=1-J/K,R/=w,n=1-n/K);K=w=0;var x=l=1,E=1/a.width,V=1/a.height;
a.curFrame&&a.curFrame.sheetTex&&(w=a.curFrame.sheetTex.left,K=a.curFrame.sheetTex.top,l=a.curFrame.sheetTex.right,x=a.curFrame.sheetTex.bottom,a.curFrame.texture_img&&(E=1/a.curFrame.texture_img.width,V=1/a.curFrame.texture_img.height));c.setProgramParameters(this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget(),E,V,w,K,l,x,w,K,l,x,a.bbox.left,a.bbox.top,a.bbox.right,a.bbox.bottom,A,J,R,n,p,this.getAngle(),this.runtime.kahanTime.sum,a.effect_params[q]);a.drawGL(c)}};e.prototype.canvasToLayer=
function(a,c,l,q){var p=this.runtime.devicePixelRatio;this.runtime.isRetina&&(a*=p,c*=p);p=this.runtime.parallax_x_origin;var w=this.runtime.parallax_y_origin;p=(this.layout.scrollX-p)*this.parallaxX+p;w=(this.layout.scrollY-w)*this.parallaxY+w;var K=p,A=w,J=1/this.getScale(!q);q?(K-=this.runtime.draw_width*J/2,A-=this.runtime.draw_height*J/2):(K-=this.runtime.width*J/2,A-=this.runtime.height*J/2);K+=a*J;A+=c*J;c=this.getAngle();0!==c&&(K-=p,A-=w,a=Math.cos(c),c=Math.sin(c),q=K*a-A*c,A=A*a+K*c,K=
q+p,A+=w);return l?K:A};e.prototype.layerToCanvas=function(a,c,l,q){var p=this.runtime.parallax_x_origin,w=this.runtime.parallax_y_origin,K=(this.layout.scrollX-p)*this.parallaxX+p,A=(this.layout.scrollY-w)*this.parallaxY+w;w=K;p=A;var J=this.getAngle();if(0!==J){a-=K;c-=A;var R=Math.cos(-J);J=Math.sin(-J);var n=a*R-c*J;c=c*R+a*J;a=n+K;c+=A}K=1/this.getScale(!q);q?(w-=this.runtime.draw_width*K/2,p-=this.runtime.draw_height*K/2):(w-=this.runtime.width*K/2,p-=this.runtime.height*K/2);w=(a-w)/K;p=(c-
p)/K;a=this.runtime.devicePixelRatio;this.runtime.isRetina&&!q&&(w/=a,p/=a);return l?w:p};e.prototype.rotatePt=function(a,c,l){if(0===this.getAngle())return l?a:c;var q=this.layerToCanvas(a,c,!0);c=this.layerToCanvas(a,c,!1);this.disableAngle=!0;a=this.canvasToLayer(q,c,!0);q=this.canvasToLayer(q,c,!0);this.disableAngle=!1;return l?a:q};e.prototype.saveToJSON=function(){var a,c={s:this.scale,a:this.angle,vl:this.viewLeft,vt:this.viewTop,vr:this.viewRight,vb:this.viewBottom,v:this.visible,bc:this.background_color,
t:this.transparent,px:this.parallaxX,py:this.parallaxY,o:this.opacity,zr:this.zoomRate,fx:[],cg:this.created_globals,instances:[]};var l=0;for(a=this.effect_types.length;l<a;l++){var q=this.effect_types[l];c.fx.push({name:q.name,active:q.active,params:this.effect_params[q.index]})}return c};e.prototype.loadFromJSON=function(a){var c;this.scale=a.s;this.angle=a.a;this.viewLeft=a.vl;this.viewTop=a.vt;this.viewRight=a.vr;this.viewBottom=a.vb;this.visible=a.v;this.background_color=a.bc;this.transparent=
a.t;this.parallaxX=a.px;this.parallaxY=a.py;this.opacity=a.o;this.zoomRate=a.zr;this.created_globals=a.cg||[];cr.shallowAssignArray(this.initial_instances,this.startup_initial_instances);var l=new cr.ObjectSet;var q=0;for(c=this.created_globals.length;q<c;++q)l.add(this.created_globals[q]);var p=q=0;for(c=this.initial_instances.length;q<c;++q)l.contains(this.initial_instances[q][2])||(this.initial_instances[p]=this.initial_instances[q],++p);cr.truncateArray(this.initial_instances,p);p=a.fx;q=0;for(c=
p.length;q<c;q++)if(a=this.getEffectByName(p[q].name))a.active=p[q].active,this.effect_params[a.index]=p[q].params;this.updateActiveEffects();this.instances.sort(b);this.zindices_stale=!0};cr.layer=e})();
(function(){function b(k,a){this.runtime=k;this.event_sheet=null;this.scrollX=this.runtime.original_width/2;this.scrollY=this.runtime.original_height/2;this.scale=1;this.angle=0;this.first_visit=!0;this.name=a[0];this.originalWidth=a[1];this.originalHeight=a[2];this.width=a[1];this.height=a[2];this.unbounded_scrolling=a[3];this.sheetname=a[4];this.sid=a[5];var c=a[6],l;this.layers=[];this.initial_types=[];k=0;for(l=c.length;k<l;k++){var q=new cr.layer(this,c[k]);q.number=k;cr.seal(q);this.layers.push(q)}c=
a[7];this.initial_nonworld=[];k=0;for(l=c.length;k<l;k++){q=c[k];var p=this.runtime.types_by_index[q[1]];p.default_instance||(p.default_instance=q);this.initial_nonworld.push(q);-1===this.initial_types.indexOf(p)&&this.initial_types.push(p)}this.effect_types=[];this.active_effect_types=[];this.shaders_preserve_opaqueness=!0;this.effect_params=[];k=0;for(l=a[8].length;k<l;k++)this.effect_types.push({id:a[8][k][0],name:a[8][k][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:k}),this.effect_params.push(a[8][k][2].slice(0));
this.updateActiveEffects();this.rcTexBounce=new cr.rect(0,0,1,1);this.rcTexDest=new cr.rect(0,0,1,1);this.rcTexOrigin=new cr.rect(0,0,1,1);this.viewRect=new cr.rect(0,0,0,0);this.persist_data={}}function e(k,a){return k.zindex-a.zindex}function h(k){return k.some(function(a){return a.plugin.is_world})}b.prototype.saveObjectToPersist=function(k){var a=k.type.sid.toString();this.persist_data.hasOwnProperty(a)||(this.persist_data[a]=[]);this.persist_data[a].push(this.runtime.saveInstanceToJSON(k))};
b.prototype.hasOpaqueBottomLayer=function(){var k=this.layers[0];return!k.transparent&&1===k.opacity&&!k.forceOwnTexture&&k.visible};b.prototype.updateActiveEffects=function(){cr.clearArray(this.active_effect_types);this.shaders_preserve_opaqueness=!0;var k;var a=0;for(k=this.effect_types.length;a<k;a++){var c=this.effect_types[a];c.active&&(this.active_effect_types.push(c),c.preservesOpaqueness||(this.shaders_preserve_opaqueness=!1))}};b.prototype.getEffectByName=function(k){var a;var c=0;for(a=
this.effect_types.length;c<a;c++){var l=this.effect_types[c];if(l.name===k)return l}return null};var r=[],z=!0;b.prototype.startRunning=function(){this.sheetname&&(this.event_sheet=this.runtime.eventsheets[this.sheetname],this.event_sheet.updateDeepIncludes());this.runtime.running_layout=this;this.width=this.originalWidth;this.height=this.originalHeight;this.scrollX=this.runtime.original_width/2;this.scrollY=this.runtime.original_height/2;var k,a;var c=0;for(k=this.runtime.types_by_index.length;c<
k;c++){var l=this.runtime.types_by_index[c];if(!l.is_family){var q=l.instances;l=0;for(a=q.length;l<a;l++){var p=q[l];if(p.layer){var w=p.layer.number;w>=this.layers.length&&(w=this.layers.length-1);p.layer=this.layers[w];-1===p.layer.instances.indexOf(p)&&p.layer.instances.push(p);p.layer.zindices_stale=!0}}}}if(!z)for(c=0,k=this.layers.length;c<k;++c)this.layers[c].instances.sort(e);cr.clearArray(r);this.boundScrolling();c=0;for(k=this.layers.length;c<k;c++)p=this.layers[c],p.createInitialInstances(r),
p.updateViewport(null);q=!1;if(!this.first_visit){for(K in this.persist_data)if(this.persist_data.hasOwnProperty(K)&&(l=this.runtime.getObjectTypeBySid(parseInt(K,10)))&&!l.is_family&&this.runtime.typeHasPersistBehavior(l)){a=this.persist_data[K];c=0;for(k=a.length;c<k;c++){p=null;if(l.plugin.is_world&&(p=this.getLayerBySid(a[c].w.l),!p))continue;p=this.runtime.createInstanceFromInit(l.default_instance,p,!1,0,0,!0);this.runtime.loadInstanceFromJSON(p,a[c]);q=!0;r.push(p)}cr.clearArray(a)}c=0;for(k=
this.layers.length;c<k;c++)this.layers[c].instances.sort(e),this.layers[c].zindices_stale=!0}q&&(this.runtime.ClearDeathRow(),this.runtime.refreshUidMap());this.createAndLinkContainerInstances(r);c=0;for(k=this.initial_nonworld.length;c<k;c++){var K=this.initial_nonworld[c];l=this.runtime.types_by_index[K[1]];l.is_contained||this.runtime.createInstanceFromInit(this.initial_nonworld[c],null,!0)}this.runtime.changelayout=null;this.runtime.ClearDeathRow();if(this.runtime.ctx)for(c=0,k=this.runtime.types_by_index.length;c<
k;c++)K=this.runtime.types_by_index[c],!K.is_family&&K.instances.length&&K.preloadCanvas2D&&K.preloadCanvas2D(this.runtime.ctx);if(this.runtime.isLoadingState)cr.shallowAssignArray(this.runtime.fireOnCreateAfterLoad,r);else for(c=0,k=r.length;c<k;c++)p=r[c],this.runtime.trigger(Object.getPrototypeOf(p.type.plugin).cnds.OnCreated,p);cr.clearArray(r);this.runtime.isLoadingState||this.runtime.trigger(cr.system_object.prototype.cnds.OnLayoutStart,null);this.first_visit=!1};b.prototype.createAndLinkContainerInstances=
function(k){var a,c;for(a=0;a<k.length;a++){var l=k[a];if(l.type.is_contained){var q=l.get_iid();var p=0;for(c=l.type.container.length;p<c;p++){var w=l.type.container[p];if(l.type!==w)if(w.instances.length>q)l.siblings.push(w.instances[q]);else if(w.default_instance){var K=this.runtime.createInstanceFromInit(w.default_instance,l.layer,!0,l.x,l.y,!0);this.runtime.ClearDeathRow();w.updateIIDs();l.siblings.push(K);k.push(K)}}}}};b.prototype.createGlobalNonWorlds=function(){var k,a,c=[];var l=k=0;for(a=
this.initial_nonworld.length;k<a;k++){var q=this.initial_nonworld[k];var p=this.runtime.types_by_index[q[1]];p.global?p.is_contained&&h(p.container)||c.push(this.runtime.createInstanceFromInit(q,null,!0)):(this.initial_nonworld[l]=q,l++)}cr.truncateArray(this.initial_nonworld,l);this.runtime.ClearDeathRow();this.createAndLinkContainerInstances(c)};b.prototype.stopRunning=function(){this.runtime.isLoadingState||this.runtime.trigger(cr.system_object.prototype.cnds.OnLayoutEnd,null);this.runtime.isEndingLayout=
!0;cr.clearArray(this.runtime.system.waits);var k,a;if(!this.first_visit){var c=0;for(k=this.layers.length;c<k;c++){this.layers[c].updateZIndices();var l=this.layers[c].instances;var q=0;for(a=l.length;q<a;q++){var p=l[q];p.type.global||this.runtime.typeHasPersistBehavior(p.type)&&this.saveObjectToPersist(p)}}}c=0;for(k=this.layers.length;c<k;c++){l=this.layers[c].instances;q=0;for(a=l.length;q<a;q++)p=l[q],p.type.global||this.runtime.DestroyInstance(p);this.runtime.ClearDeathRow();cr.clearArray(l);
this.layers[c].zindices_stale=!0}c=0;for(k=this.runtime.types_by_index.length;c<k;c++)if(l=this.runtime.types_by_index[c],!(l.global||l.plugin.is_world||l.plugin.singleglobal||l.is_family)){q=0;for(a=l.instances.length;q<a;q++)this.runtime.DestroyInstance(l.instances[q]);this.runtime.ClearDeathRow()}z=!1;this.runtime.isEndingLayout=!1};var N=new cr.rect(0,0,0,0);b.prototype.recreateInitialObjects=function(k,a,c,l,q){N.set(a,c,l,q);a=0;for(c=this.layers.length;a<c;a++)this.layers[a].recreateInitialObjects(k,
N)};b.prototype.draw=function(k){var a=k,c=!1,l=!this.runtime.fullscreenScalingQuality;if(l){if(!this.runtime.layout_canvas){this.runtime.layout_canvas=document.createElement("canvas");var q=this.runtime.layout_canvas;q.width=this.runtime.draw_width;q.height=this.runtime.draw_height;this.runtime.layout_ctx=q.getContext("2d");c=!0}q=this.runtime.layout_canvas;a=this.runtime.layout_ctx;q.width!==this.runtime.draw_width&&(q.width=this.runtime.draw_width,c=!0);q.height!==this.runtime.draw_height&&(q.height=
this.runtime.draw_height,c=!0);c&&(a.imageSmoothingEnabled=this.runtime.linearSampling)}a.globalAlpha=1;a.globalCompositeOperation="source-over";this.runtime.clearBackground&&!this.hasOpaqueBottomLayer()&&a.clearRect(0,0,this.runtime.draw_width,this.runtime.draw_height);var p;c=0;for(p=this.layers.length;c<p;c++){var w=this.layers[c];w.visible&&0<w.opacity&&11!==w.blend_mode&&(w.instances.length||!w.transparent)?w.draw(a):w.updateViewport(null)}l&&k.drawImage(q,0,0,this.runtime.width,this.runtime.height)};
b.prototype.drawGL_earlyZPass=function(k){k.setEarlyZPass(!0);this.runtime.layout_tex||(this.runtime.layout_tex=k.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layout_tex.c2width!==this.runtime.draw_width||this.runtime.layout_tex.c2height!==this.runtime.draw_height)k.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=k.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);k.setRenderingToTexture(this.runtime.layout_tex);
this.runtime.fullscreenScalingQuality||k.setSize(this.runtime.draw_width,this.runtime.draw_height);var a;for(a=this.layers.length-1;0<=a;--a){var c=this.layers[a];c.visible&&1===c.opacity&&c.shaders_preserve_opaqueness&&0===c.blend_mode&&(c.instances.length||!c.transparent)?c.drawGL_earlyZPass(k):c.updateViewport(null)}k.setEarlyZPass(!1)};b.prototype.drawGL=function(k){var a=0<this.active_effect_types.length||this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality||this.runtime.enableFrontToBack;
if(a){this.runtime.layout_tex||(this.runtime.layout_tex=k.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layout_tex.c2width!==this.runtime.draw_width||this.runtime.layout_tex.c2height!==this.runtime.draw_height)k.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=k.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);k.setRenderingToTexture(this.runtime.layout_tex);this.runtime.fullscreenScalingQuality||
k.setSize(this.runtime.draw_width,this.runtime.draw_height)}else this.runtime.layout_tex&&(k.setRenderingToTexture(null),k.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=null);this.runtime.clearBackground&&!this.hasOpaqueBottomLayer()&&k.clear(0,0,0,0);var c;var l=0;for(c=this.layers.length;l<c;l++){var q=this.layers[l];q.visible&&0<q.opacity&&(q.instances.length||!q.transparent)?q.drawGL(k):q.updateViewport(null)}a&&(0===this.active_effect_types.length||1===this.active_effect_types.length&&
this.runtime.fullscreenScalingQuality?(1===this.active_effect_types.length?(a=this.active_effect_types[0].index,l=this.calculateViewRect(),k.switchProgram(this.active_effect_types[0].shaderindex),k.setProgramParameters(null,1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,0,0,1,1,l.left,l.top,l.right,l.bottom,0,0,1,1,this.scale,this.angle,this.runtime.kahanTime.sum,this.effect_params[a]),k.programIsAnimated(this.active_effect_types[0].shaderindex)&&(this.runtime.redraw=!0)):k.switchProgram(0),
this.runtime.fullscreenScalingQuality||k.setSize(this.runtime.width,this.runtime.height),k.setRenderingToTexture(null),k.setDepthTestEnabled(!1),k.setOpacity(1),k.setTexture(this.runtime.layout_tex),k.setAlphaBlend(),k.resetModelView(),k.updateModelView(),a=this.runtime.width/2,l=this.runtime.height/2,k.quad(-a,l,a,l,a,-l,-a,-l),k.setTexture(null),k.setDepthTestEnabled(!0)):this.renderEffectChain(k,null,null,null))};b.prototype.getRenderTarget=function(){return 0<this.active_effect_types.length||
this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality||this.runtime.enableFrontToBack?this.runtime.layout_tex:null};b.prototype.getMinLayerScale=function(){var k=this.layers[0].getScale(),a;var c=1;for(a=this.layers.length;c<a;c++){var l=this.layers[c];(0!==l.parallaxX||0!==l.parallaxY)&&l.getScale()<k&&(k=l.getScale())}return k};b.prototype.scrollToX=function(k){if(!this.unbounded_scrolling){var a=this.runtime.draw_width*(1/this.getMinLayerScale())/2;k>this.width-a&&(k=this.width-
a);k<a&&(k=a)}this.scrollX!==k&&(this.scrollX=k,this.runtime.redraw=!0)};b.prototype.scrollToY=function(k){if(!this.unbounded_scrolling){var a=this.runtime.draw_height*(1/this.getMinLayerScale())/2;k>this.height-a&&(k=this.height-a);k<a&&(k=a)}this.scrollY!==k&&(this.scrollY=k,this.runtime.redraw=!0)};b.prototype.boundScrolling=function(){this.scrollToX(this.scrollX);this.scrollToY(this.scrollY)};b.prototype.calculateViewRect=function(){var k=this.scrollX,a=this.scrollY,c=1/(this.scale*this.runtime.aspect_scale);
k-=this.runtime.width*c/2;a-=this.runtime.height*c/2;this.viewRect.set(k,a,k+this.runtime.draw_width*c,a+this.runtime.draw_height*c);return this.viewRect};b.prototype.renderEffectChain=function(k,a,c,l){var q=c?c.active_effect_types:a?a.active_effect_types:this.active_effect_types;if(c){var p=c.layer.getScale();var w=c.layer.getAngle();var K=c.layer.viewLeft;var A=c.layer.viewTop;var J=c.layer.viewRight;var R=c.layer.viewBottom}else a?(p=a.getScale(),w=a.getAngle(),K=a.viewLeft,A=a.viewTop,J=a.viewRight,
R=a.viewBottom):(p=this.scale,w=this.angle,R=this.calculateViewRect(),K=R.left,A=R.top,J=R.right,R=R.bottom);var n=this.runtime.fx_tex,x,E,V=0,Z=1,M=this.runtime.draw_width,d=this.runtime.draw_height,m=M/2,G=d/2,f=a?a.rcTexBounce:this.rcTexBounce,y=a?a.rcTexDest:this.rcTexDest,L=a?a.rcTexOrigin:this.rcTexOrigin,P=0,X=0,ba=0,aa=0,ca=M,ja=M,ha=d,g=d,u=E=0,D=c?c.layer.getAngle():0;if(c){var I=0;for(x=q.length;I<x;I++)E+=k.getProgramBoxExtendHorizontal(q[I].shaderindex),u+=k.getProgramBoxExtendVertical(q[I].shaderindex);
aa=c.bbox;P=a.layerToCanvas(aa.left,aa.top,!0,!0);ba=a.layerToCanvas(aa.left,aa.top,!1,!0);ca=a.layerToCanvas(aa.right,aa.bottom,!0,!0);ha=a.layerToCanvas(aa.right,aa.bottom,!1,!0);if(0!==D){I=a.layerToCanvas(aa.right,aa.top,!0,!0);x=a.layerToCanvas(aa.right,aa.top,!1,!0);X=a.layerToCanvas(aa.left,aa.bottom,!0,!0);aa=a.layerToCanvas(aa.left,aa.bottom,!1,!0);var B=Math.min(P,ca,I,X);ca=Math.max(P,ca,I,X);P=B;B=Math.min(ba,ha,x,aa);ha=Math.max(ba,ha,x,aa);ba=B}L.left=P/M;L.top=1-ba/d;L.right=ca/M;L.bottom=
1-ha/d;P-=E;ba-=u;ca+=E;ha+=u;y.left=P/M;y.top=1-ba/d;y.right=ca/M;y.bottom=1-ha/d;X=P=cr.floor(P);aa=ba=cr.floor(ba);ja=ca=cr.ceil(ca);g=ha=cr.ceil(ha);X-=E;aa-=u;ja+=E;g+=u;0>P&&(P=0);0>ba&&(ba=0);ca>M&&(ca=M);ha>d&&(ha=d);0>X&&(X=0);0>aa&&(aa=0);ja>M&&(ja=M);g>d&&(g=d);f.left=P/M;f.top=1-ba/d;f.right=ca/M;f.bottom=1-ha/d}else f.left=y.left=L.left=0,f.top=y.top=L.top=0,f.right=y.right=L.right=1,f.bottom=y.bottom=1;u=c&&(k.programUsesDest(q[0].shaderindex)||0!==E||0!==u||1!==c.opacity||c.type.plugin.must_predraw)||
a&&!c&&1!==a.opacity;k.setAlphaBlend();if(u){n[V]||(n[V]=k.createEmptyTexture(M,d,this.runtime.linearSampling));if(n[V].c2width!==M||n[V].c2height!==d)k.deleteTexture(n[V]),n[V]=k.createEmptyTexture(M,d,this.runtime.linearSampling);k.switchProgram(0);k.setRenderingToTexture(n[V]);var t=g-aa;k.clearRect(X,d-aa-t,ja-X,t);c?c.drawGL(k):(k.setTexture(this.runtime.layer_tex),k.setOpacity(a.opacity),k.resetModelView(),k.translate(-m,-G),k.updateModelView(),k.quadTex(P,ha,ca,ha,ca,ba,P,ba,f));y.left=y.top=
0;y.right=y.bottom=1;c&&(B=f.top,f.top=f.bottom,f.bottom=B);V=1;Z=0}k.setOpacity(1);E=q.length-1;D=k.programUsesCrossSampling(q[E].shaderindex)||!a&&!c&&!this.runtime.fullscreenScalingQuality;I=0;for(x=q.length;I<x;I++){n[V]||(n[V]=k.createEmptyTexture(M,d,this.runtime.linearSampling));if(n[V].c2width!==M||n[V].c2height!==d)k.deleteTexture(n[V]),n[V]=k.createEmptyTexture(M,d,this.runtime.linearSampling);k.switchProgram(q[I].shaderindex);B=q[I].index;k.programIsAnimated(q[I].shaderindex)&&(this.runtime.redraw=
!0);if(0!=I||u){k.setProgramParameters(l,1/M,1/d,0,0,1,1,L.left,L.top,L.right,L.bottom,K,A,J,R,y.left,y.top,y.right,y.bottom,p,w,this.runtime.kahanTime.sum,c?c.effect_params[B]:a?a.effect_params[B]:this.effect_params[B]);k.setTexture(null);if(I!==E||D){k.setRenderingToTexture(n[V]);t=g-aa;var C=d-aa-t;k.clearRect(X,C,ja-X,t)}else c?k.setBlend(c.srcBlend,c.destBlend):a&&k.setBlend(a.srcBlend,a.destBlend),k.setRenderingToTexture(l);k.setTexture(n[Z]);k.resetModelView();k.translate(-m,-G);k.updateModelView();
k.quadTex(P,ha,ca,ha,ca,ba,P,ba,f);I!==E||D||k.setTexture(null)}else{k.setRenderingToTexture(n[V]);t=g-aa;C=d-aa-t;k.clearRect(X,C,ja-X,t);if(c){C=Z=0;var F=t=1,O=1/c.width,W=1/c.height;c.curFrame&&c.curFrame.sheetTex&&(Z=c.curFrame.sheetTex.left,C=c.curFrame.sheetTex.top,t=c.curFrame.sheetTex.right,F=c.curFrame.sheetTex.bottom,c.curFrame.texture_img&&(O=1/c.curFrame.texture_img.width,W=1/c.curFrame.texture_img.height));k.setProgramParameters(l,O,W,Z,C,t,F,Z,C,t,F,c.bbox.left,c.bbox.top,c.bbox.right,
c.bbox.bottom,y.left,y.top,y.right,y.bottom,p,w,this.runtime.kahanTime.sum,c.effect_params[B]);c.drawGL(k)}else k.setProgramParameters(l,1/M,1/d,0,0,1,1,0,0,1,1,K,A,J,R,0,0,1,1,p,w,this.runtime.kahanTime.sum,a?a.effect_params[B]:this.effect_params[B]),k.setTexture(a?this.runtime.layer_tex:this.runtime.layout_tex),k.resetModelView(),k.translate(-m,-G),k.updateModelView(),k.quadTex(P,ha,ca,ha,ca,ba,P,ba,f);y.left=y.top=0;y.right=y.bottom=1;c&&!D&&(B=ha,ha=ba,ba=B)}V=0===V?1:0;Z=0===V?1:0}D&&(k.switchProgram(0),
c?k.setBlend(c.srcBlend,c.destBlend):a?k.setBlend(a.srcBlend,a.destBlend):this.runtime.fullscreenScalingQuality||(k.setSize(this.runtime.width,this.runtime.height),m=this.runtime.width/2,G=this.runtime.height/2,ba=P=0,ca=this.runtime.width,ha=this.runtime.height),k.setRenderingToTexture(l),k.setTexture(n[Z]),k.resetModelView(),k.translate(-m,-G),k.updateModelView(),c&&1===q.length&&!u?k.quadTex(P,ba,ca,ba,ca,ha,P,ha,f):k.quadTex(P,ha,ca,ha,ca,ba,P,ba,f),k.setTexture(null))};b.prototype.getLayerBySid=
function(k){var a;var c=0;for(a=this.layers.length;c<a;c++)if(this.layers[c].sid===k)return this.layers[c];return null};b.prototype.saveToJSON=function(){var k,a={sx:this.scrollX,sy:this.scrollY,s:this.scale,a:this.angle,w:this.width,h:this.height,fv:this.first_visit,persist:this.persist_data,fx:[],layers:{}};var c=0;for(k=this.effect_types.length;c<k;c++){var l=this.effect_types[c];a.fx.push({name:l.name,active:l.active,params:this.effect_params[l.index]})}c=0;for(k=this.layers.length;c<k;c++)l=
this.layers[c],a.layers[l.sid.toString()]=l.saveToJSON();return a};b.prototype.loadFromJSON=function(k){var a,c,l;this.scrollX=k.sx;this.scrollY=k.sy;this.scale=k.s;this.angle=k.a;this.width=k.w;this.height=k.h;this.persist_data=k.persist;"undefined"!==typeof k.fv&&(this.first_visit=k.fv);var q=k.fx;var p=0;for(a=q.length;p<a;p++)if(c=this.getEffectByName(q[p].name))c.active=q[p].active,this.effect_params[c.index]=q[p].params;this.updateActiveEffects();p=k.layers;for(l in p)p.hasOwnProperty(l)&&(k=
this.getLayerBySid(parseInt(l,10)))&&k.loadFromJSON(p[l])};cr.layout=b})();
(function(){function b(n,x){var E,V=n.length;switch(V){case 0:return!0;case 1:return n[0]===x[0];case 2:return n[0]===x[0]&&n[1]===x[1];default:for(E=0;E<V;E++)if(n[E]!==x[E])return!1;return!0}}function e(n,x){return n.index-x.index}function h(n){var x;if(2===n.length){if(n[0].index>n[1].index){var E=n[0];n[0]=n[1];n[1]=E}}else 2<n.length&&n.sort(e);n.length>=A.length&&(A.length=n.length+1);A[n.length]||(A[n.length]=[]);var V=A[n.length];E=0;for(x=V.length;E<x;E++){var Z=V[E];if(b(n,Z))return Z}V.push(n);
return n}function r(n,x){this.runtime=n;this.triggers={};this.fasttriggers={};this.hasRun=!1;this.includes=new cr.ObjectSet;this.deep_includes=[];this.already_included_sheets=[];this.name=x[0];n=x[1];this.events=[];var E;x=0;for(E=n.length;x<E;x++)this.init_event(n[x],null,this.events)}function z(n){this.type=n;this.instances=[];this.else_instances=[];this.select_all=!0}function N(n,x,E){this.sheet=n;this.parent=x;this.runtime=n.runtime;this.solModifiers=[];this.solModifiersIncludingParents=[];this.has_else_block=
this.toplevelgroup=this.toplevelevent=this.initially_activated=this.group=this.solWriterAfterCnds=!1;this.conditions=[];this.actions=[];this.subevents=[];this.group_name="";this.group_active=this.initially_activated=this.group=!1;this.contained_includes=null;3===E[0]&&(this.group_name=E[1][1].toLowerCase(),this.group=!0,this.initially_activated=!!E[1][0],this.contained_includes=[],this.group_active=this.initially_activated,this.runtime.allGroups.push(this),this.runtime.groups_by_name[this.group_name]=
this);this.orblock=E[2];this.sid=E[4];this.group||(this.runtime.blocksBySid[this.sid.toString()]=this);var V=E[6];n=0;for(x=V.length;n<x;n++){var Z=new cr.condition(this,V[n]);Z.index=n;cr.seal(Z);this.conditions.push(Z);this.addSolModifier(Z.type)}V=E[7];n=0;for(x=V.length;n<x;n++)Z=new cr.action(this,V[n]),Z.index=n,cr.seal(Z),this.actions.push(Z);if(9===E.length)for(E=E[8],n=0,x=E.length;n<x;n++)this.sheet.init_event(E[n],this,this.subevents);this.is_else_block=!1;this.conditions.length&&(this.is_else_block=
null==this.conditions[0].type&&this.conditions[0].func==cr.system_object.prototype.cnds.Else)}function k(n,x){var E;if(n&&(-1===x.indexOf(n)&&x.push(n),n.is_contained)){var V=0;for(E=n.container.length;V<E;V++){var Z=n.container[V];n!==Z&&-1===x.indexOf(Z)&&x.push(Z)}}}function a(n,x){this.block=n;this.sheet=n.sheet;this.runtime=n.runtime;this.parameters=[];this.results=[];this.extra={};this.index=-1;this.anyParamVariesPerInstance=!1;this.func=this.runtime.GetObjectReference(x[1]);this.trigger=0<
x[3];this.fasttrigger=2===x[3];this.looping=x[4];this.inverted=x[5];this.isstatic=x[6];this.sid=x[7];this.runtime.cndsBySid[this.sid.toString()]=this;-1===x[0]?(this.type=null,this.run=this.run_system,this.behaviortype=null,this.beh_index=-1):(this.type=this.runtime.types_by_index[x[0]],this.run=this.isstatic?this.run_static:this.run_object,x[2]?(this.behaviortype=this.type.getBehaviorByName(x[2]),this.beh_index=this.type.getBehaviorIndexByName(x[2])):(this.behaviortype=null,this.beh_index=-1),this.block.parent&&
this.block.parent.setSolWriterAfterCnds());this.fasttrigger&&(this.run=this.run_true);if(10===x.length){var E=x[9];n=0;for(x=E.length;n<x;n++){var V=new cr.parameter(this,E[n]);cr.seal(V);this.parameters.push(V)}this.results.length=E.length}}function c(n,x){this.block=n;this.sheet=n.sheet;this.runtime=n.runtime;this.parameters=[];this.results=[];this.extra={};this.index=-1;this.anyParamVariesPerInstance=!1;this.func=this.runtime.GetObjectReference(x[1]);-1===x[0]?(this.type=null,this.run=this.run_system,
this.behaviortype=null,this.beh_index=-1):(this.type=this.runtime.types_by_index[x[0]],this.run=this.run_object,x[2]?(this.behaviortype=this.type.getBehaviorByName(x[2]),this.beh_index=this.type.getBehaviorIndexByName(x[2])):(this.behaviortype=null,this.beh_index=-1));this.sid=x[3];this.runtime.actsBySid[this.sid.toString()]=this;if(7===x.length){var E=x[6];n=0;for(x=E.length;n<x;n++){var V=new cr.parameter(this,E[n]);cr.seal(V);this.parameters.push(V)}this.results.length=E.length}}function l(){R++;
J.length===R&&J.push(new cr.expvalue);return J[R]}function q(n,x){this.owner=n;this.block=n.block;this.sheet=n.sheet;this.runtime=n.runtime;this.type=x[0];this.expression=null;this.solindex=0;this.get=null;this.combosel=0;this.layout=null;this.key=0;this.object=null;this.index=0;this.variadicret=this.subparams=this.fileinfo=this.eventvar=this.varname=null;this.variesPerInstance=!1;var E;switch(this.type){case 0:case 7:this.expression=new cr.expNode(this,x[1]);this.solindex=0;this.get=this.get_exp;
break;case 1:case 14:this.expression=new cr.expNode(this,x[1]);this.solindex=0;this.get=this.get_exp_str;14===this.type&&(this.block.setAllSolModifiers(),this.owner instanceof cr.action&&this.block.setSolWriterAfterCnds());break;case 5:this.expression=new cr.expNode(this,x[1]);this.solindex=0;this.get=this.get_layer;break;case 3:case 8:this.combosel=x[1];this.get=this.get_combosel;break;case 16:this.combosel=x[1]?1:0;this.get=this.get_boolean;break;case 6:this.layout=this.runtime.layouts[x[1]];this.get=
this.get_layout;break;case 9:this.key=x[1];this.get=this.get_key;break;case 4:this.object=this.runtime.types_by_index[x[1]];this.get=this.get_object;this.block.addSolModifier(this.object);this.owner instanceof cr.action?this.block.setSolWriterAfterCnds():this.block.parent&&this.block.parent.setSolWriterAfterCnds();break;case 10:this.index=x[1];n.type&&n.type.is_family?(this.get=this.get_familyvar,this.variesPerInstance=!0):this.get=this.get_instvar;break;case 11:this.varname=x[1];this.eventvar=null;
this.get=this.get_eventvar;break;case 2:case 12:this.fileinfo=x[1];this.get=this.get_audiofile;break;case 13:for(this.get=this.get_variadic,this.subparams=[],this.variadicret=[],n=1,E=x.length;n<E;n++){var V=new cr.parameter(this.owner,x[n]);cr.seal(V);this.subparams.push(V);this.variadicret.push(0)}}}function p(n,x,E){this.sheet=n;this.parent=x;this.runtime=n.runtime;this.solModifiers=[];this.name=E[1];this.vartype=E[2];this.initial=E[3];this.is_static=!!E[4];this.is_constant=!!E[5];this.sid=E[6];
this.runtime.varsBySid[this.sid.toString()]=this;this.data=this.initial;this.parent?(this.localIndex=this.is_static||this.is_constant?-1:this.runtime.stackLocalCount++,this.runtime.all_local_vars.push(this)):(this.localIndex=-1,this.runtime.all_global_vars.push(this))}function w(n,x,E){this.sheet=n;this.parent=x;this.runtime=n.runtime;this.solModifiers=[];this.include_sheet=null;this.include_sheet_name=E[1];this.active=!0}function K(){this.temp_parents_arr=[];this.reset(null);cr.seal(this)}var A=
[];r.prototype.toString=function(){return this.name};r.prototype.init_event=function(n,x,E){switch(n[0]){case 0:case 3:n=new cr.eventblock(this,x,n);cr.seal(n);if(n.orblock)for(E.push(n),E=0,x=n.conditions.length;E<x;E++)n.conditions[E].trigger&&this.init_trigger(n,E);else n.is_trigger()?this.init_trigger(n,0):E.push(n);break;case 1:n=new cr.eventvariable(this,x,n);cr.seal(n);E.push(n);break;case 2:n=new cr.eventinclude(this,x,n),cr.seal(n),E.push(n)}};r.prototype.postInit=function(){var n;var x=
0;for(n=this.events.length;x<n;x++)this.events[x].postInit(x<n-1&&this.events[x+1].is_else_block)};r.prototype.updateDeepIncludes=function(){cr.clearArray(this.deep_includes);cr.clearArray(this.already_included_sheets);this.addDeepIncludes(this);cr.clearArray(this.already_included_sheets)};r.prototype.addDeepIncludes=function(n){var x,E=n.deep_includes,V=n.already_included_sheets,Z=this.includes.valuesRef();var M=0;for(x=Z.length;M<x;++M){var d=Z[M];var m=d.include_sheet;!d.isActive()||n===m||-1<
V.indexOf(m)||(V.push(m),m.addDeepIncludes(n),E.push(m))}};r.prototype.run=function(n){this.runtime.resuming_breakpoint||(this.hasRun=!0,n||(this.runtime.isRunningEvents=!0));var x;var E=0;for(x=this.events.length;E<x;E++){var V=this.events[E];V.run();this.runtime.clearSol(V.solModifiers);this.runtime.hasPendingInstances&&this.runtime.ClearDeathRow()}n||(this.runtime.isRunningEvents=!1)};r.prototype.init_trigger=function(n,x){n.orblock||this.runtime.triggers_to_postinit.push(n);var E,V,Z=n.conditions[x];
var M=Z.type?Z.type.name:"system";var d=(E=Z.fasttrigger)?this.fasttriggers:this.triggers;d[M]||(d[M]=[]);M=d[M];d=Z.func;if(E){if(Z.parameters.length&&(Z=Z.parameters[0],1===Z.type&&2===Z.expression.type)){Z=Z.expression.value.toLowerCase();E=0;for(V=M.length;E<V;E++)if(M[E].method==d){E=M[E].evs;E[Z]?E[Z].push([n,x]):E[Z]=[[n,x]];return}E={};E[Z]=[[n,x]];M.push({method:d,evs:E})}}else{E=0;for(V=M.length;E<V;E++)if(M[E].method==d){M[E].evs.push([n,x]);return}Z=cr.plugins_.Sprite&&d===cr.plugins_.Sprite.prototype.cnds.OnFrameChanged?
!0:!1;Z?M.unshift({method:d,evs:[[n,x]]}):M.push({method:d,evs:[[n,x]]})}};cr.eventsheet=r;z.prototype.hasObjects=function(){return this.select_all?this.type.instances.length:this.instances.length};z.prototype.getObjects=function(){return this.select_all?this.type.instances:this.instances};z.prototype.pick_one=function(n){n&&(n.runtime.getCurrentEventStack().current_event.orblock?(this.select_all&&(cr.clearArray(this.instances),cr.shallowAssignArray(this.else_instances,n.type.instances),this.select_all=
!1),n=this.else_instances.indexOf(n),-1!==n&&(this.instances.push(this.else_instances[n]),this.else_instances.splice(n,1))):(this.select_all=!1,cr.clearArray(this.instances),this.instances[0]=n))};cr.selection=z;N.prototype.postInit=function(n){var x,E=this.parent;if(this.group)for(this.toplevelgroup=!0;E;){if(!E.group){this.toplevelgroup=!1;break}E=E.parent}this.toplevelevent=!this.is_trigger()&&(!this.parent||this.parent.group&&this.parent.toplevelgroup);this.has_else_block=!!n;E=this.runtime.types_by_index;
if(this.solModifiers===E)this.solModifiersIncludingParents=E;else{this.solModifiersIncludingParents=this.solModifiers.slice(0);for(E=this.parent;E;){n=0;for(x=E.solModifiers.length;n<x;n++)this.addParentSolModifier(E.solModifiers[n]);E=E.parent}this.solModifiers=h(this.solModifiers);this.solModifiersIncludingParents=h(this.solModifiersIncludingParents)}n=0;for(x=this.conditions.length;n<x;n++)this.conditions[n].postInit();n=0;for(x=this.actions.length;n<x;n++)this.actions[n].postInit();n=0;for(x=
this.subevents.length;n<x;n++)this.subevents[n].postInit(n<x-1&&this.subevents[n+1].is_else_block)};N.prototype.setGroupActive=function(n){if(this.group_active!==!!n){this.group_active=!!n;var x;n=0;for(x=this.contained_includes.length;n<x;++n)this.contained_includes[n].updateActive();0<x&&this.runtime.running_layout.event_sheet&&this.runtime.running_layout.event_sheet.updateDeepIncludes()}};N.prototype.addSolModifier=function(n){k(n,this.solModifiers)};N.prototype.addParentSolModifier=function(n){k(n,
this.solModifiersIncludingParents)};N.prototype.setAllSolModifiers=function(){this.solModifiers=this.runtime.types_by_index};N.prototype.setSolWriterAfterCnds=function(){this.solWriterAfterCnds=!0;this.parent&&this.parent.setSolWriterAfterCnds()};N.prototype.is_trigger=function(){return this.conditions.length?this.conditions[0].trigger:!1};N.prototype.run=function(){var n,x=!1,E=this.runtime,V=this.runtime.getCurrentEventStack();V.current_event=this;var Z=this.conditions;this.is_else_block||(V.else_branch_ran=
!1);if(this.orblock){0===Z.length&&(x=!0);V.cndindex=0;for(n=Z.length;V.cndindex<n;V.cndindex++){var M=Z[V.cndindex];M.trigger||(M=M.run())&&(x=!0)}(V.last_event_true=x)&&this.run_actions_and_subevents()}else{V.cndindex=0;for(n=Z.length;V.cndindex<n;V.cndindex++)if(M=Z[V.cndindex].run(),!M){V.last_event_true=!1;this.toplevelevent&&E.hasPendingInstances&&E.ClearDeathRow();return}V.last_event_true=!0;this.run_actions_and_subevents()}this.end_run(V)};N.prototype.end_run=function(n){n.last_event_true&&
this.has_else_block&&(n.else_branch_ran=!0);this.toplevelevent&&this.runtime.hasPendingInstances&&this.runtime.ClearDeathRow()};N.prototype.run_orblocktrigger=function(n){this.runtime.getCurrentEventStack().current_event=this;this.conditions[n].run()&&(this.run_actions_and_subevents(),this.runtime.getCurrentEventStack().last_event_true=!0)};N.prototype.run_actions_and_subevents=function(){var n=this.runtime.getCurrentEventStack(),x;n.actindex=0;for(x=this.actions.length;n.actindex<x;n.actindex++)if(this.actions[n.actindex].run())return;
this.run_subevents()};N.prototype.resume_actions_and_subevents=function(){var n=this.runtime.getCurrentEventStack(),x;for(x=this.actions.length;n.actindex<x;n.actindex++)if(this.actions[n.actindex].run())return;this.run_subevents()};N.prototype.run_subevents=function(){if(this.subevents.length){var n,x,E=this.subevents.length-1;this.runtime.pushEventStack(this);if(this.solWriterAfterCnds){var V=0;for(n=this.subevents.length;V<n;V++){var Z=this.subevents[V];(x=!this.toplevelgroup||!this.group&&V<E)&&
this.runtime.pushCopySol(Z.solModifiers);Z.run();x?this.runtime.popSol(Z.solModifiers):this.runtime.clearSol(Z.solModifiers)}}else for(V=0,n=this.subevents.length;V<n;V++)this.subevents[V].run();this.runtime.popEventStack()}};N.prototype.run_pretrigger=function(){var n=this.runtime.getCurrentEventStack();n.current_event=this;var x=!1,E;n.cndindex=0;for(E=this.conditions.length;n.cndindex<E;n.cndindex++)if(this.conditions[n.cndindex].run())x=!0;else if(!this.orblock)return!1;return this.orblock?x:
!0};N.prototype.retrigger=function(){this.runtime.execcount++;var n=this.runtime.getCurrentEventStack().cndindex,x=this.runtime.pushEventStack(this);if(!this.orblock)for(x.cndindex=n+1,n=this.conditions.length;x.cndindex<n;x.cndindex++)if(!this.conditions[x.cndindex].run())return this.runtime.popEventStack(),!1;this.run_actions_and_subevents();this.runtime.popEventStack();return!0};N.prototype.isFirstConditionOfType=function(n){var x=n.index;if(0===x)return!0;for(--x;0<=x;--x)if(this.conditions[x].type===
n.type)return!1;return!0};cr.eventblock=N;a.prototype.postInit=function(){var n;var x=0;for(n=this.parameters.length;x<n;x++){var E=this.parameters[x];E.postInit();E.variesPerInstance&&(this.anyParamVariesPerInstance=!0)}};a.prototype.run_true=function(){return!0};a.prototype.run_system=function(){var n;var x=0;for(n=this.parameters.length;x<n;x++)this.results[x]=this.parameters[x].get();return cr.xor(this.func.apply(this.runtime.system,this.results),this.inverted)};a.prototype.run_static=function(){var n;
var x=0;for(n=this.parameters.length;x<n;x++)this.results[x]=this.parameters[x].get();x=this.func.apply(this.behaviortype?this.behaviortype:this.type,this.results);this.type.applySolToContainer();return x};a.prototype.run_object=function(){var n,x,E,V=this.type,Z=V.getCurrentSol(),M=this.block.orblock&&!this.trigger,d=V.is_contained,m=V.is_family,G=V.family_index,f=this.beh_index,y=-1<f,L=this.anyParamVariesPerInstance,P=this.parameters,X=this.results,ba=this.inverted,aa=this.func;if(L){var ca=0;
for(x=P.length;ca<x;++ca){var ja=P[ca];ja.variesPerInstance||(X[ca]=ja.get(0))}}else for(ca=0,x=P.length;ca<x;++ca)X[ca]=P[ca].get(0);if(Z.select_all){cr.clearArray(Z.instances);cr.clearArray(Z.else_instances);var ha=V.instances;var g=0;for(n=ha.length;g<n;++g){var u=ha[g];if(L)for(ca=0,x=P.length;ca<x;++ca)ja=P[ca],ja.variesPerInstance&&(X[ca]=ja.get(g));y?(ca=0,m&&(ca=u.type.family_beh_map[G]),ca=aa.apply(u.behavior_insts[f+ca],X)):ca=aa.apply(u,X);(E=cr.xor(ca,ba))?Z.instances.push(u):M&&Z.else_instances.push(u)}V.finish&&
V.finish(!0);Z.select_all=!1;V.applySolToContainer();return Z.hasObjects()}var D=0;ha=(E=M&&!this.block.isFirstConditionOfType(this))?Z.else_instances:Z.instances;var I=!1;g=0;for(n=ha.length;g<n;++g){u=ha[g];if(L)for(ca=0,x=P.length;ca<x;++ca)ja=P[ca],ja.variesPerInstance&&(X[ca]=ja.get(g));y?(ca=0,m&&(ca=u.type.family_beh_map[G]),ca=aa.apply(u.behavior_insts[f+ca],X)):ca=aa.apply(u,X);if(cr.xor(ca,ba))if(I=!0,E){if(Z.instances.push(u),d)for(ca=0,x=u.siblings.length;ca<x;ca++)ja=u.siblings[ca],ja.type.getCurrentSol().instances.push(ja)}else{ha[D]=
u;if(d)for(ca=0,x=u.siblings.length;ca<x;ca++)ja=u.siblings[ca],ja.type.getCurrentSol().instances[D]=ja;D++}else if(E){ha[D]=u;if(d)for(ca=0,x=u.siblings.length;ca<x;ca++)ja=u.siblings[ca],ja.type.getCurrentSol().else_instances[D]=ja;D++}else if(M&&(Z.else_instances.push(u),d))for(ca=0,x=u.siblings.length;ca<x;ca++)ja=u.siblings[ca],ja.type.getCurrentSol().else_instances.push(ja)}cr.truncateArray(ha,D);if(d)for(m=V.container,g=0,n=m.length;g<n;g++)u=m[g].getCurrentSol(),E?cr.truncateArray(u.else_instances,
D):cr.truncateArray(u.instances,D);D=I;if(E&&!I)for(g=0,n=Z.instances.length;g<n;g++){u=Z.instances[g];if(L)for(ca=0,x=P.length;ca<x;ca++)ja=P[ca],ja.variesPerInstance&&(X[ca]=ja.get(g));ca=y?aa.apply(u.behavior_insts[f],X):aa.apply(u,X);if(cr.xor(ca,ba)){I=!0;break}}V.finish&&V.finish(D||M);return M?I:Z.hasObjects()};cr.condition=a;c.prototype.postInit=function(){var n;var x=0;for(n=this.parameters.length;x<n;x++){var E=this.parameters[x];E.postInit();E.variesPerInstance&&(this.anyParamVariesPerInstance=
!0)}};c.prototype.run_system=function(){var n=this.runtime,x,E=this.parameters,V=this.results;var Z=0;for(x=E.length;Z<x;++Z)V[Z]=E[Z].get();return this.func.apply(n.system,V)};c.prototype.run_object=function(){var n=this.type,x=this.beh_index,E=n.family_index,V=this.anyParamVariesPerInstance,Z=this.parameters,M=this.results,d=this.func,m=n.getCurrentSol().getObjects();n=n.is_family;var G=-1<x,f,y;if(V){var L=0;for(y=Z.length;L<y;++L){var P=Z[L];P.variesPerInstance||(M[L]=P.get(0))}}else for(L=0,
y=Z.length;L<y;++L)M[L]=Z[L].get(0);var X=0;for(f=m.length;X<f;++X){var ba=m[X];if(V)for(L=0,y=Z.length;L<y;++L)P=Z[L],P.variesPerInstance&&(M[L]=P.get(X));G?(L=0,n&&(L=ba.type.family_beh_map[E]),d.apply(ba.behavior_insts[x+L],M)):d.apply(ba,M)}return!1};cr.action=c;var J=[],R=-1;q.prototype.postInit=function(){var n;if(11===this.type)this.eventvar=this.runtime.getEventVariableByName(this.varname,this.block.parent);else if(13===this.type){var x=0;for(n=this.subparams.length;x<n;x++)this.subparams[x].postInit()}this.expression&&
this.expression.postInit()};q.prototype.maybeVaryForType=function(n){this.variesPerInstance||!n||n.plugin.singleglobal||(this.variesPerInstance=!0)};q.prototype.setVaries=function(){this.variesPerInstance=!0};q.prototype.get_exp=function(n){this.solindex=n||0;n=l();this.expression.get(n);R--;return n.data};q.prototype.get_exp_str=function(n){this.solindex=n||0;n=l();this.expression.get(n);R--;return cr.is_string(n.data)?n.data:""};q.prototype.get_object=function(){return this.object};q.prototype.get_combosel=
function(){return this.combosel};q.prototype.get_boolean=function(){return!!this.combosel};q.prototype.get_layer=function(n){this.solindex=n||0;n=l();this.expression.get(n);R--;return n.is_number()?this.runtime.getLayerByNumber(n.data):this.runtime.getLayerByName(n.data)};q.prototype.get_layout=function(){return this.layout};q.prototype.get_key=function(){return this.key};q.prototype.get_instvar=function(){return this.index};q.prototype.get_familyvar=function(n){var x=n||0;n=this.owner.type;var E=
n.getCurrentSol(),V=E.getObjects();if(V.length)x=V[x%V.length].type;else if(E.else_instances.length)x=E.else_instances[x%E.else_instances.length].type;else if(n.instances.length)x=n.instances[x%n.instances.length].type;else return 0;return this.index+x.family_var_map[n.family_index]};q.prototype.get_eventvar=function(){return this.eventvar};q.prototype.get_audiofile=function(){return this.fileinfo};q.prototype.get_variadic=function(){var n;var x=0;for(n=this.subparams.length;x<n;x++)this.variadicret[x]=
this.subparams[x].get();return this.variadicret};cr.parameter=q;p.prototype.postInit=function(){this.solModifiers=h(this.solModifiers)};p.prototype.setValue=function(n){var x=this.runtime.getCurrentLocalVarStack();this.parent&&!this.is_static&&x?(this.localIndex>=x.length&&(x.length=this.localIndex+1),x[this.localIndex]=n):this.data=n};p.prototype.getValue=function(){var n=this.runtime.getCurrentLocalVarStack();return!this.parent||this.is_static||!n||this.is_constant?this.data:this.localIndex>=n.length||
"undefined"===typeof n[this.localIndex]?this.initial:n[this.localIndex]};p.prototype.run=function(){!this.parent||this.is_static||this.is_constant||this.setValue(this.initial)};cr.eventvariable=p;w.prototype.toString=function(){return"include:"+this.include_sheet.toString()};w.prototype.postInit=function(){this.include_sheet=this.runtime.eventsheets[this.include_sheet_name];this.sheet.includes.add(this);this.solModifiers=h(this.solModifiers);for(var n=this.parent;n;)n.group&&n.contained_includes.push(this),
n=n.parent;this.updateActive()};w.prototype.run=function(){this.parent&&this.runtime.pushCleanSol(this.runtime.types_by_index);this.include_sheet.hasRun||this.include_sheet.run(!0);this.parent&&this.runtime.popSol(this.runtime.types_by_index)};w.prototype.updateActive=function(){for(var n=this.parent;n;){if(n.group&&!n.group_active){this.active=!1;return}n=n.parent}this.active=!0};w.prototype.isActive=function(){return this.active};cr.eventinclude=w;K.prototype.reset=function(n){this.current_event=
n;this.actindex=this.cndindex=0;cr.clearArray(this.temp_parents_arr);this.any_true_state=this.else_branch_ran=this.last_event_true=!1};K.prototype.isModifierAfterCnds=function(){return this.current_event.solWriterAfterCnds?!0:this.cndindex<this.current_event.conditions.length-1?!!this.current_event.solModifiers.length:!1};cr.eventStackFrame=K})();
(function(){function b(k,a){this.owner=k;this.runtime=k.runtime;this.type=a[0];this.get=[this.eval_int,this.eval_float,this.eval_string,this.eval_unaryminus,this.eval_add,this.eval_subtract,this.eval_multiply,this.eval_divide,this.eval_mod,this.eval_power,this.eval_and,this.eval_or,this.eval_equal,this.eval_notequal,this.eval_less,this.eval_lessequal,this.eval_greater,this.eval_greaterequal,this.eval_conditional,this.eval_system_exp,this.eval_object_exp,this.eval_instvar_exp,this.eval_behavior_exp,
this.eval_eventvar_exp][this.type];var c=null;this.object_type=this.parameters=this.results=this.func=this.third=this.second=this.first=this.value=null;this.beh_index=-1;this.instance_expr=null;this.varindex=-1;this.eventvar=this.varname=this.behavior_type=null;this.return_string=!1;switch(this.type){case 0:case 1:case 2:this.value=a[1];break;case 3:this.first=new cr.expNode(k,a[1]);break;case 18:this.first=new cr.expNode(k,a[1]);this.second=new cr.expNode(k,a[2]);this.third=new cr.expNode(k,a[3]);
break;case 19:this.func=this.runtime.GetObjectReference(a[1]);this.func!==cr.system_object.prototype.exps.random&&this.func!==cr.system_object.prototype.exps.choose||this.owner.setVaries();this.results=[];this.parameters=[];3===a.length?(c=a[2],this.results.length=c.length+1):this.results.length=1;break;case 20:this.object_type=this.runtime.types_by_index[a[1]];this.beh_index=-1;this.func=this.runtime.GetObjectReference(a[2]);this.return_string=a[3];cr.plugins_.Function&&this.func===cr.plugins_.Function.prototype.exps.Call&&
this.owner.setVaries();this.instance_expr=a[4]?new cr.expNode(k,a[4]):null;this.results=[];this.parameters=[];6===a.length?(c=a[5],this.results.length=c.length+1):this.results.length=1;break;case 21:this.object_type=this.runtime.types_by_index[a[1]];this.return_string=a[2];this.instance_expr=a[3]?new cr.expNode(k,a[3]):null;this.varindex=a[4];break;case 22:this.object_type=this.runtime.types_by_index[a[1]];this.behavior_type=this.object_type.getBehaviorByName(a[2]);this.beh_index=this.object_type.getBehaviorIndexByName(a[2]);
this.func=this.runtime.GetObjectReference(a[3]);this.return_string=a[4];this.instance_expr=a[5]?new cr.expNode(k,a[5]):null;this.results=[];this.parameters=[];7===a.length?(c=a[6],this.results.length=c.length+1):this.results.length=1;break;case 23:this.varname=a[1],this.eventvar=null}this.owner.maybeVaryForType(this.object_type);4<=this.type&&17>=this.type&&(this.first=new cr.expNode(k,a[1]),this.second=new cr.expNode(k,a[2]));if(c){var l;a=0;for(l=c.length;a<l;a++)this.parameters.push(new cr.expNode(k,
c[a]))}cr.seal(this)}function e(){++N;z.length===N&&z.push(new cr.expvalue);return z[N]}function h(k,a,c){var l;var q=0;for(l=k.length;q<l;++q)k[q].get(c),a[q+1]=c.data}function r(k,a){this.type=k||cr.exptype.Integer;this.data=a||0;this.object_class=null;this.type==cr.exptype.Integer&&(this.data=Math.floor(this.data));cr.seal(this)}b.prototype.postInit=function(){23===this.type&&(this.eventvar=this.owner.runtime.getEventVariableByName(this.varname,this.owner.block.parent));this.first&&this.first.postInit();
this.second&&this.second.postInit();this.third&&this.third.postInit();this.instance_expr&&this.instance_expr.postInit();if(this.parameters){var k;var a=0;for(k=this.parameters.length;a<k;a++)this.parameters[a].postInit()}};var z=[],N=-1;b.prototype.eval_system_exp=function(k){var a=this.parameters,c=this.results;c[0]=k;k=e();h(a,c,k);--N;this.func.apply(this.runtime.system,c)};b.prototype.eval_object_exp=function(k){var a=this.object_type,c=this.results,l=this.parameters,q=this.instance_expr,p=this.func,
w=this.owner.solindex,K=a.getCurrentSol(),A=K.getObjects();if(!A.length)if(K.else_instances.length)A=K.else_instances;else{this.return_string?k.set_string(""):k.set_int(0);return}c[0]=k;k.object_class=a;k=e();h(l,c,k);q&&(q.get(k),k.is_number()&&(w=k.data,A=a.instances));--N;a=A.length;if(w>=a||w<=-a)w%=a;0>w&&(w+=a);p.apply(A[w],c)};b.prototype.eval_behavior_exp=function(k){var a=this.object_type,c=this.results,l=this.parameters,q=this.instance_expr,p=this.beh_index,w=this.func,K=this.owner.solindex,
A=a.getCurrentSol(),J=A.getObjects();if(!J.length)if(A.else_instances.length)J=A.else_instances;else{this.return_string?k.set_string(""):k.set_int(0);return}c[0]=k;k.object_class=a;k=e();h(l,c,k);q&&(q.get(k),k.is_number()&&(K=k.data,J=a.instances));--N;l=J.length;if(K>=l||K<=-l)K%=l;0>K&&(K+=l);K=J[K];J=0;a.is_family&&(J=K.type.family_beh_map[a.family_index]);w.apply(K.behavior_insts[p+J],c)};b.prototype.eval_instvar_exp=function(k){var a=this.instance_expr,c=this.object_type,l=this.varindex,q=this.owner.solindex,
p=c.getCurrentSol(),w=p.getObjects();if(!w.length)if(p.else_instances.length)w=p.else_instances;else{this.return_string?k.set_string(""):k.set_int(0);return}if(a){p=e();a.get(p);if(p.is_number()){q=p.data;w=c.instances;0!==w.length&&(q%=w.length,0>q&&(q+=w.length));q=c.getInstanceByIID(q);c=q.instance_vars[l];cr.is_string(c)?k.set_string(c):k.set_float(c);--N;return}--N}a=w.length;if(q>=a||q<=-a)q%=a;0>q&&(q+=a);q=w[q];w=0;c.is_family&&(w=q.type.family_var_map[c.family_index]);c=q.instance_vars[l+
w];cr.is_string(c)?k.set_string(c):k.set_float(c)};b.prototype.eval_int=function(k){k.type=cr.exptype.Integer;k.data=this.value};b.prototype.eval_float=function(k){k.type=cr.exptype.Float;k.data=this.value};b.prototype.eval_string=function(k){k.type=cr.exptype.String;k.data=this.value};b.prototype.eval_unaryminus=function(k){this.first.get(k);k.is_number()&&(k.data=-k.data)};b.prototype.eval_add=function(k){this.first.get(k);var a=e();this.second.get(a);k.is_number()&&a.is_number()&&(k.data+=a.data,
a.is_float()&&k.make_float());--N};b.prototype.eval_subtract=function(k){this.first.get(k);var a=e();this.second.get(a);k.is_number()&&a.is_number()&&(k.data-=a.data,a.is_float()&&k.make_float());--N};b.prototype.eval_multiply=function(k){this.first.get(k);var a=e();this.second.get(a);k.is_number()&&a.is_number()&&(k.data*=a.data,a.is_float()&&k.make_float());--N};b.prototype.eval_divide=function(k){this.first.get(k);var a=e();this.second.get(a);k.is_number()&&a.is_number()&&(k.data/=a.data,k.make_float());
--N};b.prototype.eval_mod=function(k){this.first.get(k);var a=e();this.second.get(a);k.is_number()&&a.is_number()&&(k.data%=a.data,a.is_float()&&k.make_float());--N};b.prototype.eval_power=function(k){this.first.get(k);var a=e();this.second.get(a);k.is_number()&&a.is_number()&&(k.data=Math.pow(k.data,a.data),a.is_float()&&k.make_float());--N};b.prototype.eval_and=function(k){this.first.get(k);var a=e();this.second.get(a);a.is_string()||k.is_string()?this.eval_and_stringconcat(k,a):this.eval_and_logical(k,
a);--N};b.prototype.eval_and_stringconcat=function(k,a){k.is_string()&&a.is_string()?this.eval_and_stringconcat_str_str(k,a):this.eval_and_stringconcat_num(k,a)};b.prototype.eval_and_stringconcat_str_str=function(k,a){k.data+=a.data};b.prototype.eval_and_stringconcat_num=function(k,a){k.is_string()?k.data+=(Math.round(1E10*a.data)/1E10).toString():k.set_string(k.data.toString()+a.data)};b.prototype.eval_and_logical=function(k,a){k.set_int(k.data&&a.data?1:0)};b.prototype.eval_or=function(k){this.first.get(k);
var a=e();this.second.get(a);k.is_number()&&a.is_number()&&(k.data||a.data?k.set_int(1):k.set_int(0));--N};b.prototype.eval_conditional=function(k){this.first.get(k);k.data?this.second.get(k):this.third.get(k)};b.prototype.eval_equal=function(k){this.first.get(k);var a=e();this.second.get(a);k.set_int(k.data===a.data?1:0);--N};b.prototype.eval_notequal=function(k){this.first.get(k);var a=e();this.second.get(a);k.set_int(k.data!==a.data?1:0);--N};b.prototype.eval_less=function(k){this.first.get(k);
var a=e();this.second.get(a);k.set_int(k.data<a.data?1:0);--N};b.prototype.eval_lessequal=function(k){this.first.get(k);var a=e();this.second.get(a);k.set_int(k.data<=a.data?1:0);--N};b.prototype.eval_greater=function(k){this.first.get(k);var a=e();this.second.get(a);k.set_int(k.data>a.data?1:0);--N};b.prototype.eval_greaterequal=function(k){this.first.get(k);var a=e();this.second.get(a);k.set_int(k.data>=a.data?1:0);--N};b.prototype.eval_eventvar_exp=function(k){var a=this.eventvar.getValue();"number"===
typeof a?k.set_float(a):"boolean"===typeof a?k.set_int(a?1:0):k.set_string(a)};cr.expNode=b;r.prototype.is_int=function(){return this.type===cr.exptype.Integer};r.prototype.is_float=function(){return this.type===cr.exptype.Float};r.prototype.is_number=function(){return this.type===cr.exptype.Integer||this.type===cr.exptype.Float};r.prototype.is_string=function(){return this.type===cr.exptype.String};r.prototype.make_int=function(){this.is_int()||(this.is_float()?this.data=Math.floor(this.data):this.is_string()&&
(this.data=parseInt(this.data,10)),this.type=cr.exptype.Integer)};r.prototype.make_float=function(){this.is_float()||(this.is_string()&&(this.data=parseFloat(this.data)),this.type=cr.exptype.Float)};r.prototype.make_string=function(){this.is_string()||(this.data=this.data.toString(),this.type=cr.exptype.String)};r.prototype.set_int=function(k){this.type=cr.exptype.Integer;this.data=Math.floor(k)};r.prototype.set_float=function(k){this.type=cr.exptype.Float;this.data=k};r.prototype.set_string=function(k){this.type=
cr.exptype.String;this.data=k};r.prototype.set_any=function(k){cr.is_number(k)?(this.type=cr.exptype.Float,this.data=k):cr.is_string(k)?(this.type=cr.exptype.String,this.data=k.toString()):(this.type=cr.exptype.Integer,this.data=0)};cr.expvalue=r;cr.exptype={Integer:0,Float:1,String:2}})();cr.system_object=function(b){this.runtime=b;this.waits=[]};
cr.system_object.prototype.saveToJSON=function(){var b={},e,h,r;b.waits=[];var z=b.waits;var N=0;for(e=this.waits.length;N<e;N++){var k=this.waits[N];var a={t:k.time,st:k.signaltag,s:k.signalled,ev:k.ev.sid,sm:[],sols:{}};k.ev.actions[k.actindex]&&(a.act=k.ev.actions[k.actindex].sid);var c=0;for(h=k.solModifiers.length;c<h;c++)a.sm.push(k.solModifiers[c].sid);for(r in k.sols)if(k.sols.hasOwnProperty(r)){var l=this.runtime.types_by_index[parseInt(r,10)];var q={sa:k.sols[r].sa,insts:[]};c=0;for(h=k.sols[r].insts.length;c<
h;c++)q.insts.push(k.sols[r].insts[c].uid);a.sols[l.sid.toString()]=q}z.push(a)}return b};
cr.system_object.prototype.loadFromJSON=function(b){b=b.waits;var e,h,r,z,N;cr.clearArray(this.waits);var k=0;for(e=b.length;k<e;k++){var a=b[k];if(z=this.runtime.blocksBySid[a.ev.toString()]){var c=-1;var l=0;for(h=z.actions.length;l<h;l++)if(z.actions[l].sid===a.act){c=l;break}if(-1!==c){var q={sols:{},solModifiers:[],deleteme:!1};q.time=a.t;q.signaltag=a.st||"";q.signalled=!!a.s;q.ev=z;q.actindex=c;l=0;for(h=a.sm.length;l<h;l++)(z=this.runtime.getObjectTypeBySid(a.sm[l]))&&q.solModifiers.push(z);
for(r in a.sols)if(a.sols.hasOwnProperty(r)&&(z=this.runtime.getObjectTypeBySid(parseInt(r,10)))){c=a.sols[r];var p={sa:c.sa,insts:[]};l=0;for(h=c.insts.length;l<h;l++)(N=this.runtime.getObjectByUID(c.insts[l]))&&p.insts.push(N);q.sols[z.index.toString()]=p}this.waits.push(q)}}}};
(function(){function b(){}function e(d,m){d=d.extra.c2_feo_val;m=m.extra.c2_feo_val;if(cr.is_number(d)&&cr.is_number(m))return d-m;d=""+d;m=""+m;return d<m?-1:d>m?1:0}function h(d,m){K&&d===A&&m===J||(K=new RegExp(d,m),A=d,J=m);K.lastIndex=0;return K}function r(){}function z(){var d=n.length?n.pop():{sols:{},solModifiers:[]};d.deleteme=!1;return d}function N(){var d=x.length?x.pop():{insts:[]};d.sa=!1;return d}function k(d,m){var G=d[0]-m[0];return 0!==G?G:d[1]-m[1]}function a(d,m){return d[1]-m[1]}
function c(){}function l(d,m,G){if(d!==V||m!==Z||G!==M){var f=h(m,G);E=d.match(f);V=d;Z=m;M=G}}var q=cr.system_object.prototype;b.prototype.EveryTick=function(){return!0};b.prototype.OnLayoutStart=function(){return!0};b.prototype.OnLayoutEnd=function(){return!0};b.prototype.Compare=function(d,m,G){return cr.do_cmp(d,m,G)};b.prototype.CompareTime=function(d,m){var G=this.runtime.kahanTime.sum;return 0===d?(d=this.runtime.getCurrentCondition(),!d.extra.CompareTime_executed&&G>=m?d.extra.CompareTime_executed=
!0:!1):cr.do_cmp(G,d,m)};b.prototype.LayerVisible=function(d){return d?d.visible:!1};b.prototype.LayerEmpty=function(d){return d?!d.instances.length:!1};b.prototype.LayerCmpOpacity=function(d,m,G){return d?cr.do_cmp(100*d.opacity,m,G):!1};b.prototype.Repeat=function(d){var m=this.runtime.getCurrentEventStack(),G=m.current_event,f=m.isModifierAfterCnds();m=this.runtime.pushLoopStack();if(f)for(f=0;f<d&&!m.stopped;f++)this.runtime.pushCopySol(G.solModifiers),m.index=f,G.retrigger(),this.runtime.popSol(G.solModifiers);
else for(f=0;f<d&&!m.stopped;f++)m.index=f,G.retrigger();this.runtime.popLoopStack();return!1};b.prototype.While=function(d){var m=this.runtime.getCurrentEventStack();d=m.current_event;var G=m.isModifierAfterCnds();m=this.runtime.pushLoopStack();if(G)for(G=0;!m.stopped;G++)this.runtime.pushCopySol(d.solModifiers),m.index=G,d.retrigger()||(m.stopped=!0),this.runtime.popSol(d.solModifiers);else for(G=0;!m.stopped;G++)m.index=G,d.retrigger()||(m.stopped=!0);this.runtime.popLoopStack();return!1};b.prototype.For=
function(d,m,G){var f=this.runtime.getCurrentEventStack(),y=f.current_event;f=f.isModifierAfterCnds();d=this.runtime.pushLoopStack(d);if(G<m)if(f)for(;m>=G&&!d.stopped;--m)this.runtime.pushCopySol(y.solModifiers),d.index=m,y.retrigger(),this.runtime.popSol(y.solModifiers);else for(;m>=G&&!d.stopped;--m)d.index=m,y.retrigger();else if(f)for(;m<=G&&!d.stopped;++m)this.runtime.pushCopySol(y.solModifiers),d.index=m,y.retrigger(),this.runtime.popSol(y.solModifiers);else for(;m<=G&&!d.stopped;++m)d.index=
m,y.retrigger();this.runtime.popLoopStack();return!1};var p=[],w=-1;b.prototype.ForEach=function(d){var m=d.getCurrentSol();w++;p.length===w&&p.push([]);var G=p[w];cr.shallowAssignArray(G,m.getObjects());var f=this.runtime.getCurrentEventStack(),y=f.current_event,L=f.isModifierAfterCnds();f=this.runtime.pushLoopStack();var P,X,ba=d.is_contained;if(L)for(L=0,P=G.length;L<P&&!f.stopped;L++){this.runtime.pushCopySol(y.solModifiers);var aa=G[L];m=d.getCurrentSol();m.select_all=!1;cr.clearArray(m.instances);
m.instances[0]=aa;if(ba){var ca=0;for(X=aa.siblings.length;ca<X;ca++){var ja=aa.siblings[ca];var ha=ja.type.getCurrentSol();ha.select_all=!1;cr.clearArray(ha.instances);ha.instances[0]=ja}}f.index=L;y.retrigger();this.runtime.popSol(y.solModifiers)}else for(m.select_all=!1,cr.clearArray(m.instances),L=0,P=G.length;L<P&&!f.stopped;L++){aa=G[L];m.instances[0]=aa;if(ba)for(ca=0,X=aa.siblings.length;ca<X;ca++)ja=aa.siblings[ca],ha=ja.type.getCurrentSol(),ha.select_all=!1,cr.clearArray(ha.instances),ha.instances[0]=
ja;f.index=L;y.retrigger()}cr.clearArray(G);this.runtime.popLoopStack();w--;return!1};b.prototype.ForEachOrdered=function(d,m,G){m=d.getCurrentSol();w++;p.length===w&&p.push([]);var f=p[w];cr.shallowAssignArray(f,m.getObjects());var y=this.runtime.getCurrentEventStack(),L=y.current_event,P=this.runtime.getCurrentCondition(),X=y.isModifierAfterCnds();y=this.runtime.pushLoopStack();var ba;var aa=0;for(ba=f.length;aa<ba;aa++)f[aa].extra.c2_feo_val=P.parameters[1].get(aa);f.sort(e);1===G&&f.reverse();
G=d.is_contained;if(X)for(aa=0,ba=f.length;aa<ba&&!y.stopped;aa++){this.runtime.pushCopySol(L.solModifiers);var ca=f[aa];m=d.getCurrentSol();m.select_all=!1;cr.clearArray(m.instances);m.instances[0]=ca;if(G)for(P=0,X=ca.siblings.length;P<X;P++){var ja=ca.siblings[P];var ha=ja.type.getCurrentSol();ha.select_all=!1;cr.clearArray(ha.instances);ha.instances[0]=ja}y.index=aa;L.retrigger();this.runtime.popSol(L.solModifiers)}else for(m.select_all=!1,cr.clearArray(m.instances),aa=0,ba=f.length;aa<ba&&!y.stopped;aa++){ca=
f[aa];m.instances[0]=ca;if(G)for(P=0,X=ca.siblings.length;P<X;P++)ja=ca.siblings[P],ha=ja.type.getCurrentSol(),ha.select_all=!1,cr.clearArray(ha.instances),ha.instances[0]=ja;y.index=aa;L.retrigger()}cr.clearArray(f);this.runtime.popLoopStack();w--;return!1};b.prototype.PickByComparison=function(d,m,G,f){var y,L;if(d){w++;p.length===w&&p.push([]);var P=p[w],X=d.getCurrentSol();cr.shallowAssignArray(P,X.getObjects());X.select_all&&cr.clearArray(X.else_instances);var ba=this.runtime.getCurrentCondition();
var aa=y=0;for(L=P.length;y<L;y++){var ca=P[y];P[aa]=ca;m=ba.parameters[1].get(y);f=ba.parameters[3].get(y);cr.do_cmp(m,G,f)?aa++:X.else_instances.push(ca)}cr.truncateArray(P,aa);X.select_all=!1;cr.shallowAssignArray(X.instances,P);cr.clearArray(P);w--;d.applySolToContainer();return!!X.instances.length}};b.prototype.PickByEvaluate=function(d,m){var G,f;if(d){w++;p.length===w&&p.push([]);var y=p[w],L=d.getCurrentSol();cr.shallowAssignArray(y,L.getObjects());L.select_all&&cr.clearArray(L.else_instances);
var P=this.runtime.getCurrentCondition();var X=G=0;for(f=y.length;G<f;G++){var ba=y[G];y[X]=ba;(m=P.parameters[1].get(G))?X++:L.else_instances.push(ba)}cr.truncateArray(y,X);L.select_all=!1;cr.shallowAssignArray(L.instances,y);cr.clearArray(y);w--;d.applySolToContainer();return!!L.instances.length}};b.prototype.TriggerOnce=function(){var d=this.runtime.getCurrentCondition().extra;"undefined"===typeof d.TriggerOnce_lastTick&&(d.TriggerOnce_lastTick=-1);var m=d.TriggerOnce_lastTick,G=this.runtime.tickcount;
d.TriggerOnce_lastTick=G;return this.runtime.layout_first_tick||m!==G-1};b.prototype.Every=function(d){var m=this.runtime.getCurrentCondition(),G=m.extra.Every_lastTime||0,f=this.runtime.kahanTime.sum;"undefined"===typeof m.extra.Every_seconds&&(m.extra.Every_seconds=d);var y=m.extra.Every_seconds;if(f>=G+y)return m.extra.Every_lastTime=G+y,f>=m.extra.Every_lastTime+.04&&(m.extra.Every_lastTime=f),m.extra.Every_seconds=d,!0;f<G-.1&&(m.extra.Every_lastTime=f);return!1};b.prototype.PickNth=function(d,
m){if(!d)return!1;var G=d.getCurrentSol(),f=G.getObjects();m=cr.floor(m);if(0>m||m>=f.length)return!1;G.pick_one(f[m]);d.applySolToContainer();return!0};b.prototype.PickRandom=function(d){if(!d)return!1;var m=d.getCurrentSol(),G=m.getObjects(),f=cr.floor(Math.random()*G.length);if(f>=G.length)return!1;m.pick_one(G[f]);d.applySolToContainer();return!0};b.prototype.CompareVar=function(d,m,G){return cr.do_cmp(d.getValue(),m,G)};b.prototype.CompareBoolVar=function(d){return d.getValue()};b.prototype.IsGroupActive=
function(d){return(d=this.runtime.groups_by_name[d.toLowerCase()])&&d.group_active};b.prototype.IsPreview=function(){return this.runtime.isPreview};b.prototype.PickAll=function(d){if(!d||!d.instances.length)return!1;d.getCurrentSol().select_all=!0;d.applySolToContainer();return!0};b.prototype.IsMobile=function(){return this.runtime.isMobile};b.prototype.CompareBetween=function(d,m,G){return d>=m&&d<=G};b.prototype.Else=function(){var d=this.runtime.getCurrentEventStack();return d.else_branch_ran?
!1:!d.last_event_true};b.prototype.OnLoadFinished=function(){return!0};b.prototype.OnCanvasSnapshot=function(){return!0};b.prototype.EffectsSupported=function(){return!!this.runtime.glwrap};b.prototype.OnSaveComplete=function(){return!0};b.prototype.OnSaveFailed=function(){return!0};b.prototype.OnLoadComplete=function(){return!0};b.prototype.OnLoadFailed=function(){return!0};b.prototype.ObjectUIDExists=function(d){return!!this.runtime.getObjectByUID(d)};b.prototype.IsOnPlatform=function(d){var m=
this.runtime;switch(d){case 0:return!m.isNodeWebkit&&!m.isCordova&&!m.isWinJS&&!m.isWindowsPhone8&&!m.isBlackberry10&&!m.isAmazonWebApp;case 1:return m.isiOS;case 2:return m.isAndroid;case 3:return m.isWindows8App;case 4:return m.isWindowsPhone8;case 5:return m.isBlackberry10;case 6:return m.isTizen;case 7:return!1;case 8:return m.isCordova;case 9:return m.isArcade;case 10:return m.isNodeWebkit;case 11:return m.isCrosswalk;case 12:return m.isAmazonWebApp;case 13:return m.isWindows10;default:return!1}};
var K=null,A="",J="";b.prototype.RegexTest=function(d,m,G){return h(m,G).test(d)};var R=[];b.prototype.PickOverlappingPoint=function(d,m,G){if(!d)return!1;var f=d.getCurrentSol(),y=f.getObjects(),L=this.runtime.getCurrentEventStack().current_event.orblock,P=this.runtime.getCurrentCondition(),X;f.select_all?(cr.shallowAssignArray(R,y),cr.clearArray(f.else_instances),f.select_all=!1,cr.clearArray(f.instances)):L?(cr.shallowAssignArray(R,f.else_instances),cr.clearArray(f.else_instances)):(cr.shallowAssignArray(R,
y),cr.clearArray(f.instances));y=0;for(L=R.length;y<L;++y){var ba=R[y];ba.update_bbox();(X=cr.xor(ba.contains_pt(m,G),P.inverted))?f.instances.push(ba):f.else_instances.push(ba)}d.applySolToContainer();return cr.xor(!!f.instances.length,P.inverted)};b.prototype.PickLastCreated=function(d){if(!d)return!1;var m=this.runtime.createRow,G,f=null,y=d.is_family;for(G=m.length-1;0<=G;--G){var L=m[G];if(y){if(0<=L.type.families.indexOf(d)){f=L;break}}else if(L.type===d){f=L;break}}!f&&d.instances.length&&
(f=d.instances[d.instances.length-1]);if(!f)return!1;d.getCurrentSol().pick_one(f);d.applySolToContainer();return!0};b.prototype.IsNaN=function(d){return!!isNaN(d)};b.prototype.AngleWithin=function(d,m,G){return cr.angleDiff(cr.to_radians(d),cr.to_radians(G))<=cr.to_radians(m)};b.prototype.IsClockwiseFrom=function(d,m){return cr.angleClockwise(cr.to_radians(d),cr.to_radians(m))};b.prototype.IsBetweenAngles=function(d,m,G){d=cr.to_clamped_radians(d);m=cr.to_clamped_radians(m);G=cr.to_clamped_radians(G);
return cr.angleClockwise(G,m)?cr.angleClockwise(d,m)&&!cr.angleClockwise(d,G):!(!cr.angleClockwise(d,m)&&cr.angleClockwise(d,G))};b.prototype.IsValueType=function(d,m){return"number"===typeof d?0===m:1===m};q.cnds=new b;r.prototype.GoToLayout=function(d){this.runtime.isloading||this.runtime.changelayout||(this.runtime.changelayout=d)};r.prototype.NextPrevLayout=function(d){if(!this.runtime.isloading&&!this.runtime.changelayout){var m=this.runtime.layouts_by_index.indexOf(this.runtime.running_layout);
if(!d||0!==m)if(d||m!==this.runtime.layouts_by_index.length-1)this.runtime.changelayout=this.runtime.layouts_by_index[m+(d?-1:1)]}};r.prototype.CreateObject=function(d,m,G,f){if(m&&d&&(m=this.runtime.createInstance(d,m,G,f))){this.runtime.isInOnDestroy++;this.runtime.trigger(Object.getPrototypeOf(d.plugin).cnds.OnCreated,m);if(m.is_contained)for(G=0,f=m.siblings.length;G<f;G++){var y=m.siblings[G];this.runtime.trigger(Object.getPrototypeOf(y.type.plugin).cnds.OnCreated,y)}this.runtime.isInOnDestroy--;
d=d.getCurrentSol();d.select_all=!1;cr.clearArray(d.instances);d.instances[0]=m;if(m.is_contained)for(G=0,f=m.siblings.length;G<f;G++)y=m.siblings[G],d=y.type.getCurrentSol(),d.select_all=!1,cr.clearArray(d.instances),d.instances[0]=y}};r.prototype.CreateObjectByName=function(d,m,G,f){m&&d&&(d=this.runtime.types_lowercase[d.toLowerCase()])&&r.prototype.CreateObject.call(this,d,m,G,f)};r.prototype.SetLayerVisible=function(d,m){d&&d.visible!==m&&(d.visible=m,this.runtime.redraw=!0)};r.prototype.SetLayerOpacity=
function(d,m){d&&(m=cr.clamp(m/100,0,1),d.opacity!==m&&(d.opacity=m,this.runtime.redraw=!0))};r.prototype.SetLayerScaleRate=function(d,m){d&&d.zoomRate!==m&&(d.zoomRate=m,this.runtime.redraw=!0)};r.prototype.SetLayerForceOwnTexture=function(d,m){d&&(m=!!m,d.forceOwnTexture!==m&&(d.forceOwnTexture=m,this.runtime.redraw=!0))};r.prototype.SetLayoutScale=function(d){this.runtime.running_layout&&this.runtime.running_layout.scale!==d&&(this.runtime.running_layout.scale=d,this.runtime.running_layout.boundScrolling(),
this.runtime.redraw=!0)};r.prototype.ScrollX=function(d){this.runtime.running_layout.scrollToX(d)};r.prototype.ScrollY=function(d){this.runtime.running_layout.scrollToY(d)};r.prototype.Scroll=function(d,m){this.runtime.running_layout.scrollToX(d);this.runtime.running_layout.scrollToY(m)};r.prototype.ScrollToObject=function(d){if(d=d.getFirstPicked())this.runtime.running_layout.scrollToX(d.x),this.runtime.running_layout.scrollToY(d.y)};r.prototype.SetVar=function(d,m){0===d.vartype?cr.is_number(m)?
d.setValue(m):d.setValue(parseFloat(m)):1===d.vartype&&d.setValue(m.toString())};r.prototype.AddVar=function(d,m){0===d.vartype?cr.is_number(m)?d.setValue(d.getValue()+m):d.setValue(d.getValue()+parseFloat(m)):1===d.vartype&&d.setValue(d.getValue()+m.toString())};r.prototype.SubVar=function(d,m){0===d.vartype&&(cr.is_number(m)?d.setValue(d.getValue()-m):d.setValue(d.getValue()-parseFloat(m)))};r.prototype.SetBoolVar=function(d,m){d.setValue(0!==m)};r.prototype.ToggleBoolVar=function(d){d.setValue(!d.getValue())};
r.prototype.SetGroupActive=function(d,m){if(d=this.runtime.groups_by_name[d.toLowerCase()])switch(m){case 0:d.setGroupActive(!1);break;case 1:d.setGroupActive(!0);break;case 2:d.setGroupActive(!d.group_active)}};r.prototype.SetTimescale=function(d){0>d&&(d=0);this.runtime.timescale=d};r.prototype.SetObjectTimescale=function(d,m){0>m&&(m=0);if(d){d=d.getCurrentSol().getObjects();var G;var f=0;for(G=d.length;f<G;f++)d[f].my_timescale=m}};r.prototype.RestoreObjectTimescale=function(d){if(!d)return!1;
d=d.getCurrentSol().getObjects();var m;var G=0;for(m=d.length;G<m;G++)d[G].my_timescale=-1};var n=[],x=[];r.prototype.Wait=function(d){if(!(0>d)){var m,G=this.runtime.getCurrentEventStack(),f=z();f.time=this.runtime.kahanTime.sum+d;f.signaltag="";f.signalled=!1;f.ev=G.current_event;f.actindex=G.actindex+1;d=0;for(m=this.runtime.types_by_index.length;d<m;d++){var y=this.runtime.types_by_index[d];var L=y.getCurrentSol();L.select_all&&-1===G.current_event.solModifiers.indexOf(y)||(f.solModifiers.push(y),
y=N(),y.sa=L.select_all,cr.shallowAssignArray(y.insts,L.instances),f.sols[d.toString()]=y)}this.waits.push(f);return!0}};r.prototype.WaitForSignal=function(d){var m,G=this.runtime.getCurrentEventStack(),f=z();f.time=-1;f.signaltag=d.toLowerCase();f.signalled=!1;f.ev=G.current_event;f.actindex=G.actindex+1;d=0;for(m=this.runtime.types_by_index.length;d<m;d++){var y=this.runtime.types_by_index[d];var L=y.getCurrentSol();L.select_all&&-1===G.current_event.solModifiers.indexOf(y)||(f.solModifiers.push(y),
y=N(),y.sa=L.select_all,cr.shallowAssignArray(y.insts,L.instances),f.sols[d.toString()]=y)}this.waits.push(f);return!0};r.prototype.Signal=function(d){d=d.toLowerCase();var m;var G=0;for(m=this.waits.length;G<m;++G){var f=this.waits[G];-1===f.time&&f.signaltag===d&&(f.signalled=!0)}};r.prototype.SetLayerScale=function(d,m){d&&d.scale!==m&&(d.scale=m,this.runtime.redraw=!0)};r.prototype.ResetGlobals=function(){var d;var m=0;for(d=this.runtime.all_global_vars.length;m<d;m++){var G=this.runtime.all_global_vars[m];
G.data=G.initial}};r.prototype.SetLayoutAngle=function(d){d=cr.to_radians(d);d=cr.clamp_angle(d);this.runtime.running_layout&&this.runtime.running_layout.angle!==d&&(this.runtime.running_layout.angle=d,this.runtime.redraw=!0)};r.prototype.SetLayerAngle=function(d,m){d&&(m=cr.to_radians(m),m=cr.clamp_angle(m),d.angle!==m&&(d.angle=m,this.runtime.redraw=!0))};r.prototype.SetLayerParallax=function(d,m,G){if(d&&(d.parallaxX!==m/100||d.parallaxY!==G/100)){d.parallaxX=m/100;d.parallaxY=G/100;if(1!==d.parallaxX||
1!==d.parallaxY)for(G=d.instances,d=0,m=G.length;d<m;++d)G[d].type.any_instance_parallaxed=!0;this.runtime.redraw=!0}};r.prototype.SetLayerBackground=function(d,m){if(d){var G=cr.clamp(Math.floor(255*cr.GetRValue(m)),0,255),f=cr.clamp(Math.floor(255*cr.GetGValue(m)),0,255);m=cr.clamp(Math.floor(255*cr.GetBValue(m)),0,255);if(d.background_color[0]!==G||d.background_color[1]!==f||d.background_color[2]!==m)d.background_color[0]=G,d.background_color[1]=f,d.background_color[2]=m,this.runtime.redraw=!0}};
r.prototype.SetLayerTransparent=function(d,m){d&&!!m!==!!d.transparent&&(d.transparent=!!m,this.runtime.redraw=!0)};r.prototype.SetLayerBlendMode=function(d,m){d&&d.blend_mode!==m&&(d.blend_mode=m,d.compositeOp=cr.effectToCompositeOp(d.blend_mode),this.runtime.gl&&cr.setGLBlend(d,d.blend_mode,this.runtime.gl),this.runtime.redraw=!0)};r.prototype.StopLoop=function(){0>this.runtime.loop_stack_index||(this.runtime.getCurrentLoop().stopped=!0)};r.prototype.GoToLayoutByName=function(d){if(!this.runtime.isloading&&
!this.runtime.changelayout)for(var m in this.runtime.layouts)if(this.runtime.layouts.hasOwnProperty(m)&&cr.equals_nocase(m,d)){this.runtime.changelayout=this.runtime.layouts[m];break}};r.prototype.RestartLayout=function(d){if(!this.runtime.isloading&&!this.runtime.changelayout&&this.runtime.running_layout){this.runtime.changelayout=this.runtime.running_layout;var m;d=0;for(m=this.runtime.allGroups.length;d<m;d++){var G=this.runtime.allGroups[d];G.setGroupActive(G.initially_activated)}}};r.prototype.SnapshotCanvas=
function(d,m){this.runtime.doCanvasSnapshot(0===d?"image/png":"image/jpeg",m/100)};r.prototype.SetCanvasSize=function(d,m){if(!(0>=d||0>=m)){var G=this.runtime.fullscreen_mode;(document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen)&&0<this.runtime.fullscreen_scaling&&(G=this.runtime.fullscreen_scaling);0===G?this.runtime.setSize(d,m,!0):(this.runtime.original_width=d,this.runtime.original_height=m,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,
!0))}};r.prototype.SetLayoutEffectEnabled=function(d,m){this.runtime.running_layout&&this.runtime.glwrap&&(m=this.runtime.running_layout.getEffectByName(m))&&(d=1===d,m.active!=d&&(m.active=d,this.runtime.running_layout.updateActiveEffects(),this.runtime.redraw=!0))};r.prototype.SetLayerEffectEnabled=function(d,m,G){d&&this.runtime.glwrap&&(G=d.getEffectByName(G))&&(m=1===m,G.active!=m&&(G.active=m,d.updateActiveEffects(),this.runtime.redraw=!0))};r.prototype.SetLayoutEffectParam=function(d,m,G){if(this.runtime.running_layout&&
this.runtime.glwrap&&(d=this.runtime.running_layout.getEffectByName(d))){var f=this.runtime.running_layout.effect_params[d.index];m=Math.floor(m);if(!(0>m||m>=f.length)){var y=this.runtime.glwrap.getProgramParameterType(d.shaderindex,m);1===y?G/=100:2===y&&(G=[cr.GetRValue(G),cr.GetGValue(G),cr.GetBValue(G)]);f[m]!==G&&(f[m]=G,d.active&&(this.runtime.redraw=!0))}}};r.prototype.SetLayerEffectParam=function(d,m,G,f){if(d&&this.runtime.glwrap&&(m=d.getEffectByName(m))&&(d=d.effect_params[m.index],G=
Math.floor(G),!(0>G||G>=d.length))){var y=this.runtime.glwrap.getProgramParameterType(m.shaderindex,G);1===y?f/=100:2===y&&(f=[cr.GetRValue(f),cr.GetGValue(f),cr.GetBValue(f)]);d[G]!==f&&(d[G]=f,m.active&&(this.runtime.redraw=!0))}};r.prototype.SaveState=function(d){this.runtime.saveToSlot=d};r.prototype.LoadState=function(d){this.runtime.loadFromSlot=d};r.prototype.LoadStateJSON=function(d){this.runtime.loadFromJson=d};r.prototype.SetHalfFramerateMode=function(d){this.runtime.halfFramerateMode=0!==
d};r.prototype.SetFullscreenQuality=function(d){if(document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen||0!==this.runtime.fullscreen_mode)this.runtime.wantFullscreenScalingQuality=0!==d,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,!0)};r.prototype.ResetPersisted=function(){var d;var m=0;for(d=this.runtime.layouts_by_index.length;m<d;++m)this.runtime.layouts_by_index[m].persist_data={},this.runtime.layouts_by_index[m].first_visit=
!0};r.prototype.RecreateInitialObjects=function(d,m,G,f,y){d&&this.runtime.running_layout.recreateInitialObjects(d,m,G,f,y)};r.prototype.SetPixelRounding=function(d){this.runtime.pixel_rounding=0!==d;this.runtime.redraw=!0};r.prototype.SetMinimumFramerate=function(d){1>d&&(d=1);120<d&&(d=120);this.runtime.minimumFramerate=d};r.prototype.SortZOrderByInstVar=function(d,m){if(d){var G;var f=d.getCurrentSol().getObjects();var y=[],L=[],P=this.runtime.running_layout,X=d.is_family,ba=d.family_index,aa=
!1;d=0;for(G=f.length;d<G;++d){var ca=f[d];if(ca.layer){var ja=X?ca.instance_vars[m+ca.type.family_var_map[ba]]:ca.instance_vars[m];y.push([ca.layer.index,ca.get_zindex()]);L.push([ca,ja])}}if(y.length){y.sort(k);L.sort(a);d=0;for(G=y.length;d<G;++d)ca=L[d][0],m=P.layers[y[d][0]],f=y[d][1],m.instances[f]!==ca&&(m.instances[f]=ca,ca.layer=m,m.setZIndicesStaleFrom(f),aa=!0);aa&&(this.runtime.redraw=!0)}}};q.acts=new r;c.prototype.int=function(d,m){cr.is_string(m)?(d.set_int(parseInt(m,10)),isNaN(d.data)&&
(d.data=0)):d.set_int(m)};c.prototype.float=function(d,m){cr.is_string(m)?(d.set_float(parseFloat(m)),isNaN(d.data)&&(d.data=0)):d.set_float(m)};c.prototype.str=function(d,m){cr.is_string(m)?d.set_string(m):d.set_string(m.toString())};c.prototype.len=function(d,m){d.set_int(m.length||0)};c.prototype.random=function(d,m,G){void 0===G?d.set_float(Math.random()*m):d.set_float(Math.random()*(G-m)+m)};c.prototype.sqrt=function(d,m){d.set_float(Math.sqrt(m))};c.prototype.abs=function(d,m){d.set_float(Math.abs(m))};
c.prototype.round=function(d,m){d.set_int(Math.round(m))};c.prototype.floor=function(d,m){d.set_int(Math.floor(m))};c.prototype.ceil=function(d,m){d.set_int(Math.ceil(m))};c.prototype.sign=function(d,m){d.set_float(Math.sign(m))};c.prototype.sin=function(d,m){d.set_float(Math.sin(cr.to_radians(m)))};c.prototype.cos=function(d,m){d.set_float(Math.cos(cr.to_radians(m)))};c.prototype.tan=function(d,m){d.set_float(Math.tan(cr.to_radians(m)))};c.prototype.asin=function(d,m){d.set_float(cr.to_degrees(Math.asin(m)))};
c.prototype.acos=function(d,m){d.set_float(cr.to_degrees(Math.acos(m)))};c.prototype.atan=function(d,m){d.set_float(cr.to_degrees(Math.atan(m)))};c.prototype.exp=function(d,m){d.set_float(Math.exp(m))};c.prototype.ln=function(d,m){d.set_float(Math.log(m))};c.prototype.log10=function(d,m){d.set_float(Math.log(m)/Math.LN10)};c.prototype.max=function(d){var m=arguments[1];"number"!==typeof m&&(m=0);var G;var f=2;for(G=arguments.length;f<G;f++){var y=arguments[f];"number"===typeof y&&m<y&&(m=y)}d.set_float(m)};
c.prototype.min=function(d){var m=arguments[1];"number"!==typeof m&&(m=0);var G;var f=2;for(G=arguments.length;f<G;f++){var y=arguments[f];"number"===typeof y&&m>y&&(m=y)}d.set_float(m)};c.prototype.dt=function(d){d.set_float(this.runtime.dt)};c.prototype.timescale=function(d){d.set_float(this.runtime.timescale)};c.prototype.wallclocktime=function(d){d.set_float((Date.now()-this.runtime.start_time)/1E3)};c.prototype.unixtime=function(d){d.set_float(Date.now())};c.prototype.time=function(d){d.set_float(this.runtime.kahanTime.sum)};
c.prototype.tickcount=function(d){d.set_int(this.runtime.tickcount)};c.prototype.objectcount=function(d){d.set_int(this.runtime.objectcount)};c.prototype.fps=function(d){d.set_int(this.runtime.fps)};c.prototype.loopindex=function(d,m){var G;if(this.runtime.loop_stack.length)if(m){for(G=this.runtime.loop_stack_index;0<=G;--G){var f=this.runtime.loop_stack[G];if(f.name===m){d.set_int(f.index);return}}d.set_int(0)}else f=this.runtime.getCurrentLoop(),d.set_int(f?f.index:-1);else d.set_int(0)};c.prototype.distance=
function(d,m,G,f,y){d.set_float(cr.distanceTo(m,G,f,y))};c.prototype.angle=function(d,m,G,f,y){d.set_float(cr.to_degrees(cr.angleTo(m,G,f,y)))};c.prototype.scrollx=function(d){d.set_float(this.runtime.running_layout.scrollX)};c.prototype.scrolly=function(d){d.set_float(this.runtime.running_layout.scrollY)};c.prototype.newline=function(d){d.set_string("\n")};c.prototype.lerp=function(d,m,G,f){d.set_float(cr.lerp(m,G,f))};c.prototype.qarp=function(d,m,G,f,y){d.set_float(cr.qarp(m,G,f,y))};c.prototype.cubic=
function(d,m,G,f,y,L){d.set_float(cr.cubic(m,G,f,y,L))};c.prototype.cosp=function(d,m,G,f){d.set_float(cr.cosp(m,G,f))};c.prototype.windowwidth=function(d){d.set_int(this.runtime.width)};c.prototype.windowheight=function(d){d.set_int(this.runtime.height)};c.prototype.uppercase=function(d,m){d.set_string(cr.is_string(m)?m.toUpperCase():"")};c.prototype.lowercase=function(d,m){d.set_string(cr.is_string(m)?m.toLowerCase():"")};c.prototype.clamp=function(d,m,G,f){m<G?d.set_float(G):m>f?d.set_float(f):
d.set_float(m)};c.prototype.layerscale=function(d,m){(m=this.runtime.getLayer(m))?d.set_float(m.scale):d.set_float(0)};c.prototype.layeropacity=function(d,m){(m=this.runtime.getLayer(m))?d.set_float(100*m.opacity):d.set_float(0)};c.prototype.layerscalerate=function(d,m){(m=this.runtime.getLayer(m))?d.set_float(m.zoomRate):d.set_float(0)};c.prototype.layerparallaxx=function(d,m){(m=this.runtime.getLayer(m))?d.set_float(100*m.parallaxX):d.set_float(0)};c.prototype.layerparallaxy=function(d,m){(m=this.runtime.getLayer(m))?
d.set_float(100*m.parallaxY):d.set_float(0)};c.prototype.layerindex=function(d,m){(m=this.runtime.getLayer(m))?d.set_int(m.index):d.set_int(-1)};c.prototype.layoutscale=function(d){this.runtime.running_layout?d.set_float(this.runtime.running_layout.scale):d.set_float(0)};c.prototype.layoutangle=function(d){d.set_float(cr.to_degrees(this.runtime.running_layout.angle))};c.prototype.layerangle=function(d,m){(m=this.runtime.getLayer(m))?d.set_float(cr.to_degrees(m.angle)):d.set_float(0)};c.prototype.layoutwidth=
function(d){d.set_int(this.runtime.running_layout.width)};c.prototype.layoutheight=function(d){d.set_int(this.runtime.running_layout.height)};c.prototype.find=function(d,m,G){cr.is_string(m)&&cr.is_string(G)?d.set_int(m.search(new RegExp(cr.regexp_escape(G),"i"))):d.set_int(-1)};c.prototype.findcase=function(d,m,G){cr.is_string(m)&&cr.is_string(G)?d.set_int(m.search(new RegExp(cr.regexp_escape(G),""))):d.set_int(-1)};c.prototype.left=function(d,m,G){d.set_string(cr.is_string(m)?m.substr(0,G):"")};
c.prototype.right=function(d,m,G){d.set_string(cr.is_string(m)?m.substr(m.length-G):"")};c.prototype.mid=function(d,m,G,f){d.set_string(cr.is_string(m)?m.substr(G,f):"")};c.prototype.tokenat=function(d,m,G,f){cr.is_string(m)&&cr.is_string(f)?(m=m.split(f),G=cr.floor(G),0>G||G>=m.length?d.set_string(""):d.set_string(m[G])):d.set_string("")};c.prototype.tokencount=function(d,m,G){cr.is_string(m)&&m.length?d.set_int(m.split(G).length):d.set_int(0)};c.prototype.replace=function(d,m,G,f){cr.is_string(m)&&
cr.is_string(G)&&cr.is_string(f)?d.set_string(m.replace(new RegExp(cr.regexp_escape(G),"gi"),f)):d.set_string(cr.is_string(m)?m:"")};c.prototype.trim=function(d,m){d.set_string(cr.is_string(m)?m.trim():"")};c.prototype.pi=function(d){d.set_float(cr.PI)};c.prototype.layoutname=function(d){this.runtime.running_layout?d.set_string(this.runtime.running_layout.name):d.set_string("")};c.prototype.renderer=function(d){d.set_string(this.runtime.gl?"webgl":"canvas2d")};c.prototype.rendererdetail=function(d){d.set_string(this.runtime.glUnmaskedRenderer)};
c.prototype.anglediff=function(d,m,G){d.set_float(cr.to_degrees(cr.angleDiff(cr.to_radians(m),cr.to_radians(G))))};c.prototype.choose=function(d){var m=cr.floor(Math.random()*(arguments.length-1));d.set_any(arguments[m+1])};c.prototype.rgb=function(d,m,G,f){d.set_int(cr.RGB(m,G,f))};c.prototype.rgbex=function(d,m,G,f){d.set_float(cr.RGBEx(m/100,G/100,f/100))};c.prototype.projectversion=function(d){d.set_string(this.runtime.versionstr)};c.prototype.projectname=function(d){d.set_string(this.runtime.name)};
c.prototype.anglelerp=function(d,m,G,f){m=cr.to_radians(m);G=cr.to_radians(G);var y=cr.angleDiff(m,G);cr.angleClockwise(G,m)?d.set_float(cr.to_clamped_degrees(m+y*f)):d.set_float(cr.to_clamped_degrees(m-y*f))};c.prototype.anglerotate=function(d,m,G,f){m=cr.to_radians(m);G=cr.to_radians(G);f=cr.to_radians(f);d.set_float(cr.to_clamped_degrees(cr.angleRotate(m,G,f)))};c.prototype.zeropad=function(d,m,G){var f=0>m?"-":"";0>m&&(m=-m);G-=m.toString().length;for(var y=0;y<G;y++)f+="0";d.set_string(f+m.toString())};
c.prototype.cpuutilisation=function(d){d.set_float(this.runtime.cpuutilisation/1E3)};c.prototype.gpuutilisation=function(d){d.set_float(this.runtime.gpuLastUtilisation)};c.prototype.viewportleft=function(d,m){m=this.runtime.getLayer(m);d.set_float(m?m.viewLeft:0)};c.prototype.viewporttop=function(d,m){m=this.runtime.getLayer(m);d.set_float(m?m.viewTop:0)};c.prototype.viewportright=function(d,m){m=this.runtime.getLayer(m);d.set_float(m?m.viewRight:0)};c.prototype.viewportbottom=function(d,m){m=this.runtime.getLayer(m);
d.set_float(m?m.viewBottom:0)};c.prototype.loadingprogress=function(d){d.set_float(this.runtime.loadingprogress)};c.prototype.unlerp=function(d,m,G,f){d.set_float(cr.unlerp(m,G,f))};c.prototype.canvassnapshot=function(d){d.set_string(this.runtime.snapshotData)};c.prototype.urlencode=function(d,m){d.set_string(encodeURIComponent(m))};c.prototype.urldecode=function(d,m){d.set_string(decodeURIComponent(m))};c.prototype.canvastolayerx=function(d,m,G,f){m=this.runtime.getLayer(m);d.set_float(m?m.canvasToLayer(G,
f,!0):0)};c.prototype.canvastolayery=function(d,m,G,f){m=this.runtime.getLayer(m);d.set_float(m?m.canvasToLayer(G,f,!1):0)};c.prototype.layertocanvasx=function(d,m,G,f){m=this.runtime.getLayer(m);d.set_float(m?m.layerToCanvas(G,f,!0):0)};c.prototype.layertocanvasy=function(d,m,G,f){m=this.runtime.getLayer(m);d.set_float(m?m.layerToCanvas(G,f,!1):0)};c.prototype.savestatejson=function(d){d.set_string(this.runtime.lastSaveJson)};c.prototype.imagememoryusage=function(d){this.runtime.glwrap?d.set_float(Math.round(100*
this.runtime.glwrap.estimateVRAM()/1048576)/100):d.set_float(0)};c.prototype.regexsearch=function(d,m,G,f){G=h(G,f);d.set_int(m?m.search(G):-1)};c.prototype.regexreplace=function(d,m,G,f,y){G=h(G,f);d.set_string(m?m.replace(G,y):"")};var E=[],V="",Z="",M="";c.prototype.regexmatchcount=function(d,m,G,f){h(G,f);l(m.toString(),G,f);d.set_int(E?E.length:0)};c.prototype.regexmatchat=function(d,m,G,f,y){y=Math.floor(y);h(G,f);l(m.toString(),G,f);!E||0>y||y>=E.length?d.set_string(""):d.set_string(E[y])};
c.prototype.infinity=function(d){d.set_float(Infinity)};c.prototype.setbit=function(d,m,G,f){G|=0;d.set_int((m|0)&~(1<<G)|(0!==f?1:0)<<G)};c.prototype.togglebit=function(d,m,G){d.set_int((m|0)^1<<(G|0))};c.prototype.getbit=function(d,m,G){d.set_int((m|0)&1<<(G|0)?1:0)};c.prototype.originalwindowwidth=function(d){d.set_int(this.runtime.original_width)};c.prototype.originalwindowheight=function(d){d.set_int(this.runtime.original_height)};c.prototype.originalviewportwidth=function(d){d.set_int(this.runtime.original_width)};
c.prototype.originalviewportheight=function(d){d.set_int(this.runtime.original_height)};q.exps=new c;q.runWaits=function(){var d,m=this.runtime.getCurrentEventStack();var G=0;for(d=this.waits.length;G<d;G++){var f=this.waits[G];if(-1===f.time){if(!f.signalled)continue}else if(f.time>this.runtime.kahanTime.sum)continue;m.current_event=f.ev;m.actindex=f.actindex;m.cndindex=0;for(P in f.sols)if(f.sols.hasOwnProperty(P)){var y=this.runtime.types_by_index[parseInt(P,10)].getCurrentSol();var L=f.sols[P];
y.select_all=L.sa;cr.shallowAssignArray(y.instances,L.insts);y=L;cr.clearArray(y.insts);x.push(y)}f.ev.resume_actions_and_subevents();this.runtime.clearSol(f.solModifiers);f.deleteme=!0}var P=G=0;for(d=this.waits.length;G<d;G++)f=this.waits[G],this.waits[P]=f,f.deleteme?(cr.wipe(f.sols),cr.clearArray(f.solModifiers),n.push(f)):P++;cr.truncateArray(this.waits,P)}})();
(function(){cr.add_common_aces=function(e,h){var r=e[1],z=e[3],N=e[4],k=e[5],a=e[6],c=e[7],l=e[8],q=e[10],p=e[11];e=e[12];h.cnds||(h.cnds={});h.acts||(h.acts={});h.exps||(h.exps={});var w=h.cnds,K=h.acts;h=h.exps;z&&(w.CompareX=function(A,J){return cr.do_cmp(this.x,A,J)},w.CompareY=function(A,J){return cr.do_cmp(this.y,A,J)},w.IsOnScreen=function(){var A=this.layer;this.update_bbox();var J=this.bbox;return!(J.right<A.viewLeft||J.bottom<A.viewTop||J.left>A.viewRight||J.top>A.viewBottom)},w.IsOutsideLayout=
function(){this.update_bbox();var A=this.bbox,J=this.runtime.running_layout;return 0>A.right||0>A.bottom||A.left>J.width||A.top>J.height},w.PickDistance=function(A,J,R){var n=this.getCurrentSol(),x=n.getObjects();if(!x.length)return!1;var E=x[0],V=E,Z=cr.distanceTo(E.x,E.y,J,R),M;var d=1;for(M=x.length;d<M;d++){E=x[d];var m=cr.distanceTo(E.x,E.y,J,R);if(0===A&&m<Z||1===A&&m>Z)Z=m,V=E}n.pick_one(V);return!0},K.SetX=function(A){this.x!==A&&(this.x=A,this.set_bbox_changed())},K.SetY=function(A){this.y!==
A&&(this.y=A,this.set_bbox_changed())},K.SetPos=function(A,J){if(this.x!==A||this.y!==J)this.x=A,this.y=J,this.set_bbox_changed()},K.SetPosToObject=function(A,J){var R=A.getPairedInstance(this);R&&(R.getImagePoint?(A=R.getImagePoint(J,!0),J=R.getImagePoint(J,!1)):(A=R.x,J=R.y),this.x!==A||this.y!==J)&&(this.x=A,this.y=J,this.set_bbox_changed())},K.MoveForward=function(A){0!==A&&(this.x+=Math.cos(this.angle)*A,this.y+=Math.sin(this.angle)*A,this.set_bbox_changed())},K.MoveAtAngle=function(A,J){0!==
J&&(this.x+=Math.cos(cr.to_radians(A))*J,this.y+=Math.sin(cr.to_radians(A))*J,this.set_bbox_changed())},h.X=function(A){A.set_float(this.x)},h.Y=function(A){A.set_float(this.y)},h.dt=function(A){A.set_float(this.runtime.getDt(this))});N&&(w.CompareWidth=function(A,J){return cr.do_cmp(this.width,A,J)},w.CompareHeight=function(A,J){return cr.do_cmp(this.height,A,J)},K.SetWidth=function(A){this.width!==A&&(this.width=A,this.set_bbox_changed())},K.SetHeight=function(A){this.height!==A&&(this.height=A,
this.set_bbox_changed())},K.SetSize=function(A,J){if(this.width!==A||this.height!==J)this.width=A,this.height=J,this.set_bbox_changed()},h.Width=function(A){A.set_float(this.width)},h.Height=function(A){A.set_float(this.height)},h.BBoxLeft=function(A){this.update_bbox();A.set_float(this.bbox.left)},h.BBoxTop=function(A){this.update_bbox();A.set_float(this.bbox.top)},h.BBoxRight=function(A){this.update_bbox();A.set_float(this.bbox.right)},h.BBoxBottom=function(A){this.update_bbox();A.set_float(this.bbox.bottom)});
k&&(w.AngleWithin=function(A,J){return cr.angleDiff(this.angle,cr.to_radians(J))<=cr.to_radians(A)},w.IsClockwiseFrom=function(A){return cr.angleClockwise(this.angle,cr.to_radians(A))},w.IsBetweenAngles=function(A,J){A=cr.to_clamped_radians(A);J=cr.to_clamped_radians(J);var R=cr.clamp_angle(this.angle);return cr.angleClockwise(J,A)?cr.angleClockwise(R,A)&&!cr.angleClockwise(R,J):!(!cr.angleClockwise(R,A)&&cr.angleClockwise(R,J))},K.SetAngle=function(A){A=cr.to_radians(cr.clamp_angle_degrees(A));isNaN(A)||
this.angle===A||(this.angle=A,this.set_bbox_changed())},K.RotateClockwise=function(A){0===A||isNaN(A)||(this.angle+=cr.to_radians(A),this.angle=cr.clamp_angle(this.angle),this.set_bbox_changed())},K.RotateCounterclockwise=function(A){0===A||isNaN(A)||(this.angle-=cr.to_radians(A),this.angle=cr.clamp_angle(this.angle),this.set_bbox_changed())},K.RotateTowardAngle=function(A,J){A=cr.angleRotate(this.angle,cr.to_radians(J),cr.to_radians(A));isNaN(A)||this.angle===A||(this.angle=A,this.set_bbox_changed())},
K.RotateTowardPosition=function(A,J,R){A=cr.angleRotate(this.angle,Math.atan2(R-this.y,J-this.x),cr.to_radians(A));isNaN(A)||this.angle===A||(this.angle=A,this.set_bbox_changed())},K.SetTowardPosition=function(A,J){A=Math.atan2(J-this.y,A-this.x);isNaN(A)||this.angle===A||(this.angle=A,this.set_bbox_changed())},h.Angle=function(A){A.set_float(cr.to_clamped_degrees(this.angle))});r||(w.CompareInstanceVar=function(A,J,R){return cr.do_cmp(this.instance_vars[A],J,R)},w.IsBoolInstanceVarSet=function(A){return this.instance_vars[A]},
w.PickInstVarHiLow=function(A,J){var R=this.getCurrentSol(),n=R.getObjects();if(!n.length)return!1;var x=n[0],E=x,V=x.instance_vars[J],Z;var M=1;for(Z=n.length;M<Z;M++){x=n[M];var d=x.instance_vars[J];if(0===A&&d<V||1===A&&d>V)V=d,E=x}R.pick_one(E);return!0},w.PickByUID=function(A){var J;if(this.runtime.getCurrentCondition().inverted){var R=this.getCurrentSol();if(R.select_all){R.select_all=!1;cr.clearArray(R.instances);cr.clearArray(R.else_instances);var n=this.instances;var x=0;for(J=n.length;x<
J;x++){var E=n[x];E.uid===A?R.else_instances.push(E):R.instances.push(E)}}else{n=x=0;for(J=R.instances.length;x<J;x++)E=R.instances[x],R.instances[n]=E,E.uid===A?R.else_instances.push(E):n++;cr.truncateArray(R.instances,n)}this.applySolToContainer();return!!R.instances.length}E=this.runtime.getObjectByUID(A);if(!E)return!1;R=this.getCurrentSol();if(!R.select_all&&-1===R.instances.indexOf(E))return!1;if(this.is_family)for(A=E.type.families,x=0,J=A.length;x<J;x++){if(A[x]===this)return R.pick_one(E),
this.applySolToContainer(),!0}else if(E.type===this)return R.pick_one(E),this.applySolToContainer(),!0;return!1},w.OnCreated=function(){return!0},w.OnDestroyed=function(){return!0},K.SetInstanceVar=function(A,J){var R=this.instance_vars;cr.is_number(R[A])?cr.is_number(J)?R[A]=J:R[A]=parseFloat(J):cr.is_string(R[A])&&(cr.is_string(J)?R[A]=J:R[A]=J.toString())},K.AddInstanceVar=function(A,J){var R=this.instance_vars;cr.is_number(R[A])?cr.is_number(J)?R[A]+=J:R[A]+=parseFloat(J):cr.is_string(R[A])&&
(cr.is_string(J)?R[A]+=J:R[A]+=J.toString())},K.SubInstanceVar=function(A,J){var R=this.instance_vars;cr.is_number(R[A])&&(cr.is_number(J)?R[A]-=J:R[A]-=parseFloat(J))},K.SetBoolInstanceVar=function(A,J){this.instance_vars[A]=J?1:0},K.ToggleBoolInstanceVar=function(A){this.instance_vars[A]=1-this.instance_vars[A]},K.Destroy=function(){this.runtime.DestroyInstance(this)},K.LoadFromJsonString||(K.LoadFromJsonString=function(A){try{var J=JSON.parse(A)}catch(n){return}this.runtime.loadInstanceFromJSON(this,
J,!0);this.afterLoad&&this.afterLoad();if(this.behavior_insts)for(A=0,J=this.behavior_insts.length;A<J;++A){var R=this.behavior_insts[A];R.afterLoad&&R.afterLoad()}}),h.Count=function(A){var J=A.object_class.instances.length,R;var n=0;for(R=this.runtime.createRow.length;n<R;n++){var x=this.runtime.createRow[n];A.object_class.is_family?0<=x.type.families.indexOf(A.object_class)&&J++:x.type===A.object_class&&J++}A.set_int(J)},h.PickedCount=function(A){A.set_int(A.object_class.getCurrentSol().getObjects().length)},
h.UID=function(A){A.set_int(this.uid)},h.IID=function(A){A.set_int(this.get_iid())},h.AsJSON||(h.AsJSON=function(A){A.set_string(JSON.stringify(this.runtime.saveInstanceToJSON(this,!0)))}));a&&(w.IsVisible=function(){return this.visible},K.SetVisible=function(A){A=2===A?!this.visible:0!==A;A!==this.visible&&(this.visible=A,this.runtime.redraw=!0)},w.CompareOpacity=function(A,J){return cr.do_cmp(cr.round6dp(100*this.opacity),A,J)},K.SetOpacity=function(A){A/=100;0>A?A=0:1<A&&(A=1);A!==this.opacity&&
(this.opacity=A,this.runtime.redraw=!0)},h.Opacity=function(A){A.set_float(cr.round6dp(100*this.opacity))});c&&(w.IsOnLayer=function(A){return A?this.layer===A:!1},w.PickTopBottom=function(A){var J=this.getCurrentSol(),R=J.getObjects();if(!R.length)return!1;var n=R[0],x=n,E;var V=1;for(E=R.length;V<E;V++)if(n=R[V],0===A){if(n.layer.index>x.layer.index||n.layer.index===x.layer.index&&n.get_zindex()>x.get_zindex())x=n}else if(n.layer.index<x.layer.index||n.layer.index===x.layer.index&&n.get_zindex()<
x.get_zindex())x=n;J.pick_one(x);return!0},K.MoveToTop=function(){var A=this.layer,J=A.instances;J.length&&J[J.length-1]===this||(A.removeFromInstanceList(this,!1),A.appendToInstanceList(this,!1),this.runtime.redraw=!0)},K.MoveToBottom=function(){var A=this.layer,J=A.instances;J.length&&J[0]===this||(A.removeFromInstanceList(this,!1),A.prependToInstanceList(this,!1),this.runtime.redraw=!0)},K.MoveToLayer=function(A){A&&A!=this.layer&&(this.layer.removeFromInstanceList(this,!0),this.layer=A,A.appendToInstanceList(this,
!0),this.runtime.redraw=!0)},K.ZMoveToObject=function(A,J){A=0===A;J&&(J=J.getFirstPicked(this))&&J.uid!==this.uid&&(this.layer.index!==J.layer.index&&(this.layer.removeFromInstanceList(this,!0),this.layer=J.layer,J.layer.appendToInstanceList(this,!0)),this.layer.moveInstanceAdjacent(this,J,A),this.runtime.redraw=!0)},h.LayerNumber=function(A){A.set_int(this.layer.number)},h.LayerName=function(A){A.set_string(this.layer.name)},h.ZIndex=function(A){A.set_int(this.get_zindex())});l&&(K.SetEffectEnabled=
function(A,J){this.runtime.glwrap&&(J=this.type.getEffectIndexByName(J),0>J||(A=1===A,this.active_effect_flags[J]!==A&&(this.active_effect_flags[J]=A,this.updateActiveEffects(),this.runtime.redraw=!0)))},K.SetEffectParam=function(A,J,R){if(this.runtime.glwrap){var n=this.type.getEffectIndexByName(A);if(!(0>n||(A=this.type.effect_types[n],n=this.effect_params[n],J=Math.floor(J),0>J||J>=n.length))){var x=this.runtime.glwrap.getProgramParameterType(A.shaderindex,J);1===x&&(R/=100);if(2===x){x=cr.GetRValue(R);
var E=cr.GetGValue(R);R=cr.GetBValue(R);J=n[J];if(J[0]===x&&J[1]===E&&J[2]===R)return;J[0]=x;J[1]=E;J[2]=R}else{if(n[J]===R)return;n[J]=R}A.active&&(this.runtime.redraw=!0)}}});q&&(K.SetVisible=function(A){this.visible=0!==A},K.SetCSSStyle=function(A,J){this.elem.style[cr.cssToCamelCase(A)]=J});p&&(K.SetFocus=function(){(this.inputElem||this.elem).focus()},K.SetBlur=function(){(this.inputElem||this.elem).blur()});e&&(K.SetEnabled=function(A){(this.inputElem||this.elem).disabled=0===A})};cr.set_bbox_changed=
function(){this.cell_changed=this.bbox_changed=!0;this.type.any_cell_changed=!0;this.runtime.redraw=!0;var e,h=this.bbox_changed_callbacks;var r=0;for(e=h.length;r<e;++r)h[r](this);this.layer.useRenderCells&&this.update_bbox()};cr.add_bbox_changed_callback=function(e){e&&this.bbox_changed_callbacks.push(e)};cr.update_bbox=function(){if(this.bbox_changed){var e=this.bbox,h=this.bquad;e.set(this.x,this.y,this.x+this.width,this.y+this.height);e.offset(-this.hotspotX*this.width,-this.hotspotY*this.height);
this.angle?(e.offset(-this.x,-this.y),h.set_from_rotated_rect(e,this.angle),h.offset(this.x,this.y),h.bounding_box(e)):h.set_from_rect(e);e.normalize();this.bbox_changed=!1;this.update_render_cell()}};var b=new cr.rect(0,0,0,0);cr.update_render_cell=function(){if(this.layer.useRenderCells){var e=this.layer.render_grid,h=this.bbox;b.set(e.XToCell(h.left),e.YToCell(h.top),e.XToCell(h.right),e.YToCell(h.bottom));this.rendercells.equals(b)||(this.rendercells.right<this.rendercells.left?e.update(this,
null,b):e.update(this,this.rendercells,b),this.rendercells.copy(b),this.layer.render_list_stale=!0)}};cr.update_collision_cell=function(){if(this.cell_changed&&this.collisionsEnabled){this.update_bbox();var e=this.type.collision_grid,h=this.bbox;b.set(e.XToCell(h.left),e.YToCell(h.top),e.XToCell(h.right),e.YToCell(h.bottom));this.collcells.equals(b)||(this.collcells.right<this.collcells.left?e.update(this,null,b):e.update(this,this.collcells,b),this.collcells.copy(b),this.cell_changed=!1)}};cr.inst_contains_pt=
function(e,h){return this.bbox.contains_pt(e,h)&&this.bquad.contains_pt(e,h)?this.tilemap_exists?this.testPointOverlapTile(e,h):this.collision_poly&&!this.collision_poly.is_empty()?(this.collision_poly.cache_poly(this.width,this.height,this.angle),this.collision_poly.contains_pt(e-this.x,h-this.y)):!0:!1};cr.inst_get_iid=function(){this.type.updateIIDs();return this.iid};cr.inst_get_zindex=function(){this.layer.updateZIndices();return this.zindex};cr.inst_updateActiveEffects=function(){cr.clearArray(this.active_effect_types);
var e,h=!0;var r=0;for(e=this.active_effect_flags.length;r<e;r++)if(this.active_effect_flags[r]){var z=this.type.effect_types[r];this.active_effect_types.push(z);z.preservesOpaqueness||(h=!1)}this.uses_shaders=!!this.active_effect_types.length;this.shaders_preserve_opaqueness=h};cr.inst_toString=function(){return"Inst"+this.puid};cr.type_getFirstPicked=function(e){if(e&&e.is_contained&&e.type!=this){var h;var r=0;for(h=e.siblings.length;r<h;r++){var z=e.siblings[r];if(z.type==this)return z}}e=this.getCurrentSol().getObjects();
return e.length?e[0]:null};cr.type_getPairedInstance=function(e){var h=this.getCurrentSol().getObjects();return h.length?h[e.get_iid()%h.length]:null};cr.type_updateIIDs=function(){if(this.stale_iids&&!this.is_family){var e;var h=0;for(e=this.instances.length;h<e;h++)this.instances[h].iid=h;var r=h,z=this.runtime.createRow;h=0;for(e=z.length;h<e;++h)z[h].type===this&&(z[h].iid=r++);this.stale_iids=!1}};cr.type_getInstanceByIID=function(e){if(e<this.instances.length)return this.instances[e];e-=this.instances.length;
var h=this.runtime.createRow,r;var z=0;for(r=h.length;z<r;++z)if(h[z].type===this){if(0===e)return h[z];--e}return null};cr.type_getCurrentSol=function(){return this.solstack[this.cur_sol]};cr.type_pushCleanSol=function(){this.cur_sol++;this.cur_sol===this.solstack.length?this.solstack.push(new cr.selection(this)):(this.solstack[this.cur_sol].select_all=!0,cr.clearArray(this.solstack[this.cur_sol].else_instances))};cr.type_pushCopySol=function(){this.cur_sol++;this.cur_sol===this.solstack.length&&
this.solstack.push(new cr.selection(this));var e=this.solstack[this.cur_sol],h=this.solstack[this.cur_sol-1];h.select_all?e.select_all=!0:(e.select_all=!1,cr.shallowAssignArray(e.instances,h.instances));cr.clearArray(e.else_instances)};cr.type_popSol=function(){this.cur_sol--};cr.type_getBehaviorByName=function(e){var h,r,z=0;if(!this.is_family){var N=0;for(h=this.families.length;N<h;N++){var k=this.families[N];var a=0;for(r=k.behaviors.length;a<r;a++){if(e===k.behaviors[a].name)return this.extra.lastBehIndex=
z,k.behaviors[a];z++}}}N=0;for(h=this.behaviors.length;N<h;N++){if(e===this.behaviors[N].name)return this.extra.lastBehIndex=z,this.behaviors[N];z++}return null};cr.type_getBehaviorIndexByName=function(e){return this.getBehaviorByName(e)?this.extra.lastBehIndex:-1};cr.type_getEffectIndexByName=function(e){var h;var r=0;for(h=this.effect_types.length;r<h;r++)if(this.effect_types[r].name===e)return r;return-1};cr.type_applySolToContainer=function(){if(this.is_contained&&!this.is_family){var e,h,r;this.updateIIDs();
var z=this.getCurrentSol();var N=z.select_all,k=(e=this.runtime.getCurrentEventStack())&&e.current_event&&e.current_event.orblock;e=0;for(h=this.container.length;e<h;e++){var a=this.container[e];if(a!==this){a.updateIIDs();var c=a.getCurrentSol();c.select_all=N;if(!N){cr.clearArray(c.instances);var l=0;for(r=z.instances.length;l<r;++l)c.instances[l]=a.getInstanceByIID(z.instances[l].iid);if(k)for(cr.clearArray(c.else_instances),l=0,r=z.else_instances.length;l<r;++l)c.else_instances[l]=a.getInstanceByIID(z.else_instances[l].iid)}}}}};
cr.type_toString=function(){return"Type"+this.sid};cr.do_cmp=function(e,h,r){if("undefined"===typeof e||"undefined"===typeof r)return!1;switch(h){case 0:return e===r;case 1:return e!==r;case 2:return e<r;case 3:return e<=r;case 4:return e>r;case 5:return e>=r;default:return!1}}})();cr.shaders={};cr.plugins_.Sprite=function(b){this.runtime=b};
(function(){function b(){if(0===this.datauri.length){var M=document.createElement("canvas");M.width=this.width;M.height=this.height;var d=M.getContext("2d");this.spritesheeted?d.drawImage(this.texture_img,this.offx,this.offy,this.width,this.height,0,0,this.width,this.height):d.drawImage(this.texture_img,0,0,this.width,this.height);this.datauri=M.toDataURL("image/png")}return this.datauri}function e(){}function h(M){M[0]=0;M[1]=0;M[2]=0;A.push(M)}function r(M,d){return M<d?""+M+","+d:""+d+","+M}function z(M,
d,m,G){d=d.uid;m=m.uid;var f=r(d,m);if(M.hasOwnProperty(f))M[f][2]=G;else{var y=A.length?A.pop():[0,0,0];y[0]=d;y[1]=m;y[2]=G;M[f]=y}}function N(M,d,m){d=r(d.uid,m.uid);M.hasOwnProperty(d)&&(h(M[d]),delete M[d])}function k(M,d,m){d=r(d.uid,m.uid);if(M.hasOwnProperty(d))return J=M[d][2],!0;J=-2;return!1}function a(M,d,m){if(!M)return!1;var G=0!==d||0!==m,f=!1,y=this.runtime.getCurrentCondition(),L=y.type;y=y.inverted;var P=M.getCurrentSol();var X=this.runtime.getCurrentEventStack().current_event.orblock;
P.select_all?(this.update_bbox(),Z.copy(this.bbox),Z.offset(d,m),this.runtime.getCollisionCandidates(this.layer,M,Z,V),P=V):P=X?this.runtime.isCurrentConditionFirst()&&!P.else_instances.length&&P.instances.length?P.instances:P.else_instances:P.instances;n=M;E=L!==M&&!y;if(G){var ba=this.x;var aa=this.y;this.x+=d;this.y+=m;this.set_bbox_changed()}d=0;for(m=P.length;d<m;d++)if(X=P[d],this.runtime.testOverlap(this,X)){f=!0;if(y)break;L!==M&&x.add(X)}G&&(this.x=ba,this.y=aa,this.set_bbox_changed());cr.clearArray(V);
return f}function c(){}function l(){}var q=cr.plugins_.Sprite.prototype;q.Type=function(M){this.plugin=M;this.runtime=M.runtime};var p=q.Type.prototype;p.onCreate=function(){if(!this.is_family){var M,d;this.all_frames=[];this.has_loaded_textures=!1;var m=0;for(M=this.animations.length;m<M;m++){var G=this.animations[m];var f={};f.name=G[0];f.speed=G[1];f.loop=G[2];f.repeatcount=G[3];f.repeatto=G[4];f.pingpong=G[5];f.sid=G[6];f.frames=[];var y=0;for(d=G[7].length;y<d;y++){var L=G[7][y];var P={};P.texture_file=
L[0];P.texture_filesize=L[1];P.offx=L[2];P.offy=L[3];P.width=L[4];P.height=L[5];P.duration=L[6];P.hotspotX=L[7];P.hotspotY=L[8];P.image_points=L[9];P.poly_pts=L[10];P.pixelformat=L[11];P.spritesheeted=0!==P.width;P.datauri="";P.getDataUri=b;var X={left:0,top:0,right:1,bottom:1};P.sheetTex=X;P.webGL_texture=null;(X=this.runtime.findWaitingTexture(L[0]))?P.texture_img=X:(P.texture_img=new Image,P.texture_img.cr_src=L[0],P.texture_img.cr_filesize=L[1],P.texture_img.c2webGL_texture=null,this.runtime.waitForImageLoad(P.texture_img,
L[0]));cr.seal(P);f.frames.push(P);this.all_frames.push(P)}cr.seal(f);this.animations[m]=f}}};p.updateAllCurrentTexture=function(){var M;var d=0;for(M=this.instances.length;d<M;d++){var m=this.instances[d];m.curWebGLTexture=m.curFrame.webGL_texture}};p.onLostWebGLContext=function(){if(!this.is_family){var M;var d=0;for(M=this.all_frames.length;d<M;++d){var m=this.all_frames[d];m.texture_img.c2webGL_texture=null;m.webGL_texture=null}this.has_loaded_textures=!1;this.updateAllCurrentTexture()}};p.onRestoreWebGLContext=
function(){if(!this.is_family&&this.instances.length){var M;var d=0;for(M=this.all_frames.length;d<M;++d){var m=this.all_frames[d];m.webGL_texture=this.runtime.glwrap.loadTexture(m.texture_img,!1,this.runtime.linearSampling,m.pixelformat)}this.updateAllCurrentTexture()}};p.loadTextures=function(){if(!this.is_family&&!this.has_loaded_textures&&this.runtime.glwrap){var M;var d=0;for(M=this.all_frames.length;d<M;++d){var m=this.all_frames[d];m.webGL_texture=this.runtime.glwrap.loadTexture(m.texture_img,
!1,this.runtime.linearSampling,m.pixelformat)}this.has_loaded_textures=!0}};p.unloadTextures=function(){if(!this.is_family&&!this.instances.length&&this.has_loaded_textures){var M;var d=0;for(M=this.all_frames.length;d<M;++d){var m=this.all_frames[d];this.runtime.glwrap.deleteTexture(m.webGL_texture);m.webGL_texture=null}this.has_loaded_textures=!1}};var w=[];p.preloadCanvas2D=function(M){var d;cr.clearArray(w);var m=0;for(d=this.all_frames.length;m<d;++m){var G=this.all_frames[m].texture_img;-1===
w.indexOf(G)&&(M.drawImage(G,0,0),w.push(G))}};q.Instance=function(M){this.type=M;this.runtime=M.runtime;M=this.type.animations[0].frames[0].poly_pts;this.recycled?this.collision_poly.set_pts(M):this.collision_poly=new cr.CollisionPoly(M)};var K=q.Instance.prototype;K.onCreate=function(){this.visible=this.properties[0];this.inAnimTrigger=this.isTicking=!1;this.collisionsEnabled=this.properties[3];this.cur_animation=this.getAnimationByName(this.properties[1])||this.type.animations[0];this.cur_frame=
this.properties[2];0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);var M=this.cur_animation.frames[this.cur_frame];this.collision_poly.set_pts(M.poly_pts);this.hotspotX=M.hotspotX;this.hotspotY=M.hotspotY;this.animForwards=0<=this.cur_animation.speed;this.cur_anim_speed=Math.abs(this.cur_animation.speed);this.cur_anim_repeatto=this.cur_animation.repeatto;1===this.type.animations.length&&1===this.type.animations[0].frames.length||
0===this.cur_anim_speed||(this.runtime.tickMe(this),this.isTicking=!0);this.recycled?this.animTimer.reset():this.animTimer=new cr.KahanAdder;this.frameStart=this.getNowTime();this.animPlaying=!0;this.animRepeats=0;this.changeAnimName=this.animTriggerName="";this.changeAnimFrom=0;this.changeAnimFrame=-1;this.type.loadTextures();var d,m;M=0;for(d=this.type.animations.length;M<d;M++){var G=this.type.animations[M];var f=0;for(m=G.frames.length;f<m;f++){var y=G.frames[f];0===y.width&&(y.width=y.texture_img.width,
y.height=y.texture_img.height);if(y.spritesheeted){var L=y.texture_img;var P=y.sheetTex;P.left=y.offx/L.width;P.top=y.offy/L.height;P.right=(y.offx+y.width)/L.width;P.bottom=(y.offy+y.height)/L.height;0===y.offx&&0===y.offy&&y.width===L.width&&y.height===L.height&&(y.spritesheeted=!1)}}}this.curFrame=this.cur_animation.frames[this.cur_frame];this.curWebGLTexture=this.curFrame.webGL_texture};K.saveToJSON=function(){var M={a:this.cur_animation.sid,f:this.cur_frame,cas:this.cur_anim_speed,fs:this.frameStart,
ar:this.animRepeats,at:this.animTimer.sum,rt:this.cur_anim_repeatto};this.animPlaying||(M.ap=this.animPlaying);this.animForwards||(M.af=this.animForwards);return M};K.loadFromJSON=function(M){var d=this.getAnimationBySid(M.a);d&&(this.cur_animation=d);this.cur_frame=M.f;0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);this.cur_anim_speed=M.cas;this.frameStart=M.fs;this.animRepeats=M.ar;this.animTimer.reset();
this.animTimer.sum=M.at;this.animPlaying=M.hasOwnProperty("ap")?M.ap:!0;this.animForwards=M.hasOwnProperty("af")?M.af:!0;M.hasOwnProperty("rt")?this.cur_anim_repeatto=M.rt:this.cur_anim_repeatto=this.cur_animation.repeatto;this.curFrame=this.cur_animation.frames[this.cur_frame];this.curWebGLTexture=this.curFrame.webGL_texture;this.collision_poly.set_pts(this.curFrame.poly_pts);this.hotspotX=this.curFrame.hotspotX;this.hotspotY=this.curFrame.hotspotY};K.animationFinish=function(M){this.cur_frame=M?
0:this.cur_animation.frames.length-1;this.animPlaying=!1;this.animTriggerName=this.cur_animation.name;this.inAnimTrigger=!0;this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnAnyAnimFinished,this);this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnAnimFinished,this);this.inAnimTrigger=!1;this.animRepeats=0};K.getNowTime=function(){return this.animTimer.sum};K.tick=function(){this.animTimer.add(this.runtime.getDt(this));this.changeAnimName.length&&this.doChangeAnim();0<=this.changeAnimFrame&&
this.doChangeAnimFrame();var M=this.getNowTime(),d=this.cur_animation,m=d.frames[this.cur_frame],G=m.duration/this.cur_anim_speed;this.animPlaying&&M>=this.frameStart+G&&(this.animForwards?this.cur_frame++:this.cur_frame--,this.frameStart+=G,this.cur_frame>=d.frames.length&&(d.pingpong?(this.animForwards=!1,this.cur_frame=d.frames.length-2):d.loop?this.cur_frame=this.cur_anim_repeatto:(this.animRepeats++,this.animRepeats>=d.repeatcount?this.animationFinish(!1):this.cur_frame=this.cur_anim_repeatto)),
0>this.cur_frame&&(d.pingpong?(this.cur_frame=1,this.animForwards=!0,d.loop||(this.animRepeats++,this.animRepeats>=d.repeatcount&&this.animationFinish(!0))):d.loop?this.cur_frame=this.cur_anim_repeatto:(this.animRepeats++,this.animRepeats>=d.repeatcount?this.animationFinish(!0):this.cur_frame=this.cur_anim_repeatto)),0>this.cur_frame?this.cur_frame=0:this.cur_frame>=d.frames.length&&(this.cur_frame=d.frames.length-1),M>this.frameStart+d.frames[this.cur_frame].duration/this.cur_anim_speed&&(this.frameStart=
M),M=d.frames[this.cur_frame],this.OnFrameChanged(m,M),this.runtime.redraw=!0)};K.getAnimationByName=function(M){var d;var m=0;for(d=this.type.animations.length;m<d;m++){var G=this.type.animations[m];if(cr.equals_nocase(G.name,M))return G}return null};K.getAnimationBySid=function(M){var d;var m=0;for(d=this.type.animations.length;m<d;m++){var G=this.type.animations[m];if(G.sid===M)return G}return null};K.doChangeAnim=function(){var M=this.cur_animation.frames[this.cur_frame],d=this.getAnimationByName(this.changeAnimName);
this.changeAnimName="";!d||cr.equals_nocase(d.name,this.cur_animation.name)&&this.animPlaying||(this.cur_animation=d,this.animForwards=0<=d.speed,this.cur_anim_speed=Math.abs(d.speed),this.cur_anim_repeatto=d.repeatto,0>this.cur_frame&&(this.cur_frame=0),this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1),1===this.changeAnimFrom&&(this.cur_frame=0),this.animPlaying=!0,this.frameStart=this.getNowTime(),this.OnFrameChanged(M,this.cur_animation.frames[this.cur_frame]),
this.runtime.redraw=!0)};K.doChangeAnimFrame=function(){var M=this.cur_animation.frames[this.cur_frame],d=this.cur_frame;this.cur_frame=cr.floor(this.changeAnimFrame);0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);d!==this.cur_frame&&(this.OnFrameChanged(M,this.cur_animation.frames[this.cur_frame]),this.frameStart=this.getNowTime(),this.runtime.redraw=!0);this.changeAnimFrame=-1};K.OnFrameChanged=function(M,
d){var m=M.width,G=M.height,f=d.width,y=d.height;m!=f&&(this.width*=f/m);G!=y&&(this.height*=y/G);this.hotspotX=d.hotspotX;this.hotspotY=d.hotspotY;this.collision_poly.set_pts(d.poly_pts);this.set_bbox_changed();this.curFrame=d;this.curWebGLTexture=d.webGL_texture;m=0;for(G=this.behavior_insts.length;m<G;m++)if(f=this.behavior_insts[m],f.onSpriteFrameChanged)f.onSpriteFrameChanged(M,d);this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnFrameChanged,this)};K.draw=function(M){M.globalAlpha=this.opacity;
var d=this.curFrame,m=d.spritesheeted,G=d.texture_img,f=this.x,y=this.y,L=this.width,P=this.height;if(0===this.angle&&0<=L&&0<=P)f-=this.hotspotX*L,y-=this.hotspotY*P,this.runtime.pixel_rounding&&(f=Math.round(f),y=Math.round(y)),m?M.drawImage(G,d.offx,d.offy,d.width,d.height,f,y,L,P):M.drawImage(G,f,y,L,P);else{this.runtime.pixel_rounding&&(f=Math.round(f),y=Math.round(y));M.save();var X=0<L?1:-1,ba=0<P?1:-1;M.translate(f,y);1===X&&1===ba||M.scale(X,ba);M.rotate(this.angle*X*ba);f=-(this.hotspotX*
cr.abs(L));y=-(this.hotspotY*cr.abs(P));m?M.drawImage(G,d.offx,d.offy,d.width,d.height,f,y,cr.abs(L),cr.abs(P)):M.drawImage(G,f,y,cr.abs(L),cr.abs(P));M.restore()}};K.drawGL_earlyZPass=function(M){this.drawGL(M)};K.drawGL=function(M){M.setTexture(this.curWebGLTexture);M.setOpacity(this.opacity);var d=this.curFrame,m=this.bquad;if(this.runtime.pixel_rounding){var G=Math.round(this.x)-this.x,f=Math.round(this.y)-this.y;d.spritesheeted?M.quadTex(m.tlx+G,m.tly+f,m.trx+G,m.try_+f,m.brx+G,m.bry+f,m.blx+
G,m.bly+f,d.sheetTex):M.quad(m.tlx+G,m.tly+f,m.trx+G,m.try_+f,m.brx+G,m.bry+f,m.blx+G,m.bly+f)}else d.spritesheeted?M.quadTex(m.tlx,m.tly,m.trx,m.try_,m.brx,m.bry,m.blx,m.bly,d.sheetTex):M.quad(m.tlx,m.tly,m.trx,m.try_,m.brx,m.bry,m.blx,m.bly)};K.getImagePointIndexByName=function(M){var d=this.curFrame,m;var G=0;for(m=d.image_points.length;G<m;G++)if(cr.equals_nocase(M,d.image_points[G][0]))return G;return-1};K.getImagePoint=function(M,d){var m=this.curFrame,G=m.image_points;var f=cr.is_string(M)?
this.getImagePointIndexByName(M):M-1;f=cr.floor(f);if(0>f||f>=G.length)return d?this.x:this.y;M=(G[f][1]-m.hotspotX)*this.width;G=G[f][2];G=(G-m.hotspotY)*this.height;m=Math.cos(this.angle);f=Math.sin(this.angle);var y=M*m-G*f;G=G*m+M*f;M=y+this.x;G+=this.y;return d?M:G};var A=[],J=-2,R=[];e.prototype.OnCollision=function(M){if(!M)return!1;var d=this.runtime,m=d.getCurrentCondition(),G=m.type,f=null;m.extra.collmemory?f=m.extra.collmemory:(f={},m.extra.collmemory=f);m.extra.spriteCreatedDestroyCallback||
(m.extra.spriteCreatedDestroyCallback=!0,d.addDestroyCallback(function(I){var B=m.extra.collmemory;I=I.uid;var t;for(t in B)if(B.hasOwnProperty(t)){var C=B[t];if(C[0]===I||C[1]===I)h(B[t]),delete B[t]}}));var y=G.getCurrentSol(),L=M.getCurrentSol();y=y.getObjects();var P,X,ba=this.runtime.tickcount,aa=ba-1,ca=d.getCurrentEventStack().current_event;for(P=0;P<y.length;P++){var ja=y[P];if(L.select_all){ja.update_bbox();this.runtime.getCollisionCandidates(ja.layer,M,ja.bbox,R);var ha=R;this.runtime.addRegisteredCollisionCandidates(ja,
M,ha)}else ha=L.getObjects();for(X=0;X<ha.length;X++){var g=ha[X];if(d.testOverlap(ja,g)||d.checkRegisteredCollision(ja,g)){var u=k(f,ja,g);u=!u||J<aa;z(f,ja,g,ba);if(u){d.pushCopySol(ca.solModifiers);u=G.getCurrentSol();var D=M.getCurrentSol();u.select_all=!1;D.select_all=!1;G===M?(u.instances.length=2,u.instances[0]=ja,u.instances[1]=g,G.applySolToContainer()):(u.instances.length=1,D.instances.length=1,u.instances[0]=ja,D.instances[0]=g,G.applySolToContainer(),M.applySolToContainer());ca.retrigger();
d.popSol(ca.solModifiers)}}else N(f,ja,g)}cr.clearArray(R)}return!1};var n=null,x=new cr.ObjectSet,E=!1,V=[],Z=new cr.rect(0,0,0,0);p.finish=function(M){if(E){if(M){var d=this.runtime.getCurrentEventStack().current_event.orblock;M=n.getCurrentSol();var m=x.valuesRef(),G;if(M.select_all){M.select_all=!1;cr.clearArray(M.instances);var f=0;for(G=m.length;f<G;++f)M.instances[f]=m[f];if(d)for(cr.clearArray(M.else_instances),f=0,G=n.instances.length;f<G;++f)m=n.instances[f],x.contains(m)||M.else_instances.push(m)}else if(d)for(d=
M.instances.length,f=0,G=m.length;f<G;++f)M.instances[d+f]=m[f],cr.arrayFindRemove(M.else_instances,m[f]);else cr.shallowAssignArray(M.instances,m);n.applySolToContainer()}x.clear();E=!1}};e.prototype.IsOverlapping=function(M){return a.call(this,M,0,0)};e.prototype.IsOverlappingOffset=function(M,d,m){return a.call(this,M,d,m)};e.prototype.IsAnimPlaying=function(M){return this.changeAnimName.length?cr.equals_nocase(this.changeAnimName,M):cr.equals_nocase(this.cur_animation.name,M)};e.prototype.CompareFrame=
function(M,d){return cr.do_cmp(this.cur_frame,M,d)};e.prototype.CompareAnimSpeed=function(M,d){return cr.do_cmp(this.animForwards?this.cur_anim_speed:-this.cur_anim_speed,M,d)};e.prototype.OnAnimFinished=function(M){return cr.equals_nocase(this.animTriggerName,M)};e.prototype.OnAnyAnimFinished=function(){return!0};e.prototype.OnFrameChanged=function(){return!0};e.prototype.IsMirrored=function(){return 0>this.width};e.prototype.IsFlipped=function(){return 0>this.height};e.prototype.OnURLLoaded=function(){return!0};
e.prototype.IsCollisionEnabled=function(){return this.collisionsEnabled};q.cnds=new e;c.prototype.Spawn=function(M,d,m){if(M&&d&&(d=this.runtime.createInstance(M,d,this.getImagePoint(m,!0),this.getImagePoint(m,!1)))){"undefined"!==typeof d.angle&&(d.angle=this.angle,d.set_bbox_changed());this.runtime.isInOnDestroy++;var G;this.runtime.trigger(Object.getPrototypeOf(M.plugin).cnds.OnCreated,d);if(d.is_contained){var f=0;for(G=d.siblings.length;f<G;f++){var y=d.siblings[f];this.runtime.trigger(Object.getPrototypeOf(y.type.plugin).cnds.OnCreated,
y)}}this.runtime.isInOnDestroy--;f=this.runtime.getCurrentAction();m=!1;if(cr.is_undefined(f.extra.Spawn_LastExec)||f.extra.Spawn_LastExec<this.runtime.execcount)m=!0,f.extra.Spawn_LastExec=this.runtime.execcount;if(M!=this.type&&(M=M.getCurrentSol(),M.select_all=!1,m?(cr.clearArray(M.instances),M.instances[0]=d):M.instances.push(d),d.is_contained))for(f=0,G=d.siblings.length;f<G;f++)y=d.siblings[f],M=y.type.getCurrentSol(),M.select_all=!1,m?(cr.clearArray(M.instances),M.instances[0]=y):M.instances.push(y)}};
c.prototype.SetEffect=function(M){this.blend_mode=M;this.compositeOp=cr.effectToCompositeOp(M);cr.setGLBlend(this,M,this.runtime.gl);this.runtime.redraw=!0};c.prototype.StopAnim=function(){this.animPlaying=!1};c.prototype.StartAnim=function(M){this.animPlaying=!0;this.frameStart=this.getNowTime();1===M&&0!==this.cur_frame&&(this.changeAnimFrame=0,this.inAnimTrigger||this.doChangeAnimFrame());this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0)};c.prototype.SetAnim=function(M,d){this.changeAnimName=
M;this.changeAnimFrom=d;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0);this.inAnimTrigger||this.doChangeAnim()};c.prototype.SetAnimFrame=function(M){this.changeAnimFrame=M;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0);this.inAnimTrigger||this.doChangeAnimFrame()};c.prototype.SetAnimSpeed=function(M){this.cur_anim_speed=cr.abs(M);this.animForwards=0<=M;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0)};c.prototype.SetAnimRepeatToFrame=function(M){M=Math.floor(M);
0>M&&(M=0);M>=this.cur_animation.frames.length&&(M=this.cur_animation.frames.length-1);this.cur_anim_repeatto=M};c.prototype.SetMirrored=function(M){M=cr.abs(this.width)*(0===M?-1:1);this.width!==M&&(this.width=M,this.set_bbox_changed())};c.prototype.SetFlipped=function(M){M=cr.abs(this.height)*(0===M?-1:1);this.height!==M&&(this.height=M,this.set_bbox_changed())};c.prototype.SetScale=function(M){var d=this.curFrame,m=d.width*M*(0>this.width?-1:1);M=d.height*M*(0>this.height?-1:1);if(this.width!==
m||this.height!==M)this.width=m,this.height=M,this.set_bbox_changed()};c.prototype.LoadURL=function(M,d,m){var G=new Image,f=this,y=this.curFrame;G.onload=function(){y.texture_img.src===G.src?f.runtime.glwrap&&f.curFrame===y&&(f.curWebGLTexture=y.webGL_texture):(y.texture_img=G,y.offx=0,y.offy=0,y.width=G.width,y.height=G.height,y.spritesheeted=!1,y.datauri="",y.pixelformat=0,f.runtime.glwrap&&(y.webGL_texture&&f.runtime.glwrap.deleteTexture(y.webGL_texture),y.webGL_texture=f.runtime.glwrap.loadTexture(G,
!1,f.runtime.linearSampling),f.curFrame===y&&(f.curWebGLTexture=y.webGL_texture),f.type.updateAllCurrentTexture()));0===d&&(f.width=G.width,f.height=G.height,f.set_bbox_changed());f.runtime.redraw=!0;f.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnURLLoaded,f)};"data:"!==M.substr(0,5)&&0===m&&(G.crossOrigin="anonymous");this.runtime.setImageSrc(G,M)};c.prototype.SetCollisions=function(M){this.collisionsEnabled!==(0!==M)&&((this.collisionsEnabled=0!==M)?this.set_bbox_changed():(this.collcells.right>=
this.collcells.left&&this.type.collision_grid.update(this,this.collcells,null),this.collcells.set(0,0,-1,-1)))};q.acts=new c;l.prototype.AnimationFrame=function(M){M.set_int(this.cur_frame)};l.prototype.AnimationFrameCount=function(M){M.set_int(this.cur_animation.frames.length)};l.prototype.AnimationName=function(M){M.set_string(this.cur_animation.name)};l.prototype.AnimationSpeed=function(M){M.set_float(this.animForwards?this.cur_anim_speed:-this.cur_anim_speed)};l.prototype.ImagePointX=function(M,
d){M.set_float(this.getImagePoint(d,!0))};l.prototype.ImagePointY=function(M,d){M.set_float(this.getImagePoint(d,!1))};l.prototype.ImagePointCount=function(M){M.set_int(this.curFrame.image_points.length)};l.prototype.ImageWidth=function(M){M.set_float(this.curFrame.width)};l.prototype.ImageHeight=function(M){M.set_float(this.curFrame.height)};q.exps=new l})();cr.plugins_.Touch=function(b){this.runtime=b};
(function(){function b(n){l=n.x;q=n.y;p=n.z}function e(n,x,E,V){var Z=w.length?w.pop():new h;Z.init(n,x,E,V);return Z}function h(){this.startindex=this.id=this.lasty=this.lastx=this.y=this.x=this.starty=this.startx=this.lasttime=this.time=this.starttime=0;this.tooFarForHold=this.triggeredHold=!1}function r(n){return n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents||n.originalEvent&&n.originalEvent.sourceCapabilities&&n.originalEvent.sourceCapabilities.firesTouchEvents}function z(){}function N(){}
function k(){}var a=cr.plugins_.Touch.prototype;a.Type=function(n){this.plugin=n;this.runtime=n.runtime};a.Type.prototype.onCreate=function(){};a.Instance=function(n){this.type=n;this.runtime=n.runtime;this.touches=[];this.mouseDown=!1};var c=a.Instance.prototype;c.findTouch=function(n){var x;var E=0;for(x=this.touches.length;E<x;E++)if(this.touches[E].id===n)return E;return-1};var l=0,q=0,p=0,w=[];h.prototype.init=function(n,x,E,V){var Z=cr.performance_now();this.starttime=this.lasttime=this.time=
Z;this.startx=n;this.starty=x;this.x=n;this.y=x;this.lastx=n;this.lasty=x;this.pressure=this.height=this.width=0;this.id=E;this.startindex=V;this.tooFarForHold=this.triggeredHold=!1};h.prototype.update=function(n,x,E,V,Z,M){this.lasttime=this.time;this.time=n;this.lastx=this.x;this.lasty=this.y;this.x=x;this.y=E;this.width=V;this.height=Z;this.pressure=M;!this.tooFarForHold&&15<=cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(this.tooFarForHold=!0)};h.prototype.maybeTriggerHold=function(n,
x){!this.triggeredHold&&500<=cr.performance_now()-this.starttime&&!this.tooFarForHold&&15>cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(this.triggeredHold=!0,n.trigger_index=this.startindex,n.trigger_id=this.id,n.getTouchIndex=x,n.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnHoldGesture,n),n.curTouchX=this.x,n.curTouchY=this.y,n.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnHoldGestureObject,n),n.getTouchIndex=0)};var K=-1E3,A=-1E3,J=-1E4;h.prototype.maybeTriggerTap=function(n,
x){if(!this.triggeredHold){var E=cr.performance_now();333>=E-this.starttime&&!this.tooFarForHold&&15>cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(n.trigger_index=this.startindex,n.trigger_id=this.id,n.getTouchIndex=x,666>=E-J&&25>cr.distanceTo(K,A,this.x,this.y)?(n.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnDoubleTapGesture,n),n.curTouchX=this.x,n.curTouchY=this.y,n.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnDoubleTapGestureObject,n),A=K=-1E3,J=-1E4):(n.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTapGesture,
n),n.curTouchX=this.x,n.curTouchY=this.y,n.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTapGestureObject,n),K=this.x,A=this.y,J=E),n.getTouchIndex=0)}};c.onCreate=function(){this.isWindows8=!("undefined"===typeof window.c2isWindows8||!window.c2isWindows8);this.getTouchIndex=this.trigger_permission=this.trigger_id=this.trigger_index=this.curTouchY=this.curTouchX=this.acc_z=this.acc_y=this.acc_x=this.acc_g_z=this.acc_g_y=this.acc_g_x=this.orient_gamma=this.orient_beta=this.orient_alpha=0;this.useMouseInput=
this.properties[0];var n=0<this.runtime.fullscreen_mode?document:this.runtime.canvas,x=document,E=this;"undefined"!==typeof PointerEvent?(n.addEventListener("pointerdown",function(m){E.onPointerStart(m)},!1),n.addEventListener("pointermove",function(m){E.onPointerMove(m)},!1),x.addEventListener("pointerup",function(m){E.onPointerEnd(m,!1)},!1),x.addEventListener("pointercancel",function(m){E.onPointerEnd(m,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(m){m.preventDefault()},
!1),document.addEventListener("MSGestureHold",function(m){m.preventDefault()},!1),this.runtime.canvas.addEventListener("gesturehold",function(m){m.preventDefault()},!1),document.addEventListener("gesturehold",function(m){m.preventDefault()},!1))):window.navigator.msPointerEnabled?(n.addEventListener("MSPointerDown",function(m){E.onPointerStart(m)},!1),n.addEventListener("MSPointerMove",function(m){E.onPointerMove(m)},!1),x.addEventListener("MSPointerUp",function(m){E.onPointerEnd(m,!1)},!1),x.addEventListener("MSPointerCancel",
function(m){E.onPointerEnd(m,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(m){m.preventDefault()},!1),document.addEventListener("MSGestureHold",function(m){m.preventDefault()},!1))):(n.addEventListener("touchstart",function(m){E.onTouchStart(m)},!1),n.addEventListener("touchmove",function(m){E.onTouchMove(m)},!1),x.addEventListener("touchend",function(m){E.onTouchEnd(m,!1)},!1),x.addEventListener("touchcancel",function(m){E.onTouchEnd(m,!0)},!1));if(this.isWindows8){var V=
function(m){m=m.reading;E.acc_x=m.accelerationX;E.acc_y=m.accelerationY;E.acc_z=m.accelerationZ},Z=function(m){m=m.reading;E.orient_alpha=m.yawDegrees;E.orient_beta=m.pitchDegrees;E.orient_gamma=m.rollDegrees},M=Windows.Devices.Sensors.Accelerometer.getDefault();M&&(M.reportInterval=Math.max(M.minimumReportInterval,16),M.addEventListener("readingchanged",V));var d=Windows.Devices.Sensors.Inclinometer.getDefault();d&&(d.reportInterval=Math.max(d.minimumReportInterval,16),d.addEventListener("readingchanged",
Z));document.addEventListener("visibilitychange",function(m){document.hidden||document.msHidden?(M&&M.removeEventListener("readingchanged",V),d&&d.removeEventListener("readingchanged",Z)):(M&&M.addEventListener("readingchanged",V),d&&d.addEventListener("readingchanged",Z))},!1)}else window.addEventListener("deviceorientation",function(m){E.orient_alpha=m.alpha||0;E.orient_beta=m.beta||0;E.orient_gamma=m.gamma||0},!1),window.addEventListener("devicemotion",function(m){m.accelerationIncludingGravity&&
(E.acc_g_x=m.accelerationIncludingGravity.x||0,E.acc_g_y=m.accelerationIncludingGravity.y||0,E.acc_g_z=m.accelerationIncludingGravity.z||0);m.acceleration&&(E.acc_x=m.acceleration.x||0,E.acc_y=m.acceleration.y||0,E.acc_z=m.acceleration.z||0)},!1);this.useMouseInput&&(document.addEventListener("mousemove",function(m){E.onMouseMove(m)}),document.addEventListener("mousedown",function(m){E.onMouseDown(m)}),document.addEventListener("mouseup",function(m){E.onMouseUp(m)}));!this.runtime.isiOS&&this.runtime.isCordova&&
navigator.accelerometer&&navigator.accelerometer.watchAcceleration&&navigator.accelerometer.watchAcceleration(b,null,{frequency:40});this.runtime.tick2Me(this)};c.onPointerMove=function(n){if(n.pointerType!==n.MSPOINTER_TYPE_MOUSE&&"mouse"!==n.pointerType){n.preventDefault&&n.preventDefault();var x=this.findTouch(n.pointerId),E=cr.performance_now();0<=x&&(x=this.touches[x],2>E-x.time||x.update(E,n.pageX-this.runtime.canvas.offsetLeft,n.pageY-this.runtime.canvas.offsetTop,n.width||0,n.height||0,n.pressure||
0))}};c.onPointerStart=function(n){if(n.pointerType!==n.MSPOINTER_TYPE_MOUSE&&"mouse"!==n.pointerType&&-1===this.findTouch(n.pointerId)){n.preventDefault&&cr.isCanvasInputEvent(n)&&n.preventDefault();var x=n.pageX-this.runtime.canvas.offsetLeft,E=n.pageY-this.runtime.canvas.offsetTop;cr.performance_now();this.trigger_index=this.touches.length;this.trigger_id=n.pointerId;this.touches.push(e(x,E,n.pointerId,this.trigger_index));this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchStart,
this);this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchStart,this);this.curTouchX=x;this.curTouchY=E;this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchObject,this);this.runtime.isInUserInputEvent=!1}};c.onPointerEnd=function(n,x){n.pointerType!==n.MSPOINTER_TYPE_MOUSE&&"mouse"!==n.pointerType&&(n.preventDefault&&cr.isCanvasInputEvent(n)&&n.preventDefault(),n=this.findTouch(n.pointerId),this.trigger_index=0<=n?this.touches[n].startindex:-1,this.trigger_id=0<=n?this.touches[n].id:
-1,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchEnd,this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchEnd,this),0<=n&&(x||this.touches[n].maybeTriggerTap(this,n),100>w.length&&w.push(this.touches[n]),this.touches.splice(n,1)),this.runtime.isInUserInputEvent=!1)};c.onTouchMove=function(n){n.preventDefault&&n.preventDefault();var x=cr.performance_now(),E;var V=0;for(E=n.changedTouches.length;V<E;V++){var Z=n.changedTouches[V];var M=
this.findTouch(Z.identifier);if(0<=M){var d=this.runtime.canvas.offsetLeft,m=this.runtime.canvas.offsetTop;M=this.touches[M];2>x-M.time||M.update(x,Z.pageX-d,Z.pageY-m,2*(Z.radiusX||Z.webkitRadiusX||Z.mozRadiusX||Z.msRadiusX||0),2*(Z.radiusY||Z.webkitRadiusY||Z.mozRadiusY||Z.msRadiusY||0),Z.force||Z.webkitForce||Z.mozForce||Z.msForce||0)}}};c.onTouchStart=function(n){n.preventDefault&&cr.isCanvasInputEvent(n)&&n.preventDefault();var x=this.runtime.canvas.offsetLeft,E=this.runtime.canvas.offsetTop;
cr.performance_now();this.runtime.isInUserInputEvent=!0;var V;var Z=0;for(V=n.changedTouches.length;Z<V;Z++){var M=n.changedTouches[Z];var d=this.findTouch(M.identifier);if(-1===d){d=M.pageX-x;var m=M.pageY-E;this.trigger_index=this.touches.length;this.trigger_id=M.identifier;this.touches.push(e(d,m,M.identifier,this.trigger_index));this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchStart,this);this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchStart,this);this.curTouchX=d;
this.curTouchY=m;this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchObject,this)}}this.runtime.isInUserInputEvent=!1};c.onTouchEnd=function(n,x){n.preventDefault&&cr.isCanvasInputEvent(n)&&n.preventDefault();this.runtime.isInUserInputEvent=!0;var E;var V=0;for(E=n.changedTouches.length;V<E;V++){var Z=n.changedTouches[V];Z=this.findTouch(Z.identifier);0<=Z&&(this.trigger_index=this.touches[Z].startindex,this.trigger_id=this.touches[Z].id,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchEnd,
this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchEnd,this),x||this.touches[Z].maybeTriggerTap(this,Z),100>w.length&&w.push(this.touches[Z]),this.touches.splice(Z,1))}this.runtime.isInUserInputEvent=!1};c.getAlpha=function(){return this.runtime.isCordova&&0===this.orient_alpha&&0!==p?90*p:this.orient_alpha};c.getBeta=function(){return this.runtime.isCordova&&0===this.orient_beta&&0!==q?90*q:this.orient_beta};c.getGamma=function(){return this.runtime.isCordova&&0===this.orient_gamma&&
0!==l?90*l:this.orient_gamma};c.onMouseDown=function(n){r(n)||(this.onTouchStart({changedTouches:[{pageX:n.pageX,pageY:n.pageY,identifier:0}]}),this.mouseDown=!0)};c.onMouseMove=function(n){if(this.mouseDown&&!r(n))this.onTouchMove({changedTouches:[{pageX:n.pageX,pageY:n.pageY,identifier:0}]})};c.onMouseUp=function(n){n.preventDefault&&this.runtime.had_a_click&&!this.runtime.isMobile&&n.preventDefault();this.runtime.had_a_click=!0;r(n)||(this.onTouchEnd({changedTouches:[{pageX:n.pageX,pageY:n.pageY,
identifier:0}]}),this.mouseDown=!1)};c.isClientPosOverCanvas=function(n,x){return 0<=n&&0<=x&&n<this.runtime.width&&x<this.runtime.height};c.tick2=function(){var n,x=cr.performance_now();var E=0;for(n=this.touches.length;E<n;++E){var V=this.touches[E];V.time<=x-50&&(V.lasttime=x);V.maybeTriggerHold(this,E)}};z.prototype.OnTouchStart=function(){return!0};z.prototype.OnTouchEnd=function(){return!0};z.prototype.IsInTouch=function(){return this.touches.length};z.prototype.OnTouchObject=function(n){return n&&
this.isClientPosOverCanvas(this.curTouchX,this.curTouchY)?this.runtime.testAndSelectCanvasPointOverlap(n,this.curTouchX,this.curTouchY,!1):!1};var R=[];z.prototype.IsTouchingObject=function(n){if(!n)return!1;var x=n.getCurrentSol(),E=x.getObjects(),V,Z;var M=0;for(V=E.length;M<V;M++){var d=E[M];d.update_bbox();var m=0;for(Z=this.touches.length;m<Z;m++){var G=this.touches[m];if(this.isClientPosOverCanvas(G.x,G.y)){var f=d.layer.canvasToLayer(G.x,G.y,!0);G=d.layer.canvasToLayer(G.x,G.y,!1);if(d.contains_pt(f,
G)){R.push(d);break}}}}return R.length?(x.select_all=!1,cr.shallowAssignArray(x.instances,R),n.applySolToContainer(),cr.clearArray(R),!0):!1};z.prototype.CompareTouchSpeed=function(n,x,E){n=Math.floor(n);if(0>n||n>=this.touches.length)return!1;var V=this.touches[n];n=cr.distanceTo(V.x,V.y,V.lastx,V.lasty);V=(V.time-V.lasttime)/1E3;var Z=0;0<V&&(Z=n/V);return cr.do_cmp(Z,x,E)};z.prototype.OrientationSupported=function(){return"undefined"!==typeof window.DeviceOrientationEvent};z.prototype.MotionSupported=
function(){return"undefined"!==typeof window.DeviceMotionEvent};z.prototype.CompareOrientation=function(n,x,E){n=0===n?this.getAlpha():1===n?this.getBeta():this.getGamma();return cr.do_cmp(n,x,E)};z.prototype.CompareAcceleration=function(n,x,E){var V=0;0===n?V=this.acc_g_x:1===n?V=this.acc_g_y:2===n?V=this.acc_g_z:3===n?V=this.acc_x:4===n?V=this.acc_y:5===n&&(V=this.acc_z);return cr.do_cmp(V,x,E)};z.prototype.OnNthTouchStart=function(n){n=Math.floor(n);return n===this.trigger_index};z.prototype.OnNthTouchEnd=
function(n){n=Math.floor(n);return n===this.trigger_index};z.prototype.HasNthTouch=function(n){n=Math.floor(n);return this.touches.length>=n+1};z.prototype.OnHoldGesture=function(){return!0};z.prototype.OnTapGesture=function(){return!0};z.prototype.OnDoubleTapGesture=function(){return!0};z.prototype.OnHoldGestureObject=function(n){return n&&this.isClientPosOverCanvas(this.curTouchX,this.curTouchY)?this.runtime.testAndSelectCanvasPointOverlap(n,this.curTouchX,this.curTouchY,!1):!1};z.prototype.OnTapGestureObject=
function(n){return n&&this.isClientPosOverCanvas(this.curTouchX,this.curTouchY)?this.runtime.testAndSelectCanvasPointOverlap(n,this.curTouchX,this.curTouchY,!1):!1};z.prototype.OnDoubleTapGestureObject=function(n){return n&&this.isClientPosOverCanvas(this.curTouchX,this.curTouchY)?this.runtime.testAndSelectCanvasPointOverlap(n,this.curTouchX,this.curTouchY,!1):!1};z.prototype.OnPermissionGranted=function(n){return this.trigger_permission===n};z.prototype.OnPermissionDenied=function(n){return this.trigger_permission===
n};a.cnds=new z;N.prototype.RequestPermission=function(n){var x=this,E=Promise.resolve(!0);0===n?window.DeviceOrientationEvent&&window.DeviceOrientationEvent.requestPermission&&(E=window.DeviceOrientationEvent.requestPermission().then(function(V){return"granted"===V})):window.DeviceMotionEvent&&window.DeviceMotionEvent.requestPermission&&(E=window.DeviceMotionEvent.requestPermission().then(function(V){return"granted"===V}));E.then(function(V){x.trigger_permission=n;V?x.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnPermissionGranted,
x):x.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnPermissionDenied,x)})};a.acts=new N;k.prototype.TouchCount=function(n){n.set_int(this.touches.length)};k.prototype.X=function(n,x){var E=this.getTouchIndex;if(0>E||E>=this.touches.length)n.set_float(0);else if(cr.is_undefined(x)){x=this.runtime.getLayerByNumber(0);var V=x.scale;var Z=x.zoomRate;var M=x.parallaxX;var d=x.angle;x.scale=1;x.zoomRate=1;x.parallaxX=1;x.angle=0;n.set_float(x.canvasToLayer(this.touches[E].x,this.touches[E].y,!0));x.scale=
V;x.zoomRate=Z;x.parallaxX=M;x.angle=d}else(x=cr.is_number(x)?this.runtime.getLayerByNumber(x):this.runtime.getLayerByName(x))?n.set_float(x.canvasToLayer(this.touches[E].x,this.touches[E].y,!0)):n.set_float(0)};k.prototype.XAt=function(n,x,E){x=Math.floor(x);if(0>x||x>=this.touches.length)n.set_float(0);else if(cr.is_undefined(E)){E=this.runtime.getLayerByNumber(0);var V=E.scale;var Z=E.zoomRate;var M=E.parallaxX;var d=E.angle;E.scale=1;E.zoomRate=1;E.parallaxX=1;E.angle=0;n.set_float(E.canvasToLayer(this.touches[x].x,
this.touches[x].y,!0));E.scale=V;E.zoomRate=Z;E.parallaxX=M;E.angle=d}else(E=cr.is_number(E)?this.runtime.getLayerByNumber(E):this.runtime.getLayerByName(E))?n.set_float(E.canvasToLayer(this.touches[x].x,this.touches[x].y,!0)):n.set_float(0)};k.prototype.XForID=function(n,x,E){x=this.findTouch(x);if(0>x)n.set_float(0);else if(x=this.touches[x],cr.is_undefined(E)){E=this.runtime.getLayerByNumber(0);var V=E.scale;var Z=E.zoomRate;var M=E.parallaxX;var d=E.angle;E.scale=1;E.zoomRate=1;E.parallaxX=1;
E.angle=0;n.set_float(E.canvasToLayer(x.x,x.y,!0));E.scale=V;E.zoomRate=Z;E.parallaxX=M;E.angle=d}else(E=cr.is_number(E)?this.runtime.getLayerByNumber(E):this.runtime.getLayerByName(E))?n.set_float(E.canvasToLayer(x.x,x.y,!0)):n.set_float(0)};k.prototype.Y=function(n,x){var E=this.getTouchIndex;if(0>E||E>=this.touches.length)n.set_float(0);else if(cr.is_undefined(x)){x=this.runtime.getLayerByNumber(0);var V=x.scale;var Z=x.zoomRate;var M=x.parallaxY;var d=x.angle;x.scale=1;x.zoomRate=1;x.parallaxY=
1;x.angle=0;n.set_float(x.canvasToLayer(this.touches[E].x,this.touches[E].y,!1));x.scale=V;x.zoomRate=Z;x.parallaxY=M;x.angle=d}else(x=cr.is_number(x)?this.runtime.getLayerByNumber(x):this.runtime.getLayerByName(x))?n.set_float(x.canvasToLayer(this.touches[E].x,this.touches[E].y,!1)):n.set_float(0)};k.prototype.YAt=function(n,x,E){x=Math.floor(x);if(0>x||x>=this.touches.length)n.set_float(0);else if(cr.is_undefined(E)){E=this.runtime.getLayerByNumber(0);var V=E.scale;var Z=E.zoomRate;var M=E.parallaxY;
var d=E.angle;E.scale=1;E.zoomRate=1;E.parallaxY=1;E.angle=0;n.set_float(E.canvasToLayer(this.touches[x].x,this.touches[x].y,!1));E.scale=V;E.zoomRate=Z;E.parallaxY=M;E.angle=d}else(E=cr.is_number(E)?this.runtime.getLayerByNumber(E):this.runtime.getLayerByName(E))?n.set_float(E.canvasToLayer(this.touches[x].x,this.touches[x].y,!1)):n.set_float(0)};k.prototype.YForID=function(n,x,E){x=this.findTouch(x);if(0>x)n.set_float(0);else if(x=this.touches[x],cr.is_undefined(E)){E=this.runtime.getLayerByNumber(0);
var V=E.scale;var Z=E.zoomRate;var M=E.parallaxY;var d=E.angle;E.scale=1;E.zoomRate=1;E.parallaxY=1;E.angle=0;n.set_float(E.canvasToLayer(x.x,x.y,!1));E.scale=V;E.zoomRate=Z;E.parallaxY=M;E.angle=d}else(E=cr.is_number(E)?this.runtime.getLayerByNumber(E):this.runtime.getLayerByName(E))?n.set_float(E.canvasToLayer(x.x,x.y,!1)):n.set_float(0)};k.prototype.AbsoluteX=function(n){this.touches.length?n.set_float(this.touches[0].x):n.set_float(0)};k.prototype.AbsoluteXAt=function(n,x){x=Math.floor(x);0>x||
x>=this.touches.length?n.set_float(0):n.set_float(this.touches[x].x)};k.prototype.AbsoluteXForID=function(n,x){x=this.findTouch(x);0>x?n.set_float(0):n.set_float(this.touches[x].x)};k.prototype.AbsoluteY=function(n){this.touches.length?n.set_float(this.touches[0].y):n.set_float(0)};k.prototype.AbsoluteYAt=function(n,x){x=Math.floor(x);0>x||x>=this.touches.length?n.set_float(0):n.set_float(this.touches[x].y)};k.prototype.AbsoluteYForID=function(n,x){x=this.findTouch(x);0>x?n.set_float(0):n.set_float(this.touches[x].y)};
k.prototype.SpeedAt=function(n,x){x=Math.floor(x);if(0>x||x>=this.touches.length)n.set_float(0);else{var E=this.touches[x];x=cr.distanceTo(E.x,E.y,E.lastx,E.lasty);E=(E.time-E.lasttime)/1E3;0>=E?n.set_float(0):n.set_float(x/E)}};k.prototype.SpeedForID=function(n,x){x=this.findTouch(x);if(0>x)n.set_float(0);else{var E=this.touches[x];x=cr.distanceTo(E.x,E.y,E.lastx,E.lasty);E=(E.time-E.lasttime)/1E3;0>=E?n.set_float(0):n.set_float(x/E)}};k.prototype.AngleAt=function(n,x){x=Math.floor(x);0>x||x>=this.touches.length?
n.set_float(0):(x=this.touches[x],n.set_float(cr.to_degrees(cr.angleTo(x.lastx,x.lasty,x.x,x.y))))};k.prototype.AngleForID=function(n,x){x=this.findTouch(x);0>x?n.set_float(0):(x=this.touches[x],n.set_float(cr.to_degrees(cr.angleTo(x.lastx,x.lasty,x.x,x.y))))};k.prototype.Alpha=function(n){n.set_float(this.getAlpha())};k.prototype.Beta=function(n){n.set_float(this.getBeta())};k.prototype.Gamma=function(n){n.set_float(this.getGamma())};k.prototype.AccelerationXWithG=function(n){n.set_float(this.acc_g_x)};
k.prototype.AccelerationYWithG=function(n){n.set_float(this.acc_g_y)};k.prototype.AccelerationZWithG=function(n){n.set_float(this.acc_g_z)};k.prototype.AccelerationX=function(n){n.set_float(this.acc_x)};k.prototype.AccelerationY=function(n){n.set_float(this.acc_y)};k.prototype.AccelerationZ=function(n){n.set_float(this.acc_z)};k.prototype.TouchIndex=function(n){n.set_int(this.trigger_index)};k.prototype.TouchID=function(n){n.set_float(this.trigger_id)};k.prototype.WidthForID=function(n,x){x=this.findTouch(x);
0>x?n.set_float(0):n.set_float(this.touches[x].width)};k.prototype.HeightForID=function(n,x){x=this.findTouch(x);0>x?n.set_float(0):n.set_float(this.touches[x].height)};k.prototype.PressureForID=function(n,x){x=this.findTouch(x);0>x?n.set_float(0):n.set_float(this.touches[x].pressure)};a.exps=new k})();cr.plugins_.Arr=function(b){this.runtime=b};
(function(){function b(){return c.length?c.pop():[]}function e(l){var q;var p=0;for(q=l.length;p<q;p++)Array.isArray(l[p])&&e(l[p]);cr.clearArray(l);c.push(l)}function h(){}function r(){}function z(l,q){if(cr.is_number(l)&&cr.is_number(q))return l-q;l=""+l;q=""+q;return l<q?-1:l>q?1:0}function N(){}var k=cr.plugins_.Arr.prototype;k.Type=function(l){this.plugin=l;this.runtime=l.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(l){this.type=l;this.runtime=l.runtime};var a=k.Instance.prototype,
c=[];Array.isArray||(Array.isArray=function(l){return"[object Array]"===Object.prototype.toString.call(l)});a.onCreate=function(){this.cx=this.properties[0];this.cy=this.properties[1];this.cz=this.properties[2];this.recycled||(this.arr=b());var l=this.arr;l.length=this.cx;var q,p,w;for(q=0;q<this.cx;q++)for(l[q]||(l[q]=b()),l[q].length=this.cy,p=0;p<this.cy;p++)for(l[q][p]||(l[q][p]=b()),l[q][p].length=this.cz,w=0;w<this.cz;w++)l[q][p][w]=0;this.forX=[];this.forY=[];this.forZ=[];this.forDepth=-1};
a.onDestroy=function(){var l;for(l=0;l<this.cx;l++)e(this.arr[l]);cr.clearArray(this.arr)};a.at=function(l,q,p){l=Math.floor(l);q=Math.floor(q);p=Math.floor(p);return isNaN(l)||0>l||l>this.cx-1||isNaN(q)||0>q||q>this.cy-1||isNaN(p)||0>p||p>this.cz-1?0:this.arr[l][q][p]};a.set=function(l,q,p,w){l=Math.floor(l);q=Math.floor(q);p=Math.floor(p);isNaN(l)||0>l||l>this.cx-1||isNaN(q)||0>q||q>this.cy-1||isNaN(p)||0>p||p>this.cz-1||(this.arr[l][q][p]=w)};a.getAsJSON=function(){return JSON.stringify({c2array:!0,
size:[this.cx,this.cy,this.cz],data:this.arr})};a.saveToJSON=function(){return{size:[this.cx,this.cy,this.cz],data:this.arr}};a.loadFromJSON=function(l){var q=l.size;this.cx=q[0];this.cy=q[1];this.cz=q[2];this.arr=l.data};a.setSize=function(l,q,p){0>l&&(l=0);0>q&&(q=0);0>p&&(p=0);if(this.cx!==l||this.cy!==q||this.cz!==p){this.cx=l;this.cy=q;this.cz=p;var w,K,A=this.arr;A.length=l;for(l=0;l<this.cx;l++)for(cr.is_undefined(A[l])&&(A[l]=b()),A[l].length=q,w=0;w<this.cy;w++)for(cr.is_undefined(A[l][w])&&
(A[l][w]=b()),A[l][w].length=p,K=0;K<this.cz;K++)cr.is_undefined(A[l][w][K])&&(A[l][w][K]=0)}};a.getForX=function(){return 0<=this.forDepth&&this.forDepth<this.forX.length?this.forX[this.forDepth]:0};a.getForY=function(){return 0<=this.forDepth&&this.forDepth<this.forY.length?this.forY[this.forDepth]:0};a.getForZ=function(){return 0<=this.forDepth&&this.forDepth<this.forZ.length?this.forZ[this.forDepth]:0};h.prototype.CompareX=function(l,q,p){return cr.do_cmp(this.at(l,0,0),q,p)};h.prototype.CompareXY=
function(l,q,p,w){return cr.do_cmp(this.at(l,q,0),p,w)};h.prototype.CompareXYZ=function(l,q,p,w,K){return cr.do_cmp(this.at(l,q,p),w,K)};a.doForEachTrigger=function(l){this.runtime.pushCopySol(l.solModifiers);l.retrigger();this.runtime.popSol(l.solModifiers)};h.prototype.ArrForEach=function(l){var q=this.runtime.getCurrentEventStack().current_event;this.forDepth++;var p=this.forDepth;p===this.forX.length?(this.forX.push(0),this.forY.push(0),this.forZ.push(0)):(this.forX[p]=0,this.forY[p]=0,this.forZ[p]=
0);switch(l){case 0:for(this.forX[p]=0;this.forX[p]<this.cx;this.forX[p]++)for(this.forY[p]=0;this.forY[p]<this.cy;this.forY[p]++)for(this.forZ[p]=0;this.forZ[p]<this.cz;this.forZ[p]++)this.doForEachTrigger(q);break;case 1:for(this.forX[p]=0;this.forX[p]<this.cx;this.forX[p]++)for(this.forY[p]=0;this.forY[p]<this.cy;this.forY[p]++)this.doForEachTrigger(q);break;case 2:for(this.forX[p]=0;this.forX[p]<this.cx;this.forX[p]++)this.doForEachTrigger(q)}this.forDepth--;return!1};h.prototype.CompareCurrent=
function(l,q){return cr.do_cmp(this.at(this.getForX(),this.getForY(),this.getForZ()),l,q)};h.prototype.Contains=function(l){var q,p,w;for(q=0;q<this.cx;q++)for(p=0;p<this.cy;p++)for(w=0;w<this.cz;w++)if(this.arr[q][p][w]===l)return!0;return!1};h.prototype.IsEmpty=function(){return 0===this.cx||0===this.cy||0===this.cz};h.prototype.CompareSize=function(l,q,p){var w=0;switch(l){case 0:w=this.cx;break;case 1:w=this.cy;break;case 2:w=this.cz}return cr.do_cmp(w,q,p)};k.cnds=new h;r.prototype.Clear=function(l){var q,
p,w;for(q=0;q<this.cx;q++)for(p=0;p<this.cy;p++)for(w=0;w<this.cz;w++)this.arr[q][p][w]=l};r.prototype.SetSize=function(l,q,p){this.setSize(l,q,p)};r.prototype.SetX=function(l,q){this.set(l,0,0,q)};r.prototype.SetXY=function(l,q,p){this.set(l,q,0,p)};r.prototype.SetXYZ=function(l,q,p,w){this.set(l,q,p,w)};r.prototype.Push=function(l,q,p){var w=0,K=0,A=this.arr;switch(p){case 0:0===l?(w=A.length,A.push(b())):(w=0,A.unshift(b()));for(A[w].length=this.cy;K<this.cy;K++)for(A[w][K]=b(),A[w][K].length=
this.cz,p=0;p<this.cz;p++)A[w][K][p]=q;this.cx++;break;case 1:for(;w<this.cx;w++)for(0===l?(K=A[w].length,A[w].push(b())):(K=0,A[w].unshift(b())),A[w][K].length=this.cz,p=0;p<this.cz;p++)A[w][K][p]=q;this.cy++;break;case 2:for(;w<this.cx;w++)for(K=0;K<this.cy;K++)0===l?A[w][K].push(q):A[w][K].unshift(q);this.cz++}};r.prototype.Pop=function(l,q){var p=0,w=this.arr;switch(q){case 0:if(0===this.cx)break;0===l?e(w.pop()):e(w.shift());this.cx--;break;case 1:if(0===this.cy)break;for(;p<this.cx;p++)0===
l?e(w[p].pop()):e(w[p].shift());this.cy--;break;case 2:if(0!==this.cz){for(;p<this.cx;p++)for(q=0;q<this.cy;q++)0===l?w[p][q].pop():w[p][q].shift();this.cz--}}};r.prototype.Reverse=function(l){var q=0,p=this.arr;if(0!==this.cx&&0!==this.cy&&0!==this.cz)switch(l){case 0:p.reverse();break;case 1:for(;q<this.cx;q++)p[q].reverse();break;case 2:for(;q<this.cx;q++)for(l=0;l<this.cy;l++)p[q][l].reverse()}};r.prototype.Sort=function(l){var q=0,p=0,w=this.arr;if(0!==this.cx&&0!==this.cy&&0!==this.cz)switch(l){case 0:w.sort(function(K,
A){return z(K[0][0],A[0][0])});break;case 1:for(;q<this.cx;q++)w[q].sort(function(K,A){return z(K[0],A[0])});break;case 2:for(;q<this.cx;q++)for(p=0;p<this.cy;p++)w[q][p].sort(z)}};r.prototype.Delete=function(l,q){var p=0;l=Math.floor(l);var w=this.arr;if(!(0>l))switch(q){case 0:if(l>=this.cx)break;e(w[l]);w.splice(l,1);this.cx--;break;case 1:if(l>=this.cy)break;for(;p<this.cx;p++)e(w[p][l]),w[p].splice(l,1);this.cy--;break;case 2:if(!(l>=this.cz)){for(;p<this.cx;p++)for(q=0;q<this.cy;q++)w[p][q].splice(l,
1);this.cz--}}};r.prototype.Insert=function(l,q,p){var w=0,K=0;q=Math.floor(q);var A=this.arr;if(!(0>q))switch(p){case 0:if(q>this.cx)break;w=q;A.splice(w,0,b());for(A[w].length=this.cy;K<this.cy;K++)for(A[w][K]=b(),A[w][K].length=this.cz,p=0;p<this.cz;p++)A[w][K][p]=l;this.cx++;break;case 1:if(q>this.cy)break;for(;w<this.cx;w++)for(K=q,A[w].splice(K,0,b()),A[w][K].length=this.cz,p=0;p<this.cz;p++)A[w][K][p]=l;this.cy++;break;case 2:if(!(q>this.cz)){for(;w<this.cx;w++)for(K=0;K<this.cy;K++)A[w][K].splice(q,
0,l);this.cz++}}};r.prototype.JSONLoad=function(l){try{var q=JSON.parse(l)}catch(p){return}q.c2array&&(l=q.size,this.cx=l[0],this.cy=l[1],this.cz=l[2],this.arr=q.data)};r.prototype.JSONDownload=function(l){var q=document.createElement("a");if("undefined"===typeof q.download)l="data:text/html,"+encodeURIComponent("<p><a download='"+l+"' href=\"data:application/json,"+encodeURIComponent(this.getAsJSON())+'">Download link</a></p>'),window.open(l);else{var p=document.getElementsByTagName("body")[0];q.textContent=
l;q.href="data:application/json,"+encodeURIComponent(this.getAsJSON());q.download=l;p.appendChild(q);q.click();p.removeChild(q)}};k.acts=new r;N.prototype.At=function(l,q,p,w){l.set_any(this.at(q,p||0,w||0))};N.prototype.Width=function(l){l.set_int(this.cx)};N.prototype.Height=function(l){l.set_int(this.cy)};N.prototype.Depth=function(l){l.set_int(this.cz)};N.prototype.CurX=function(l){l.set_int(this.getForX())};N.prototype.CurY=function(l){l.set_int(this.getForY())};N.prototype.CurZ=function(l){l.set_int(this.getForZ())};
N.prototype.CurValue=function(l){l.set_any(this.at(this.getForX(),this.getForY(),this.getForZ()))};N.prototype.Front=function(l){l.set_any(this.at(0,0,0))};N.prototype.Back=function(l){l.set_any(this.at(this.cx-1,0,0))};N.prototype.IndexOf=function(l,q){for(var p=0;p<this.cx;p++)if(this.arr[p][0][0]===q){l.set_int(p);return}l.set_int(-1)};N.prototype.LastIndexOf=function(l,q){for(var p=this.cx-1;0<=p;p--)if(this.arr[p][0][0]===q){l.set_int(p);return}l.set_int(-1)};N.prototype.AsJSON=function(l){l.set_string(this.getAsJSON())};
k.exps=new N})();cr.plugins_.Function=function(b){this.runtime=b};
(function(){function b(){this.name="";this.retVal=0;this.params=[]}function e(){c++;c===a.length&&a.push(new b);return a[c]}function h(){return 0>c?null:a[c]}function r(){}function z(){}function N(){}var k=cr.plugins_.Function.prototype;k.Type=function(l){this.plugin=l;this.runtime=l.runtime};k.Type.prototype.onCreate=function(){};k.Instance=function(l){this.type=l;this.runtime=l.runtime};var a=[],c=-1;k.Instance.prototype.onCreate=function(){var l=this;window.c2_callFunction=function(q,p){var w,
K=e();K.name=q.toLowerCase();K.retVal=0;if(p)for(K.params.length=p.length,q=0,w=p.length;q<w;++q){var A=p[q];K.params[q]="number"===typeof A||"string"===typeof A?A:"boolean"===typeof A?A?1:0:0}else cr.clearArray(K.params);l.runtime.trigger(cr.plugins_.Function.prototype.cnds.OnFunction,l,K.name);c--;return K.retVal}};r.prototype.OnFunction=function(l){var q=h();return q?cr.equals_nocase(l,q.name):!1};r.prototype.CompareParam=function(l,q,p){var w=h();if(!w)return!1;l=cr.floor(l);var K=0;0<=l&&l<w.params.length&&
(K=w.params[l]);return cr.do_cmp(K,q,p)};k.cnds=new r;z.prototype.CallFunction=function(l,q){var p=e();p.name=l.toLowerCase();p.retVal=0;cr.shallowAssignArray(p.params,q);this.runtime.trigger(cr.plugins_.Function.prototype.cnds.OnFunction,this,p.name);c--};z.prototype.SetReturnValue=function(l){var q=h();q&&(q.retVal=l)};z.prototype.CallExpression=function(l){};k.acts=new z;N.prototype.ReturnValue=function(l){if(a.length){var q=c+1;q>=a.length&&(q=a.length-1);q=a[q]}else q=null;q?l.set_any(q.retVal):
l.set_int(0)};N.prototype.ParamCount=function(l){var q=h();q?l.set_int(q.params.length):l.set_int(0)};N.prototype.Param=function(l,q){q=cr.floor(q);var p=h();p?0<=q&&q<p.params.length?l.set_any(p.params[q]):l.set_int(0):l.set_int(0)};N.prototype.Call=function(l,q){var p=e();p.name=q.toLowerCase();p.retVal=0;cr.clearArray(p.params);var w;var K=2;for(w=arguments.length;K<w;K++)p.params.push(arguments[K]);this.runtime.trigger(cr.plugins_.Function.prototype.cnds.OnFunction,this,p.name);c--;l.set_any(p.retVal)};
k.exps=new N})();cr.plugins_.Audio=function(b){this.runtime=b};
(function(){function b(v){-1===za.indexOf(v)&&za.push(v)}function e(v){var H=v.instanceObject;try{var Q=H.play()}catch(S){b(v);return}Q?Q.catch(function(S){b(v)}):Ea&&!g.isInUserInputEvent&&b(v)}function h(){var v,H;Fa||ia||!t||(r(),"running"===t.state&&(Fa=!0));var Q=za.slice(0);cr.clearArray(za);if(!T){var S=0;for(v=Q.length;S<v;++S){var ea=Q[S];ea.stopped||ea.is_paused||(H=ea.instanceObject.play())&&H.catch(function(fa){b(ea)})}}}function r(){"suspended"===t.state&&t.resume&&t.resume();if(t.createBuffer){var v=
t.createBuffer(1,220,22050),H=t.createBufferSource();H.buffer=v;H.connect(t.destination);l(H)}}function z(v){v=Math.pow(10,v/20);isFinite(v)||(v=0);0>v&&(v=0);1<v&&(v=1);return v}function N(v){0>v&&(v=0);1<v&&(v=1);return Math.log(v)/Math.log(10)*20}function k(v){v=v.toLowerCase();return qa.hasOwnProperty(v)&&qa[v].length?qa[v][0].getInputNode():t.destination}function a(){return t.createGain?t.createGain():t.createGainNode()}function c(v){return t.createDelay?t.createDelay(v):t.createDelayNode(v)}
function l(v,H){v.start?v.start(H||0):v.noteOn(H||0)}function q(v,H,Q,S){v.start?v.start(S||0,H):v.noteGrainOn(S||0,H,Q-H)}function p(v){try{v.stop?v.stop(0):v.noteOff(0)}catch(H){}}function w(v,H,Q,S){if(v)if(v.cancelScheduledValues(0),0===S)v.value=H;else{var ea=t.currentTime;S+=ea;switch(Q){case 0:v.setValueAtTime(H,S);break;case 1:v.setValueAtTime(v.value,ea);v.linearRampToValueAtTime(H,S);break;case 2:v.setValueAtTime(v.value,ea),v.exponentialRampToValueAtTime(H,S)}}}function K(v,H,Q,S,ea,fa){this.type=
"filter";this.params=[v,H,Q,S,ea,fa];this.inputNode=a();this.wetNode=a();this.wetNode.gain.value=fa;this.dryNode=a();this.dryNode.gain.value=1-fa;this.filterNode=t.createBiquadFilter();this.filterNode.type="number"===typeof this.filterNode.type?v:Ga[v];this.filterNode.frequency.value=H;this.filterNode.detune&&(this.filterNode.detune.value=Q);this.filterNode.Q.value=S;this.filterNode.gain.value=ea;this.inputNode.connect(this.filterNode);this.inputNode.connect(this.dryNode);this.filterNode.connect(this.wetNode)}
function A(v,H,Q){this.type="delay";this.params=[v,H,Q];this.inputNode=a();this.wetNode=a();this.wetNode.gain.value=Q;this.dryNode=a();this.dryNode.gain.value=1-Q;this.mainNode=a();this.delayNode=c(v);this.delayNode.delayTime.value=v;this.delayGainNode=a();this.delayGainNode.gain.value=H;this.inputNode.connect(this.mainNode);this.inputNode.connect(this.dryNode);this.mainNode.connect(this.wetNode);this.mainNode.connect(this.delayNode);this.delayNode.connect(this.delayGainNode);this.delayGainNode.connect(this.mainNode)}
function J(v,H,Q,S){this.type="convolve";this.params=[H,Q,S];this.inputNode=a();this.wetNode=a();this.wetNode.gain.value=Q;this.dryNode=a();this.dryNode.gain.value=1-Q;this.convolveNode=t.createConvolver();v&&(this.convolveNode.normalize=H,this.convolveNode.buffer=v);this.inputNode.connect(this.convolveNode);this.inputNode.connect(this.dryNode);this.convolveNode.connect(this.wetNode)}function R(v,H,Q,S,ea){this.type="flanger";this.params=[v,H,Q,S,ea];this.inputNode=a();this.dryNode=a();this.dryNode.gain.value=
1-ea/2;this.wetNode=a();this.wetNode.gain.value=ea/2;this.feedbackNode=a();this.feedbackNode.gain.value=S;this.delayNode=c(v+H);this.delayNode.delayTime.value=v;this.oscNode=t.createOscillator();this.oscNode.frequency.value=Q;this.oscGainNode=a();this.oscGainNode.gain.value=H;this.inputNode.connect(this.delayNode);this.inputNode.connect(this.dryNode);this.delayNode.connect(this.wetNode);this.delayNode.connect(this.feedbackNode);this.feedbackNode.connect(this.delayNode);this.oscNode.connect(this.oscGainNode);
this.oscGainNode.connect(this.delayNode.delayTime);l(this.oscNode)}function n(v,H,Q,S,ea,fa){this.type="phaser";this.params=[v,H,Q,S,ea,fa];this.inputNode=a();this.dryNode=a();this.dryNode.gain.value=1-fa/2;this.wetNode=a();this.wetNode.gain.value=fa/2;this.filterNode=t.createBiquadFilter();this.filterNode.type="number"===typeof this.filterNode.type?7:"allpass";this.filterNode.frequency.value=v;this.filterNode.detune&&(this.filterNode.detune.value=H);this.filterNode.Q.value=Q;this.oscNode=t.createOscillator();
this.oscNode.frequency.value=ea;this.oscGainNode=a();this.oscGainNode.gain.value=S;this.inputNode.connect(this.filterNode);this.inputNode.connect(this.dryNode);this.filterNode.connect(this.wetNode);this.oscNode.connect(this.oscGainNode);this.oscGainNode.connect(this.filterNode.frequency);l(this.oscNode)}function x(v){this.type="gain";this.params=[v];this.node=a();this.node.gain.value=v}function E(v,H){this.type="tremolo";this.params=[v,H];this.node=a();this.node.gain.value=1-H/2;this.oscNode=t.createOscillator();
this.oscNode.frequency.value=v;this.oscGainNode=a();this.oscGainNode.gain.value=H/2;this.oscNode.connect(this.oscGainNode);this.oscGainNode.connect(this.node.gain);l(this.oscNode)}function V(v,H){this.type="ringmod";this.params=[v,H];this.inputNode=a();this.wetNode=a();this.wetNode.gain.value=H;this.dryNode=a();this.dryNode.gain.value=1-H;this.ringNode=a();this.ringNode.gain.value=0;this.oscNode=t.createOscillator();this.oscNode.frequency.value=v;this.oscNode.connect(this.ringNode.gain);l(this.oscNode);
this.inputNode.connect(this.ringNode);this.inputNode.connect(this.dryNode);this.ringNode.connect(this.wetNode)}function Z(v,H,Q,S,ea){this.type="distortion";this.params=[v,H,Q,S,ea];this.inputNode=a();this.preGain=a();this.postGain=a();this.setDrive(Q,Math.pow(10,S/20));this.wetNode=a();this.wetNode.gain.value=ea;this.dryNode=a();this.dryNode.gain.value=1-ea;this.waveShaper=t.createWaveShaper();this.curve=new Float32Array(65536);this.generateColortouchCurve(v,H);this.waveShaper.curve=this.curve;this.inputNode.connect(this.preGain);
this.inputNode.connect(this.dryNode);this.preGain.connect(this.waveShaper);this.waveShaper.connect(this.postGain);this.postGain.connect(this.wetNode)}function M(v,H,Q,S,ea){this.type="compressor";this.params=[v,H,Q,S,ea];this.node=t.createDynamicsCompressor();try{this.node.threshold.value=v,this.node.knee.value=H,this.node.ratio.value=Q,this.node.attack.value=S,this.node.release.value=ea}catch(fa){}}function d(v,H){this.type="analyser";this.params=[v,H];this.node=t.createAnalyser();this.node.fftSize=
v;this.node.smoothingTimeConstant=H;this.freqBins=new Float32Array(this.node.frequencyBinCount);this.signal=new Uint8Array(v);this.rms=this.peak=0}function m(){this.obj=null;this.loadUid=0}function G(v,H,Q){this.src=v;this.type=H;this.myapi=B;this.is_music=Q;this.added_end_listener=!1;var S=this;this.mediaSourceNode=this.outNode=null;this.panWhenReady=[];this.seekWhenReady=0;this.failedToLoad=this.supportWebAudioAPI=this.pauseWhenReady=!1;this.needsSoftwareDecode="audio/webm; codecs=opus"===this.type&&
!la;this.wasEverReady=!1;this.is_music&&this.needsSoftwareDecode&&(Ha=!0);1!==B||!Q||Aa||this.needsSoftwareDecode||(this.myapi=0,this.outNode=a());this.audioData=this.bufferObject=null;switch(this.myapi){case 0:this.bufferObject=new Audio;this.bufferObject.crossOrigin="anonymous";this.bufferObject.addEventListener("canplaythrough",function(){S.wasEverReady=!0});1===B&&t.createMediaElementSource&&!/wiiu/i.test(navigator.userAgent)&&(this.supportWebAudioAPI=!0,this.bufferObject.addEventListener("canplay",
function(){!S.mediaSourceNode&&S.bufferObject&&(S.mediaSourceNode=t.createMediaElementSource(S.bufferObject),S.mediaSourceNode.connect(S.outNode))}));this.bufferObject.autoplay=!1;this.bufferObject.preload="auto";this.bufferObject.src=v;break;case 1:if(g.isWKWebView)g.fetchLocalFileViaCordovaAsArrayBuffer(v,function(fa){S.audioData=fa;S.decodeAudioBuffer()},function(fa){S.failedToLoad=!0});else{var ea=new XMLHttpRequest;ea.open("GET",v,!0);ea.responseType="arraybuffer";ea.onload=function(){S.audioData=
ea.response;S.decodeAudioBuffer()};ea.onerror=function(){S.failedToLoad=!0};ea.send()}break;case 2:this.bufferObject=!0}}function f(v,H){var Q=this;this.tag=H;this.stopped=this.fresh=!0;this.src=v.src;this.buffer=v;this.myapi=B;this.is_music=v.is_music;this.playbackRate=1;this.hasPlaybackEnded=!0;this.is_paused=this.resume_me=!1;this.resume_position=0;this.is_silent=this.is_muted=this.looping=!1;this.volume=1;this.onended_handler=function(ea){if(!Q.is_paused&&!Q.resume_me){var fa=this;fa||(fa=ea.target);
fa===Q.active_buffer&&(Q.hasPlaybackEnded=!0,Q.stopped=!0,D=Q.tag,g.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded,u))}};this.active_buffer=null;this.isTimescaled=1===W&&!this.is_music||2===W;this.mutevol=1;this.startTime=this.isTimescaled?g.kahanTime.sum:g.wallTime.sum;this.pannerNode=this.gainNode=null;this.pannerEnabled=!1;this.objectTracker=null;this.panConeOuterGain=this.panConeOuter=this.panConeInner=this.panAngle=this.panY=this.panX=0;this.instanceObject=null;var S=!1;1!==this.myapi||0!==
this.buffer.myapi||this.buffer.supportWebAudioAPI||(this.myapi=0);switch(this.myapi){case 0:this.is_music?(this.instanceObject=v.bufferObject,S=!v.added_end_listener,v.added_end_listener=!0):(this.instanceObject=new Audio,this.instanceObject.crossOrigin="anonymous",this.instanceObject.autoplay=!1,this.instanceObject.src=v.bufferObject.src,S=!0);S&&this.instanceObject.addEventListener("ended",function(){D=Q.tag;Q.stopped=!0;g.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded,u)});break;case 1:this.gainNode=
a();this.gainNode.connect(k(H));1===this.buffer.myapi?v.bufferObject&&(this.instanceObject=t.createBufferSource(),this.instanceObject.buffer=v.bufferObject,this.instanceObject.connect(this.gainNode)):(this.instanceObject=this.buffer.bufferObject,this.buffer.outNode.connect(this.gainNode),this.buffer.added_end_listener||(this.buffer.added_end_listener=!0,this.buffer.bufferObject.addEventListener("ended",function(){D=Q.tag;Q.stopped=!0;g.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded,u)})));break;
case 2:this.instanceObject=new window.Media(I+this.src,null,null,function(ea){ea===window.Media.MEDIA_STOPPED&&(Q.hasPlaybackEnded=!0,Q.stopped=!0,D=Q.tag,g.trigger(cr.plugins_.Audio.prototype.cnds.OnEnded,u))})}}function y(v,H){v=v.isPlaying()?1:0;H=H.isPlaying()?1:0;return v===H?0:v<H?1:-1}function L(v,H){cr.clearArray(pa);if(v.length){var Q;var S=0;for(Q=F.length;S<Q;S++){var ea=F[S];cr.equals_nocase(v,ea.tag)&&pa.push(ea)}H&&pa.sort(y)}else O&&!O.hasEnded()&&(cr.clearArray(pa),pa[0]=O)}function P(v){var H,
Q=t.destination;if(qa.hasOwnProperty(v)){var S=qa[v];if(S.length){Q=S[0].getInputNode();var ea=0;for(H=S.length;ea<H;ea++){var fa=S[ea];ea+1===H?fa.connectTo(t.destination):fa.connectTo(S[ea+1].getInputNode())}}}L(v);ea=0;for(H=pa.length;ea<H;ea++)pa[ea].reconnect(Q);va&&Da===v&&(va.disconnect(),va.connect(Q))}function X(v,H){qa.hasOwnProperty(v)?qa[v].push(H):qa[v]=[H];P(v)}function ba(){}function aa(){}function ca(){}function ja(v,H){var Q=null;qa.hasOwnProperty(v)&&(Q=qa[v]);return Q&&0<=H&&H<
Q.length&&Q[H].freqBins?Q[H]:null}var ha=cr.plugins_.Audio.prototype;ha.Type=function(v){this.plugin=v;this.runtime=v.runtime};ha.Type.prototype.onCreate=function(){};var g=null,u=null,D="",I="",B=0,t=null,C=[],F=[],O=null,W=0,T=!1,U=1,Y=0,da=0,ia=!1,la=!!(new Audio).canPlayType("audio/webm; codecs=opus"),na=1,sa=1,wa=10,Ba=1E4,Ia=1,va=null,Da="",Ea=!1,za=[],Aa=!1,Ha=!1,Fa=!1;document.addEventListener("pointerup",h,!0);document.addEventListener("touchend",h,!0);document.addEventListener("click",h,
!0);document.addEventListener("keydown",h,!0);document.addEventListener("gamepadconnected",h,!0);var qa={},Ga="lowpass highpass bandpass lowshelf highshelf peaking notch allpass".split(" ");K.prototype.connectTo=function(v){this.wetNode.disconnect();this.wetNode.connect(v);this.dryNode.disconnect();this.dryNode.connect(v)};K.prototype.remove=function(){this.inputNode.disconnect();this.filterNode.disconnect();this.wetNode.disconnect();this.dryNode.disconnect()};K.prototype.getInputNode=function(){return this.inputNode};
K.prototype.setParam=function(v,H,Q,S){switch(v){case 0:H/=100;0>H&&(H=0);1<H&&(H=1);this.params[5]=H;w(this.wetNode.gain,H,Q,S);w(this.dryNode.gain,1-H,Q,S);break;case 1:this.params[1]=H;w(this.filterNode.frequency,H,Q,S);break;case 2:this.params[2]=H;w(this.filterNode.detune,H,Q,S);break;case 3:this.params[3]=H;w(this.filterNode.Q,H,Q,S);break;case 4:this.params[4]=H,w(this.filterNode.gain,H,Q,S)}};A.prototype.connectTo=function(v){this.wetNode.disconnect();this.wetNode.connect(v);this.dryNode.disconnect();
this.dryNode.connect(v)};A.prototype.remove=function(){this.inputNode.disconnect();this.mainNode.disconnect();this.delayNode.disconnect();this.delayGainNode.disconnect();this.wetNode.disconnect();this.dryNode.disconnect()};A.prototype.getInputNode=function(){return this.inputNode};A.prototype.setParam=function(v,H,Q,S){switch(v){case 0:H/=100;0>H&&(H=0);1<H&&(H=1);this.params[2]=H;w(this.wetNode.gain,H,Q,S);w(this.dryNode.gain,1-H,Q,S);break;case 4:this.params[1]=z(H);w(this.delayGainNode.gain,z(H),
Q,S);break;case 5:this.params[0]=H,w(this.delayNode.delayTime,H,Q,S)}};J.prototype.connectTo=function(v){this.wetNode.disconnect();this.wetNode.connect(v);this.dryNode.disconnect();this.dryNode.connect(v)};J.prototype.remove=function(){this.inputNode.disconnect();this.convolveNode.disconnect();this.wetNode.disconnect();this.dryNode.disconnect()};J.prototype.getInputNode=function(){return this.inputNode};J.prototype.setParam=function(v,H,Q,S){switch(v){case 0:H/=100,0>H&&(H=0),1<H&&(H=1),this.params[1]=
H,w(this.wetNode.gain,H,Q,S),w(this.dryNode.gain,1-H,Q,S)}};R.prototype.connectTo=function(v){this.dryNode.disconnect();this.dryNode.connect(v);this.wetNode.disconnect();this.wetNode.connect(v)};R.prototype.remove=function(){this.inputNode.disconnect();this.delayNode.disconnect();this.oscNode.disconnect();this.oscGainNode.disconnect();this.dryNode.disconnect();this.wetNode.disconnect();this.feedbackNode.disconnect()};R.prototype.getInputNode=function(){return this.inputNode};R.prototype.setParam=
function(v,H,Q,S){switch(v){case 0:H/=100;0>H&&(H=0);1<H&&(H=1);this.params[4]=H;w(this.wetNode.gain,H/2,Q,S);w(this.dryNode.gain,1-H/2,Q,S);break;case 6:this.params[1]=H/1E3;w(this.oscGainNode.gain,H/1E3,Q,S);break;case 7:this.params[2]=H;w(this.oscNode.frequency,H,Q,S);break;case 8:this.params[3]=H/100,w(this.feedbackNode.gain,H/100,Q,S)}};n.prototype.connectTo=function(v){this.dryNode.disconnect();this.dryNode.connect(v);this.wetNode.disconnect();this.wetNode.connect(v)};n.prototype.remove=function(){this.inputNode.disconnect();
this.filterNode.disconnect();this.oscNode.disconnect();this.oscGainNode.disconnect();this.dryNode.disconnect();this.wetNode.disconnect()};n.prototype.getInputNode=function(){return this.inputNode};n.prototype.setParam=function(v,H,Q,S){switch(v){case 0:H/=100;0>H&&(H=0);1<H&&(H=1);this.params[5]=H;w(this.wetNode.gain,H/2,Q,S);w(this.dryNode.gain,1-H/2,Q,S);break;case 1:this.params[0]=H;w(this.filterNode.frequency,H,Q,S);break;case 2:this.params[1]=H;w(this.filterNode.detune,H,Q,S);break;case 3:this.params[2]=
H;w(this.filterNode.Q,H,Q,S);break;case 6:this.params[3]=H;w(this.oscGainNode.gain,H,Q,S);break;case 7:this.params[4]=H,w(this.oscNode.frequency,H,Q,S)}};x.prototype.connectTo=function(v){this.node.disconnect();this.node.connect(v)};x.prototype.remove=function(){this.node.disconnect()};x.prototype.getInputNode=function(){return this.node};x.prototype.setParam=function(v,H,Q,S){switch(v){case 4:this.params[0]=z(H),w(this.node.gain,z(H),Q,S)}};E.prototype.connectTo=function(v){this.node.disconnect();
this.node.connect(v)};E.prototype.remove=function(){this.oscNode.disconnect();this.oscGainNode.disconnect();this.node.disconnect()};E.prototype.getInputNode=function(){return this.node};E.prototype.setParam=function(v,H,Q,S){switch(v){case 0:H/=100;0>H&&(H=0);1<H&&(H=1);this.params[1]=H;w(this.node.gain.value,1-H/2,Q,S);w(this.oscGainNode.gain.value,H/2,Q,S);break;case 7:this.params[0]=H,w(this.oscNode.frequency,H,Q,S)}};V.prototype.connectTo=function(v){this.wetNode.disconnect();this.wetNode.connect(v);
this.dryNode.disconnect();this.dryNode.connect(v)};V.prototype.remove=function(){this.oscNode.disconnect();this.ringNode.disconnect();this.inputNode.disconnect();this.wetNode.disconnect();this.dryNode.disconnect()};V.prototype.getInputNode=function(){return this.inputNode};V.prototype.setParam=function(v,H,Q,S){switch(v){case 0:H/=100;0>H&&(H=0);1<H&&(H=1);this.params[1]=H;w(this.wetNode.gain,H,Q,S);w(this.dryNode.gain,1-H,Q,S);break;case 7:this.params[0]=H,w(this.oscNode.frequency,H,Q,S)}};Z.prototype.setDrive=
function(v,H){.01>v&&(v=.01);this.preGain.gain.value=v;this.postGain.gain.value=Math.pow(1/v,.6)*H};Z.prototype.shape=function(v,H,Q){Q=1.05*Q*H-H;var S=0>v?-v:v;return(S<H?S:H+Q*(1-Math.exp(-(1/Q)*(S-H))))*(0>v?-1:1)};Z.prototype.generateColortouchCurve=function(v,H){v=Math.pow(10,v/20);H=Math.pow(10,H/20);for(var Q,S=0;32768>S;++S)Q=S/32768,Q=this.shape(Q,v,H),this.curve[32768+S]=Q,this.curve[32768-S-1]=-Q};Z.prototype.connectTo=function(v){this.wetNode.disconnect();this.wetNode.connect(v);this.dryNode.disconnect();
this.dryNode.connect(v)};Z.prototype.remove=function(){this.inputNode.disconnect();this.preGain.disconnect();this.waveShaper.disconnect();this.postGain.disconnect();this.wetNode.disconnect();this.dryNode.disconnect()};Z.prototype.getInputNode=function(){return this.inputNode};Z.prototype.setParam=function(v,H,Q,S){switch(v){case 0:H/=100,0>H&&(H=0),1<H&&(H=1),this.params[4]=H,w(this.wetNode.gain,H,Q,S),w(this.dryNode.gain,1-H,Q,S)}};M.prototype.connectTo=function(v){this.node.disconnect();this.node.connect(v)};
M.prototype.remove=function(){this.node.disconnect()};M.prototype.getInputNode=function(){return this.node};M.prototype.setParam=function(v,H,Q,S){};d.prototype.tick=function(){this.node.getFloatFrequencyData(this.freqBins);this.node.getByteTimeDomainData(this.signal);for(var v=this.node.fftSize,H=0,Q=this.peak=0,S;H<v;H++)S=(this.signal[H]-128)/128,0>S&&(S=-S),this.peak<S&&(this.peak=S),Q+=S*S;this.peak=N(this.peak);this.rms=N(Math.sqrt(Q/v))};d.prototype.connectTo=function(v){this.node.disconnect();
this.node.connect(v)};d.prototype.remove=function(){this.node.disconnect()};d.prototype.getInputNode=function(){return this.node};d.prototype.setParam=function(v,H,Q,S){};m.prototype.setObject=function(v){this.obj=v};m.prototype.hasObject=function(){return!!this.obj};m.prototype.tick=function(v){};G.prototype.release=function(){var v,H;var Q=v=0;for(H=F.length;v<H;++v){var S=F[v];F[Q]=S;S.buffer===this?S.stop():++Q}F.length=Q;this.mediaSourceNode&&(this.mediaSourceNode.disconnect(),this.mediaSourceNode=
null);this.outNode&&(this.outNode.disconnect(),this.outNode=null);this.audioData=this.bufferObject=null};G.prototype.decodeAudioBuffer=function(){if(!this.bufferObject&&this.audioData){var v=this;if(this.needsSoftwareDecode){var H=this.audioData;this.audioData=null;window.OpusDecoder(H,function(Q,S){if(Q)v.onDecodeError(Q);else Q=new Float32Array(S),S=t.createBuffer(1,Q.length,48E3),S.getChannelData(0).set(Q),v.onDecodeComplete(S)})}else t.decodeAudioData(this.audioData,function(Q){v.onDecodeComplete(Q)},
function(Q){v.onDecodeError(Q)})}};G.prototype.onDecodeComplete=function(v){this.bufferObject=v;this.audioData=null;var H;if(cr.is_undefined(this.playTagWhenReady)||T)cr.is_undefined(this.convolveWhenReady)||(Q=this.convolveWhenReady.convolveNode,Q.normalize=this.normalizeWhenReady,Q.buffer=v);else if(this.panWhenReady.length){var Q=0;for(H=this.panWhenReady.length;Q<H;Q++){v=this.panWhenReady[Q];var S=new f(this,v.thistag);S.setPannerEnabled(!0);if("undefined"!==typeof v.objUid&&(v.obj=g.getObjectByUID(v.objUid),
!v.obj))continue;if(v.obj){var ea=cr.rotatePtAround(v.obj.x,v.obj.y,-v.obj.layer.getAngle(),Y,da,!0),fa=cr.rotatePtAround(v.obj.x,v.obj.y,-v.obj.layer.getAngle(),Y,da,!1);S.setPan(ea,fa,cr.to_degrees(v.obj.angle-v.obj.layer.getAngle()),v.ia,v.oa,v.og);S.setObject(v.obj)}else S.setPan(v.x,v.y,v.a,v.ia,v.oa,v.og);S.play(this.loopWhenReady,this.volumeWhenReady,this.seekWhenReady);this.pauseWhenReady&&S.pause();F.push(S)}cr.clearArray(this.panWhenReady)}else S=new f(this,this.playTagWhenReady||""),S.play(this.loopWhenReady,
this.volumeWhenReady,this.seekWhenReady),this.pauseWhenReady&&S.pause(),F.push(S)};G.prototype.onDecodeError=function(v){self.failedToLoad=!0;console.error("Failed to decode audio '"+this.src+"': "+v)};G.prototype.isLoaded=function(){switch(this.myapi){case 0:var v=4<=this.bufferObject.readyState;v&&(this.wasEverReady=!0);return v||this.wasEverReady;case 1:return!!this.audioData||!!this.bufferObject;case 2:return!0}return!1};G.prototype.isLoadedAndDecoded=function(){switch(this.myapi){case 0:return this.isLoaded();
case 1:return!!this.bufferObject;case 2:return!0}return!1};G.prototype.hasFailedToLoad=function(){switch(this.myapi){case 0:return!!this.bufferObject.error;case 1:return this.failedToLoad}return!1};f.prototype.hasEnded=function(){switch(this.myapi){case 0:return this.instanceObject.ended;case 1:return 1===this.buffer.myapi?!this.fresh&&!this.stopped&&this.instanceObject.loop||this.is_paused?!1:this.hasPlaybackEnded:this.instanceObject.ended;case 2:return this.hasPlaybackEnded}return!0};f.prototype.canBeRecycled=
function(){return this.fresh||this.stopped?!0:this.hasEnded()};f.prototype.setPannerEnabled=function(v){1===B&&(!this.pannerEnabled&&v?this.gainNode&&(this.pannerNode||(this.pannerNode=t.createPanner(),this.pannerNode.panningModel="number"===typeof this.pannerNode.panningModel?na:["equalpower","HRTF","soundfield"][na],this.pannerNode.distanceModel="number"===typeof this.pannerNode.distanceModel?sa:["linear","inverse","exponential"][sa],this.pannerNode.refDistance=wa,this.pannerNode.maxDistance=Ba,
this.pannerNode.rolloffFactor=Ia),this.gainNode.disconnect(),this.gainNode.connect(this.pannerNode),this.pannerNode.connect(k(this.tag)),this.pannerEnabled=!0):this.pannerEnabled&&!v&&this.gainNode&&(this.pannerNode.disconnect(),this.gainNode.disconnect(),this.gainNode.connect(k(this.tag)),this.pannerEnabled=!1))};f.prototype.setPan=function(v,H,Q,S,ea,fa){this.pannerEnabled&&1===B&&(this.pannerNode.setPosition(v,H,0),this.pannerNode.setOrientation(Math.cos(cr.to_radians(Q)),Math.sin(cr.to_radians(Q)),
0),this.pannerNode.coneInnerAngle=S,this.pannerNode.coneOuterAngle=ea,this.pannerNode.coneOuterGain=fa,this.panX=v,this.panY=H,this.panAngle=Q,this.panConeInner=S,this.panConeOuter=ea,this.panConeOuterGain=fa)};f.prototype.setObject=function(v){this.pannerEnabled&&1===B&&(this.objectTracker||(this.objectTracker=new m),this.objectTracker.setObject(v))};f.prototype.tick=function(v){if(this.pannerEnabled&&1===B&&this.objectTracker&&this.objectTracker.hasObject()&&this.isPlaying()){this.objectTracker.tick(v);
v=this.objectTracker.obj;var H=cr.rotatePtAround(v.x,v.y,-v.layer.getAngle(),Y,da,!0),Q=cr.rotatePtAround(v.x,v.y,-v.layer.getAngle(),Y,da,!1);this.pannerNode.setPosition(H,Q,0);"undefined"!==typeof this.objectTracker.obj.angle&&(v=v.angle-v.layer.getAngle(),this.pannerNode.setOrientation(Math.cos(v),Math.sin(v),0))}};f.prototype.play=function(v,H,Q,S){var ea=this.instanceObject;this.looping=v;this.volume=H;Q=Q||0;S=S||0;switch(this.myapi){case 0:1!==ea.playbackRate&&(ea.playbackRate=1);ea.volume!==
H*U&&(ea.volume=H*U);ea.loop!==v&&(ea.loop=v);ea.muted&&(ea.muted=!1);if(ea.currentTime!==Q)try{ea.currentTime=Q}catch(fa){}e(this);break;case 1:this.muted=!1;this.mutevol=1;if(1===this.buffer.myapi)this.gainNode.gain.value=H*U,this.fresh||(this.instanceObject=t.createBufferSource(),this.instanceObject.buffer=this.buffer.bufferObject,this.instanceObject.connect(this.gainNode)),this.instanceObject.onended=this.onended_handler,this.active_buffer=this.instanceObject,this.instanceObject.loop=v,this.hasPlaybackEnded=
!1,0===Q?l(this.instanceObject,S):q(this.instanceObject,Q,this.getDuration(),S);else{1!==ea.playbackRate&&(ea.playbackRate=1);ea.loop!==v&&(ea.loop=v);ea.volume=H*U;if(ea.currentTime!==Q)try{ea.currentTime=Q}catch(fa){}e(this)}break;case 2:(!this.fresh&&this.stopped||0!==Q)&&ea.seekTo(Q),ea.play(),this.hasPlaybackEnded=!1}this.playbackRate=1;this.startTime=(this.isTimescaled?g.kahanTime.sum:g.wallTime.sum)-Q;this.is_paused=this.stopped=this.fresh=!1};f.prototype.stop=function(){switch(this.myapi){case 0:this.instanceObject.paused||
this.instanceObject.pause();break;case 1:1===this.buffer.myapi?p(this.instanceObject):this.instanceObject.paused||this.instanceObject.pause();break;case 2:this.instanceObject.stop()}this.stopped=!0;this.is_paused=!1};f.prototype.pause=function(){if(!(this.fresh||this.stopped||this.hasEnded()||this.is_paused)){switch(this.myapi){case 0:this.instanceObject.paused||this.instanceObject.pause();break;case 1:1===this.buffer.myapi?(this.resume_position=this.getPlaybackTime(!0),this.looping&&(this.resume_position%=
this.getDuration()),this.is_paused=!0,p(this.instanceObject)):this.instanceObject.paused||this.instanceObject.pause();break;case 2:this.instanceObject.pause()}this.is_paused=!0}};f.prototype.resume=function(){if(!(this.fresh||this.stopped||this.hasEnded())&&this.is_paused){switch(this.myapi){case 0:e(this);break;case 1:1===this.buffer.myapi?(this.instanceObject=t.createBufferSource(),this.instanceObject.buffer=this.buffer.bufferObject,this.instanceObject.connect(this.gainNode),this.instanceObject.onended=
this.onended_handler,this.active_buffer=this.instanceObject,this.instanceObject.loop=this.looping,this.gainNode.gain.value=U*this.volume*this.mutevol,this.updatePlaybackRate(),this.startTime=(this.isTimescaled?g.kahanTime.sum:g.wallTime.sum)-this.resume_position/(this.playbackRate||.001),q(this.instanceObject,this.resume_position,this.getDuration())):e(this);break;case 2:this.instanceObject.play()}this.is_paused=!1}};f.prototype.seek=function(v){if(!(this.fresh||this.stopped||this.hasEnded()))switch(this.myapi){case 0:try{this.instanceObject.currentTime=
v}catch(H){}break;case 1:if(1===this.buffer.myapi)this.is_paused?this.resume_position=v:(this.pause(),this.resume_position=v,this.resume());else try{this.instanceObject.currentTime=v}catch(H){}}};f.prototype.reconnect=function(v){1===this.myapi&&(this.pannerEnabled?(this.pannerNode.disconnect(),this.pannerNode.connect(v)):(this.gainNode.disconnect(),this.gainNode.connect(v)))};f.prototype.getDuration=function(v){var H=0;switch(this.myapi){case 0:"undefined"!==typeof this.instanceObject.duration&&
(H=this.instanceObject.duration);break;case 1:H=this.buffer.bufferObject.duration;break;case 2:H=this.instanceObject.getDuration()}v&&(H/=this.playbackRate||.001);return H};f.prototype.getPlaybackTime=function(v){var H=this.getDuration(),Q=0;switch(this.myapi){case 0:"undefined"!==typeof this.instanceObject.currentTime&&(Q=this.instanceObject.currentTime);break;case 1:if(1===this.buffer.myapi){if(this.is_paused)return this.resume_position;Q=(this.isTimescaled?g.kahanTime.sum:g.wallTime.sum)-this.startTime}else"undefined"!==
typeof this.instanceObject.currentTime&&(Q=this.instanceObject.currentTime)}v&&(Q*=this.playbackRate);!this.looping&&Q>H&&(Q=H);return Q};f.prototype.isPlaying=function(){return!this.is_paused&&!this.fresh&&!this.stopped&&!this.hasEnded()};f.prototype.shouldSave=function(){return!this.fresh&&!this.stopped&&!this.hasEnded()};f.prototype.setVolume=function(v){this.volume=v;this.updateVolume()};f.prototype.updateVolume=function(){var v=this.volume*U;isFinite(v)||(v=0);switch(this.myapi){case 0:"undefined"!==
typeof this.instanceObject.volume&&this.instanceObject.volume!==v&&(this.instanceObject.volume=v);break;case 1:1===this.buffer.myapi?this.gainNode.gain.value=v*this.mutevol:"undefined"!==typeof this.instanceObject.volume&&this.instanceObject.volume!==v&&(this.instanceObject.volume=v)}};f.prototype.getVolume=function(){return this.volume};f.prototype.doSetMuted=function(v){switch(this.myapi){case 0:this.instanceObject.muted!==!!v&&(this.instanceObject.muted=!!v);break;case 1:1===this.buffer.myapi?
(this.mutevol=v?0:1,this.gainNode.gain.value=U*this.volume*this.mutevol):this.instanceObject.muted!==!!v&&(this.instanceObject.muted=!!v)}};f.prototype.setMuted=function(v){this.is_muted=!!v;this.doSetMuted(this.is_muted||this.is_silent)};f.prototype.setSilent=function(v){this.is_silent=!!v;this.doSetMuted(this.is_muted||this.is_silent)};f.prototype.setLooping=function(v){this.looping=v;switch(this.myapi){case 0:this.instanceObject.loop!==!!v&&(this.instanceObject.loop=!!v);break;case 1:this.instanceObject.loop!==
!!v&&(this.instanceObject.loop=!!v)}};f.prototype.setPlaybackRate=function(v){this.playbackRate=v;this.updatePlaybackRate()};f.prototype.getPlaybackRate=function(v){return this.playbackRate};f.prototype.updatePlaybackRate=function(){var v=this.playbackRate;this.isTimescaled&&(v*=g.timescale);switch(this.myapi){case 0:this.instanceObject.playbackRate!==v&&(this.instanceObject.playbackRate=v);break;case 1:1===this.buffer.myapi?this.instanceObject.playbackRate.value!==v&&(this.instanceObject.playbackRate.value=
v):this.instanceObject.playbackRate!==v&&(this.instanceObject.playbackRate=v)}};f.prototype.setSuspended=function(v){switch(this.myapi){case 0:v?this.isPlaying()?(this.resume_me=!0,this.instanceObject.pause()):this.resume_me=!1:this.resume_me&&(this.instanceObject.play(),this.resume_me=!1);break;case 1:v?this.isPlaying()?(this.resume_me=!0,1===this.buffer.myapi?(this.resume_position=this.getPlaybackTime(!0),this.looping&&(this.resume_position%=this.getDuration()),p(this.instanceObject)):this.instanceObject.pause()):
this.resume_me=!1:this.resume_me&&(1===this.buffer.myapi?(this.instanceObject=t.createBufferSource(),this.instanceObject.buffer=this.buffer.bufferObject,this.instanceObject.connect(this.gainNode),this.instanceObject.onended=this.onended_handler,this.active_buffer=this.instanceObject,this.instanceObject.loop=this.looping,this.gainNode.gain.value=U*this.volume*this.mutevol,this.updatePlaybackRate(),this.startTime=(this.isTimescaled?g.kahanTime.sum:g.wallTime.sum)-this.resume_position/(this.playbackRate||
.001),q(this.instanceObject,this.resume_position,this.getDuration())):this.instanceObject.play(),this.resume_me=!1);break;case 2:v?this.isPlaying()?(this.instanceObject.pause(),this.resume_me=!0):this.resume_me=!1:this.resume_me&&(this.resume_me=!1,this.instanceObject.play())}};ha.Instance=function(v){this.type=v;g=this.runtime=v.runtime;u=this;this.listenerTracker=null;this.listenerZ=-600;this.runtime.isWKWebView&&(Aa=!0);!(this.runtime.isiOS||this.runtime.isAndroid&&(this.runtime.isChrome||this.runtime.isAndroidStockBrowser))||
this.runtime.isCrosswalk||this.runtime.isAmazonWebApp||Aa||(Ea=!0);t=null;"undefined"!==typeof AudioContext?(B=1,t=new AudioContext):"undefined"!==typeof webkitAudioContext&&(B=1,t=new webkitAudioContext);this.runtime.isiOS&&t&&(t.close&&t.close(),"undefined"!==typeof AudioContext?t=new AudioContext:"undefined"!==typeof webkitAudioContext&&(t=new webkitAudioContext));1!==B&&this.runtime.isCordova&&"undefined"!==typeof window.Media&&(B=2);2===B&&(I=location.href,v=I.lastIndexOf("/"),-1<v&&(I=I.substr(0,
v+1)),I=I.replace("file://",""));this.runtime.tickMe(this)};var ta=ha.Instance.prototype;ta.onCreate=function(){this.runtime.audioInstance=this;W=this.properties[0];this.saveload=this.properties[1];this.playinbackground=this.properties[2];this.nextPlayTime=0;na=this.properties[4];sa=this.properties[5];this.listenerZ=-this.properties[6];wa=this.properties[7];Ba=this.properties[8];Ia=this.properties[9];this.listenerTracker=new m;var v=this.runtime.draw_width||this.runtime.width,H=this.runtime.draw_height||
this.runtime.height;1===B&&(t.listener.setPosition(v/2,H/2,this.listenerZ),t.listener.setOrientation(0,0,1,0,-1,0),window.c2OnAudioMicStream=function(S,ea){va&&va.disconnect();Da=ea.toLowerCase();va=t.createMediaStreamSource(S);va.connect(k(Da))});this.runtime.addSuspendCallback(function(S){u.onSuspend(S)});var Q=this;this.runtime.addDestroyCallback(function(S){Q.onInstanceDestroyed(S)})};ta.onInstanceDestroyed=function(v){var H;var Q=0;for(H=F.length;Q<H;Q++){var S=F[Q];S.objectTracker&&S.objectTracker.obj===
v&&(S.objectTracker.obj=null,S.pannerEnabled&&S.isPlaying()&&S.looping&&S.stop())}this.listenerTracker.obj===v&&(this.listenerTracker.obj=null)};ta.saveToJSON=function(){var v={silent:T,masterVolume:U,listenerZ:this.listenerZ,listenerUid:this.listenerTracker.hasObject()?this.listenerTracker.obj.uid:-1,playing:[],effects:{}},H=v.playing,Q,S;var ea=0;for(Q=F.length;ea<Q;ea++){var fa=F[ea];if(fa.shouldSave()&&3!==this.saveload&&(!fa.is_music||1!==this.saveload)&&(fa.is_music||2!==this.saveload)){var ma=
fa.getPlaybackTime();fa.looping&&(ma%=fa.getDuration());ma={tag:fa.tag,buffersrc:fa.buffer.src,buffertype:fa.buffer.type,is_music:fa.is_music,playbackTime:ma,volume:fa.volume,looping:fa.looping,muted:fa.is_muted,playbackRate:fa.playbackRate,paused:fa.is_paused,resume_position:fa.resume_position};if(fa.pannerEnabled){ma.pan={};var oa=ma.pan;fa.objectTracker&&fa.objectTracker.hasObject()?oa.objUid=fa.objectTracker.obj.uid:(oa.x=fa.panX,oa.y=fa.panY,oa.a=fa.panAngle);oa.ia=fa.panConeInner;oa.oa=fa.panConeOuter;
oa.og=fa.panConeOuterGain}H.push(ma)}}H=v.effects;for(S in qa)if(qa.hasOwnProperty(S)){fa=[];ea=0;for(Q=qa[S].length;ea<Q;ea++)fa.push({type:qa[S][ea].type,params:qa[S][ea].params});H[S]=fa}return v};var xa=[];ta.loadFromJSON=function(v){var H=v.silent;U=v.masterVolume;this.listenerZ=v.listenerZ;this.listenerTracker.setObject(null);var Q=v.listenerUid;-1!==Q&&(this.listenerTracker.loadUid=Q,xa.push(this.listenerTracker));Q=v.playing;var S;if(3!==this.saveload){var ea=0;for(S=F.length;ea<S;ea++){var fa=
F[ea];fa.is_music&&1===this.saveload||(fa.is_music||2!==this.saveload)&&fa.stop()}}for(ra in qa)if(qa.hasOwnProperty(ra))for(ea=0,S=qa[ra].length;ea<S;ea++)qa[ra][ea].remove();cr.wipe(qa);for(ra in v.effects)if(v.effects.hasOwnProperty(ra)){var ma=v.effects[ra];ea=0;for(S=ma.length;ea<S;ea++){var oa=ma[ea].type;var ka=ma[ea].params;switch(oa){case "filter":X(ra,new K(ka[0],ka[1],ka[2],ka[3],ka[4],ka[5]));break;case "delay":X(ra,new A(ka[0],ka[1],ka[2]));break;case "convolve":oa=ka[2];fa=this.getAudioBuffer(oa,
!1);fa.bufferObject?oa=new J(fa.bufferObject,ka[0],ka[1],oa):(oa=new J(null,ka[0],ka[1],oa),fa.normalizeWhenReady=ka[0],fa.convolveWhenReady=oa);X(ra,oa);break;case "flanger":X(ra,new R(ka[0],ka[1],ka[2],ka[3],ka[4]));break;case "phaser":X(ra,new n(ka[0],ka[1],ka[2],ka[3],ka[4],ka[5]));break;case "gain":X(ra,new x(ka[0]));break;case "tremolo":X(ra,new E(ka[0],ka[1]));break;case "ringmod":X(ra,new V(ka[0],ka[1]));break;case "distortion":X(ra,new Z(ka[0],ka[1],ka[2],ka[3],ka[4]));break;case "compressor":X(ra,
new M(ka[0],ka[1],ka[2],ka[3],ka[4]));break;case "analyser":X(ra,new d(ka[0],ka[1]))}}}ea=0;for(S=Q.length;ea<S;ea++)if(3!==this.saveload){v=Q[ea];oa=v.buffersrc;fa=v.buffertype||"";var ua=v.is_music;var ra=v.tag;ma=v.playbackTime;var Ja=v.looping;var Ka=v.volume;var Ca=(ka=v.pan)&&ka.hasOwnProperty("objUid")?ka.objUid:-1;if(!ua||1!==this.saveload)if(ua||2!==this.saveload)(fa=this.getAudioInstance({url:oa,type:fa},ra,ua,Ja,Ka))?(fa.resume_position=v.resume_position,fa.setPannerEnabled(!!ka),fa.play(Ja,
Ka,ma),fa.updatePlaybackRate(),fa.updateVolume(),fa.doSetMuted(fa.is_muted||fa.is_silent),v.paused&&fa.pause(),v.muted&&fa.setMuted(!0),fa.doSetMuted(fa.is_muted||fa.is_silent),ka&&(-1!==Ca?(fa.objectTracker=fa.objectTracker||new m,fa.objectTracker.loadUid=Ca,xa.push(fa.objectTracker)):fa.setPan(ka.x,ka.y,ka.a,ka.ia,ka.oa,ka.og))):(fa=this.getAudioBuffer({url:oa,type:""},ua),fa.seekWhenReady=ma,fa.pauseWhenReady=v.paused,ka&&(-1!==Ca?fa.panWhenReady.push({objUid:Ca,ia:ka.ia,oa:ka.oa,og:ka.og,thistag:ra}):
fa.panWhenReady.push({x:ka.x,y:ka.y,a:ka.a,ia:ka.ia,oa:ka.oa,og:ka.og,thistag:ra})))}if(H&&!T){ea=0;for(S=F.length;ea<S;ea++)F[ea].setSilent(!0);T=!0}else if(!H&&T){ea=0;for(S=F.length;ea<S;ea++)F[ea].setSilent(!1);T=!1}};ta.afterLoad=function(){var v;var H=0;for(v=xa.length;H<v;H++){var Q=xa[H];var S=this.runtime.getObjectByUID(Q.loadUid);Q.setObject(S);Q.loadUid=-1;S&&(Y=S.x,da=S.y)}cr.clearArray(xa)};ta.onSuspend=function(v){if(!this.playinbackground){!v&&t&&t.resume&&(t.resume(),ia=!1);var H;
var Q=0;for(H=F.length;Q<H;Q++)F[Q].setSuspended(v);v&&t&&t.suspend&&(t.suspend(),ia=!0)}};ta.tick=function(){var v=this.runtime.dt,H;var Q=0;for(H=F.length;Q<H;Q++){var S=F[Q];S.tick(v);0!==W&&S.updatePlaybackRate()}var ea;for(ea in qa)if(qa.hasOwnProperty(ea))for(S=qa[ea],Q=0,H=S.length;Q<H;Q++){var fa=S[Q];fa.tick&&fa.tick()}1===B&&this.listenerTracker.hasObject()&&(this.listenerTracker.tick(v),Y=this.listenerTracker.obj.x,da=this.listenerTracker.obj.y,t.listener.setPosition(this.listenerTracker.obj.x,
this.listenerTracker.obj.y,this.listenerZ))};var ya=[];ta.setPreloadList=function(v){var H,Q=0;var S=0;for(H=v.length;S<H;++S){var ea=v[S];var fa=2*ea.size;ya.push({filename:ea.filename,size:fa,type:ea.type,obj:null});Q+=fa}return Q};ta.startPreloads=function(){var v;var H=0;for(v=ya.length;H<v;++H){var Q=ya[H];var S=this.runtime.getProjectFileUrl(Q.filename);Q.obj=this.getAudioBuffer({url:S,type:Q.type},!1)}};ta.getPreloadedSize=function(){var v=0,H;var Q=0;for(H=ya.length;Q<H;++Q){var S=ya[Q];S.obj.isLoadedAndDecoded()||
S.obj.hasFailedToLoad()||this.runtime.isAndroidStockBrowser?v+=S.size:S.obj.isLoaded()&&(v+=Math.floor(S.size/2))}return v};ta.releaseAllMusicBuffers=function(){var v,H;var Q=v=0;for(H=C.length;v<H;++v){var S=C[v];C[Q]=S;S.is_music?S.release():++Q}C.length=Q};ta.getAudioBuffer=function(v,H,Q){var S,ea=null,fa=v.url;var ma=0;for(S=C.length;ma<S;ma++){var oa=C[ma];if(oa.src===fa){ea=oa;break}}ea||Q||((Aa||Ha)&&H&&this.releaseAllMusicBuffers(),ea=new G(fa,v.type,H),C.push(ea));return ea};ta.getAudioInstance=
function(v,H,Q,S,ea){var fa,ma=v.url;var oa=0;for(fa=F.length;oa<fa;oa++){var ka=F[oa];if(ka.src===ma&&(ka.canBeRecycled()||Q))return ka.tag=H,ka}v=this.getAudioBuffer(v,Q);if(!v.bufferObject)return"<preload>"!==H&&(v.playTagWhenReady=H,v.loopWhenReady=S,v.volumeWhenReady=ea),null;ka=new f(v,H);F.push(ka);return ka};var pa=[];ba.prototype.OnEnded=function(v){return cr.equals_nocase(D,v)};ba.prototype.PreloadsComplete=function(){var v;var H=0;for(v=C.length;H<v;H++)if(!C[H].isLoadedAndDecoded()&&!C[H].hasFailedToLoad())return!1;
return!0};ba.prototype.AdvancedAudioSupported=function(){return 1===B};ba.prototype.IsSilent=function(){return T};ba.prototype.IsAnyPlaying=function(){var v;var H=0;for(v=F.length;H<v;H++)if(F[H].isPlaying())return!0;return!1};ba.prototype.IsTagPlaying=function(v){L(v);var H;v=0;for(H=pa.length;v<H;v++)if(pa[v].isPlaying())return!0;return!1};ha.cnds=new ba;aa.prototype.Play=function(v,H,Q,S){if(!T){Q=z(Q);var ea=v[1];if(v=this.runtime.getProjectAudioFileUrl(v[0]))if(O=this.getAudioInstance(v,S,ea,
0!==H,Q))O.setPannerEnabled(!1),O.play(0!==H,Q,0,this.nextPlayTime),this.nextPlayTime=0}};aa.prototype.PlayAtPosition=function(v,H,Q,S,ea,fa,ma,oa,ka,ua){if(!T){Q=z(Q);var ra=v[1];if(v=this.runtime.getProjectAudioFileUrl(v[0]))(O=this.getAudioInstance(v,ua,ra,0!==H,Q))?(O.setPannerEnabled(!0),O.setPan(S,ea,fa,ma,oa,z(ka)),O.play(0!==H,Q,0,this.nextPlayTime),this.nextPlayTime=0):this.getAudioBuffer(v,ra).panWhenReady.push({x:S,y:ea,a:fa,ia:ma,oa,og:z(ka),thistag:ua})}};aa.prototype.PlayAtObject=function(v,
H,Q,S,ea,fa,ma,oa){if(!T&&S&&(S=S.getFirstPicked())){Q=z(Q);var ka=v[1];if(v=this.runtime.getProjectAudioFileUrl(v[0]))(O=this.getAudioInstance(v,oa,ka,0!==H,Q))?(O.setPannerEnabled(!0),oa=cr.rotatePtAround(S.x,S.y,-S.layer.getAngle(),Y,da,!0),v=cr.rotatePtAround(S.x,S.y,-S.layer.getAngle(),Y,da,!1),O.setPan(oa,v,cr.to_degrees(S.angle-S.layer.getAngle()),ea,fa,z(ma)),O.setObject(S),O.play(0!==H,Q,0,this.nextPlayTime),this.nextPlayTime=0):this.getAudioBuffer(v,ka).panWhenReady.push({obj:S,ia:ea,oa:fa,
og:z(ma),thistag:oa})}};aa.prototype.PlayByName=function(v,H,Q,S,ea){!T&&(S=z(S),v=1===v,H=this.runtime.getProjectAudioFileUrl(H))&&(O=this.getAudioInstance(H,ea,v,0!==Q,S))&&(O.setPannerEnabled(!1),O.play(0!==Q,S,0,this.nextPlayTime),this.nextPlayTime=0)};aa.prototype.PlayAtPositionByName=function(v,H,Q,S,ea,fa,ma,oa,ka,ua,ra){!T&&(S=z(S),v=1===v,H=this.runtime.getProjectAudioFileUrl(H))&&((O=this.getAudioInstance(H,ra,v,0!==Q,S))?(O.setPannerEnabled(!0),O.setPan(ea,fa,ma,oa,ka,z(ua)),O.play(0!==
Q,S,0,this.nextPlayTime),this.nextPlayTime=0):this.getAudioBuffer(H,v).panWhenReady.push({x:ea,y:fa,a:ma,ia:oa,oa:ka,og:z(ua),thistag:ra}))};aa.prototype.PlayAtObjectByName=function(v,H,Q,S,ea,fa,ma,oa,ka){!T&&ea&&(ea=ea.getFirstPicked())&&(S=z(S),v=1===v,H=this.runtime.getProjectAudioFileUrl(H))&&((O=this.getAudioInstance(H,ka,v,0!==Q,S))?(O.setPannerEnabled(!0),ka=cr.rotatePtAround(ea.x,ea.y,-ea.layer.getAngle(),Y,da,!0),H=cr.rotatePtAround(ea.x,ea.y,-ea.layer.getAngle(),Y,da,!1),O.setPan(ka,H,
cr.to_degrees(ea.angle-ea.layer.getAngle()),fa,ma,z(oa)),O.setObject(ea),O.play(0!==Q,S,0,this.nextPlayTime),this.nextPlayTime=0):this.getAudioBuffer(H,v).panWhenReady.push({obj:ea,ia:fa,oa:ma,og:z(oa),thistag:ka}))};aa.prototype.SetLooping=function(v,H){L(v);var Q;v=0;for(Q=pa.length;v<Q;v++)pa[v].setLooping(0===H)};aa.prototype.SetMuted=function(v,H){L(v);var Q;v=0;for(Q=pa.length;v<Q;v++)pa[v].setMuted(0===H)};aa.prototype.SetVolume=function(v,H){L(v);v=z(H);var Q;H=0;for(Q=pa.length;H<Q;H++)pa[H].setVolume(v)};
aa.prototype.Preload=function(v){if(!T){var H=v[1];(v=this.runtime.getProjectAudioFileUrl(v[0]))&&2!==B&&this.getAudioInstance(v,"<preload>",H,!1)}};aa.prototype.PreloadByName=function(v,H){T||(v=1===v,(H=this.runtime.getProjectAudioFileUrl(H))&&2!==B&&this.getAudioInstance(H,"<preload>",v,!1))};aa.prototype.SetPlaybackRate=function(v,H){L(v);0>H&&(H=0);var Q;v=0;for(Q=pa.length;v<Q;v++)pa[v].setPlaybackRate(H)};aa.prototype.Stop=function(v){L(v);var H;v=0;for(H=pa.length;v<H;v++)pa[v].stop()};aa.prototype.StopAll=
function(){var v;var H=0;for(v=F.length;H<v;H++)F[H].stop()};aa.prototype.SetPaused=function(v,H){L(v);var Q;v=0;for(Q=pa.length;v<Q;v++)0===H?pa[v].pause():pa[v].resume()};aa.prototype.Seek=function(v,H){L(v);var Q;v=0;for(Q=pa.length;v<Q;v++)pa[v].seek(H)};aa.prototype.SetSilent=function(v){var H;2===v&&(v=T?1:0);if(0===v&&!T){v=0;for(H=F.length;v<H;v++)F[v].setSilent(!0);T=!0}else if(1===v&&T){v=0;for(H=F.length;v<H;v++)F[v].setSilent(!1);T=!1}};aa.prototype.SetMasterVolume=function(v){U=z(v);
var H;v=0;for(H=F.length;v<H;v++)F[v].updateVolume()};aa.prototype.AddFilterEffect=function(v,H,Q,S,ea,fa,ma){1!==B||0>H||H>=Ga.length||!t.createBiquadFilter||(v=v.toLowerCase(),ma/=100,0>ma&&(ma=0),1<ma&&(ma=1),X(v,new K(H,Q,S,ea,fa,ma)))};aa.prototype.AddDelayEffect=function(v,H,Q,S){1===B&&(v=v.toLowerCase(),S/=100,0>S&&(S=0),1<S&&(S=1),X(v,new A(H,z(Q),S)))};aa.prototype.AddFlangerEffect=function(v,H,Q,S,ea,fa){1===B&&t.createOscillator&&(v=v.toLowerCase(),fa/=100,0>fa&&(fa=0),1<fa&&(fa=1),X(v,
new R(H/1E3,Q/1E3,S,ea/100,fa)))};aa.prototype.AddPhaserEffect=function(v,H,Q,S,ea,fa,ma){1===B&&t.createOscillator&&(v=v.toLowerCase(),ma/=100,0>ma&&(ma=0),1<ma&&(ma=1),X(v,new n(H,Q,S,ea,fa,ma)))};aa.prototype.AddConvolutionEffect=function(v,H,Q,S){if(1===B&&t.createConvolver){Q=0===Q;var ea=this.runtime.getProjectAudioFileUrl(H[0]);ea&&(H=this.getAudioBuffer(ea,!1),v=v.toLowerCase(),S/=100,0>S&&(S=0),1<S&&(S=1),H.bufferObject?S=new J(H.bufferObject,Q,S,ea.url):(S=new J(null,Q,S,ea.url),H.normalizeWhenReady=
Q,H.convolveWhenReady=S),X(v,S))}};aa.prototype.AddGainEffect=function(v,H){1===B&&(v=v.toLowerCase(),X(v,new x(z(H))))};aa.prototype.AddMuteEffect=function(v){1===B&&(v=v.toLowerCase(),X(v,new x(0)))};aa.prototype.AddTremoloEffect=function(v,H,Q){1===B&&t.createOscillator&&(v=v.toLowerCase(),Q/=100,0>Q&&(Q=0),1<Q&&(Q=1),X(v,new E(H,Q)))};aa.prototype.AddRingModEffect=function(v,H,Q){1===B&&t.createOscillator&&(v=v.toLowerCase(),Q/=100,0>Q&&(Q=0),1<Q&&(Q=1),X(v,new V(H,Q)))};aa.prototype.AddDistortionEffect=
function(v,H,Q,S,ea,fa){1===B&&t.createWaveShaper&&(v=v.toLowerCase(),fa/=100,0>fa&&(fa=0),1<fa&&(fa=1),X(v,new Z(H,Q,S,ea,fa)))};aa.prototype.AddCompressorEffect=function(v,H,Q,S,ea,fa){1===B&&t.createDynamicsCompressor&&(v=v.toLowerCase(),X(v,new M(H,Q,S,ea/1E3,fa/1E3)))};aa.prototype.AddAnalyserEffect=function(v,H,Q){1===B&&(v=v.toLowerCase(),X(v,new d(H,Q)))};aa.prototype.RemoveEffects=function(v){if(1===B){v=v.toLowerCase();var H;if(qa.hasOwnProperty(v)){var Q=qa[v];if(Q.length){var S=0;for(H=
Q.length;S<H;S++)Q[S].remove();cr.clearArray(Q);P(v)}}}};aa.prototype.SetEffectParameter=function(v,H,Q,S,ea,fa){1===B&&(v=v.toLowerCase(),H=Math.floor(H),qa.hasOwnProperty(v)&&(v=qa[v],0>H||H>=v.length||v[H].setParam(Q,S,ea,fa)))};aa.prototype.SetListenerObject=function(v){v&&1===B&&(v=v.getFirstPicked())&&(this.listenerTracker.setObject(v),Y=v.x,da=v.y)};aa.prototype.SetListenerZ=function(v){this.listenerZ=v};aa.prototype.ScheduleNextPlay=function(v){t&&(this.nextPlayTime=v)};aa.prototype.UnloadAudio=
function(v){var H=v[1];if(v=this.runtime.getProjectAudioFileUrl(v[0]))if(H=this.getAudioBuffer(v,H,!0))H.release(),cr.arrayFindRemove(C,H)};aa.prototype.UnloadAudioByName=function(v,H){v=1===v;if(H=this.runtime.getProjectAudioFileUrl(H))if(H=this.getAudioBuffer(H,v,!0))H.release(),cr.arrayFindRemove(C,H)};aa.prototype.UnloadAll=function(){var v;var H=0;for(v=C.length;H<v;++H)C[H].release();cr.clearArray(C)};ha.acts=new aa;ca.prototype.Duration=function(v,H){L(H,!0);pa.length?v.set_float(pa[0].getDuration()):
v.set_float(0)};ca.prototype.PlaybackTime=function(v,H){L(H,!0);pa.length?v.set_float(pa[0].getPlaybackTime(!0)):v.set_float(0)};ca.prototype.PlaybackRate=function(v,H){L(H,!0);pa.length?v.set_float(pa[0].getPlaybackRate()):v.set_float(0)};ca.prototype.Volume=function(v,H){L(H,!0);pa.length?(H=pa[0].getVolume(),v.set_float(N(H))):v.set_float(0)};ca.prototype.MasterVolume=function(v){v.set_float(N(U))};ca.prototype.EffectCount=function(v,H){H=H.toLowerCase();var Q=null;qa.hasOwnProperty(H)&&(Q=qa[H]);
v.set_int(Q?Q.length:0)};ca.prototype.AnalyserFreqBinCount=function(v,H,Q){H=H.toLowerCase();Q=Math.floor(Q);H=ja(H,Q);v.set_int(H?H.node.frequencyBinCount:0)};ca.prototype.AnalyserFreqBinAt=function(v,H,Q,S){H=H.toLowerCase();Q=Math.floor(Q);S=Math.floor(S);(H=ja(H,Q))?0>S||S>=H.node.frequencyBinCount?v.set_float(0):v.set_float(H.freqBins[S]):v.set_float(0)};ca.prototype.AnalyserPeakLevel=function(v,H,Q){H=H.toLowerCase();Q=Math.floor(Q);(H=ja(H,Q))?v.set_float(H.peak):v.set_float(0)};ca.prototype.AnalyserRMSLevel=
function(v,H,Q){H=H.toLowerCase();Q=Math.floor(Q);(H=ja(H,Q))?v.set_float(H.rms):v.set_float(0)};ca.prototype.SampleRate=function(v){v.set_int(t?t.sampleRate:0)};ca.prototype.CurrentTime=function(v){v.set_float(t?t.currentTime:cr.performance_now())};ha.exps=new ca})();cr.plugins_.Keyboard=function(b){this.runtime=b};
(function(){function b(){}function e(){}function h(k){k=Math.floor(k);switch(k){case 8:return"backspace";case 9:return"tab";case 13:return"enter";case 16:return"shift";case 17:return"control";case 18:return"alt";case 19:return"pause";case 20:return"capslock";case 27:return"esc";case 33:return"pageup";case 34:return"pagedown";case 35:return"end";case 36:return"home";case 37:return"\u2190";case 38:return"\u2191";case 39:return"\u2192";case 40:return"\u2193";case 45:return"insert";case 46:return"del";
case 91:return"left window key";case 92:return"right window key";case 93:return"select";case 96:return"numpad 0";case 97:return"numpad 1";case 98:return"numpad 2";case 99:return"numpad 3";case 100:return"numpad 4";case 101:return"numpad 5";case 102:return"numpad 6";case 103:return"numpad 7";case 104:return"numpad 8";case 105:return"numpad 9";case 106:return"numpad *";case 107:return"numpad +";case 109:return"numpad -";case 110:return"numpad .";case 111:return"numpad /";case 112:return"F1";case 113:return"F2";
case 114:return"F3";case 115:return"F4";case 116:return"F5";case 117:return"F6";case 118:return"F7";case 119:return"F8";case 120:return"F9";case 121:return"F10";case 122:return"F11";case 123:return"F12";case 144:return"numlock";case 145:return"scroll lock";case 186:return";";case 187:return"=";case 188:return",";case 189:return"-";case 190:return".";case 191:return"/";case 192:return"'";case 219:return"[";case 220:return"\\";case 221:return"]";case 222:return"#";case 223:return"`";default:return String.fromCharCode(k)}}
var r=cr.plugins_.Keyboard.prototype;r.Type=function(k){this.plugin=k;this.runtime=k.runtime};r.Type.prototype.onCreate=function(){};r.Instance=function(k){this.type=k;this.runtime=k.runtime;this.keyMap=Array(256);this.typedKeyMap=Array(256);this.usedKeys=Array(256);this.triggerKey=0};var z=r.Instance.prototype;z.onCreate=function(){var k=this;document.addEventListener("keydown",function(a){k.onKeyDown(a)});document.addEventListener("keyup",function(a){k.onKeyUp(a)})};var N=[32,33,34,35,36,37,38,
39,40,44];z.onKeyDown=function(k){var a=!1;window!=window.top&&-1<N.indexOf(k.which)&&(k.preventDefault(),a=!0,k.stopPropagation());if(this.keyMap[k.which])this.usedKeys[k.which]&&!a&&k.preventDefault();else{var c=k.which;this.typedKeyMap[c]=k.key;this.keyMap[c]=!0;this.triggerKey=c;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnAnyKey,this);var l=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKey,this),q=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyCode,
this);this.runtime.isInUserInputEvent=!1;if(l||q)this.usedKeys[c]=!0,a||k.preventDefault()}};z.onKeyUp=function(k){var a=k.which;this.typedKeyMap[a]=k.key;this.keyMap[a]=!1;this.triggerKey=a;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnAnyKeyReleased,this);var c=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyReleased,this),l=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyCodeReleased,this);this.runtime.isInUserInputEvent=
!1;if(c||l||this.usedKeys[k.which])this.usedKeys[a]=!0,k.preventDefault()};z.onWindowBlur=function(){var k;for(k=0;256>k;++k)if(this.keyMap[k]){this.keyMap[k]=!1;this.triggerKey=k;this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnAnyKeyReleased,this);var a=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyReleased,this),c=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyCodeReleased,this);if(a||c)this.usedKeys[k]=!0}};z.saveToJSON=function(){return{triggerKey:this.triggerKey}};
z.loadFromJSON=function(k){this.triggerKey=k.triggerKey};b.prototype.IsKeyDown=function(k){return this.keyMap[k]};b.prototype.OnKey=function(k){return k===this.triggerKey};b.prototype.OnAnyKey=function(k){return!0};b.prototype.OnAnyKeyReleased=function(k){return!0};b.prototype.OnKeyReleased=function(k){return k===this.triggerKey};b.prototype.IsKeyCodeDown=function(k){k=Math.floor(k);return 0>k||k>=this.keyMap.length?!1:this.keyMap[k]};b.prototype.OnKeyCode=function(k){return k===this.triggerKey};
b.prototype.OnKeyCodeReleased=function(k){return k===this.triggerKey};r.cnds=new b;r.acts=new function(){};e.prototype.TypedKey=function(k){k.set_string(this.typedKeyMap[this.triggerKey]||"")};e.prototype.LastKeyCode=function(k){k.set_int(this.triggerKey)};e.prototype.StringFromKeyCode=function(k,a){k.set_string(h(a))};r.exps=new e})();cr.plugins_.Particles=function(b){this.runtime=b};
(function(){function b(a){this.owner=a;this.active=!1;this.angle=this.speed=this.y=this.x=0;this.opacity=1;this.age=this.gs=this.size=this.grow=0;cr.seal(this)}function e(){}function h(){}function r(){}var z=cr.plugins_.Particles.prototype;z.Type=function(a){this.plugin=a;this.runtime=a.runtime};var N=z.Type.prototype;N.onCreate=function(){this.is_family||(this.texture_img=this.runtime.findWaitingTexture(this.texture_file),this.texture_img||(this.texture_img=new Image,this.texture_img.cr_src=this.texture_file,
this.texture_img.cr_filesize=this.texture_filesize,this.texture_img.c2webGL_texture=null,this.runtime.waitForImageLoad(this.texture_img,this.texture_file)),this.spriteX=this.texture_data[3],this.spriteY=this.texture_data[4],this.spriteWidth=this.texture_data[5],this.spriteHeight=this.texture_data[6])};N.onLostWebGLContext=function(){this.is_family||(this.webGL_texture=null)};N.createParticleTexture=function(){var a=document.createElement("canvas"),c=this.spriteWidth,l=this.spriteHeight;a.width=c;
a.height=l;a.getContext("2d").drawImage(this.texture_img,this.spriteX,this.spriteY,c,l,0,0,c,l);this.webGL_texture=this.runtime.glwrap.loadTexture(a,!0,this.runtime.linearSampling,this.texture_pixelformat)};N.onRestoreWebGLContext=function(){!this.is_family&&this.instances.length&&(this.webGL_texture||this.createParticleTexture())};N.loadTextures=function(){this.is_family||this.webGL_texture||!this.runtime.glwrap||this.createParticleTexture()};N.unloadTextures=function(){this.is_family||this.instances.length||
!this.webGL_texture||(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)};N.preloadCanvas2D=function(a){a.drawImage(this.texture_img,0,0)};b.prototype.init=function(){var a=this.owner;this.x=a.x-a.xrandom/2+Math.random()*a.xrandom;this.y=a.y-a.yrandom/2+Math.random()*a.yrandom;this.speed=a.initspeed-a.speedrandom/2+Math.random()*a.speedrandom;this.angle=a.angle-a.spraycone/2+Math.random()*a.spraycone;this.opacity=a.initopacity;this.size=a.initsize-a.sizerandom/2+Math.random()*
a.sizerandom;this.grow=a.growrate-a.growrandom/2+Math.random()*a.growrandom;this.age=this.gs=0};b.prototype.tick=function(a){var c=this.owner;this.x+=Math.cos(this.angle)*this.speed*a;this.y+=Math.sin(this.angle)*this.speed*a;this.y+=this.gs*a;this.speed+=c.acc*a;this.size+=this.grow*a;this.gs+=c.g*a;this.age+=a;1>this.size?this.active=!1:(0!==c.lifeanglerandom&&(this.angle+=Math.random()*c.lifeanglerandom*a-c.lifeanglerandom*a/2),0!==c.lifespeedrandom&&(this.speed+=Math.random()*c.lifespeedrandom*
a-c.lifespeedrandom*a/2),0!==c.lifeopacityrandom&&(this.opacity+=Math.random()*c.lifeopacityrandom*a-c.lifeopacityrandom*a/2,0>this.opacity?this.opacity=0:1<this.opacity&&(this.opacity=1)),1>=c.destroymode&&this.age>=c.timeout&&(this.active=!1),2===c.destroymode&&0>=this.speed&&(this.active=!1))};b.prototype.draw=function(a){var c=this.owner.opacity*this.opacity;if(0!==c){0===this.owner.destroymode&&(c*=1-this.age/this.owner.timeout);a.globalAlpha=c;c=this.x-this.size/2;var l=this.y-this.size/2;this.owner.runtime.pixel_rounding&&
(c=c+.5|0,l=l+.5|0);var q=this.owner.type;a.drawImage(q.texture_img,q.spriteX,q.spriteY,q.spriteWidth,q.spriteHeight,c,l,this.size,this.size)}};b.prototype.drawGL=function(a){var c=this.owner.opacity*this.opacity;0===this.owner.destroymode&&(c*=1-this.age/this.owner.timeout);var l=this.size,q=l*this.owner.particlescale,p=this.x-l/2,w=this.y-l/2;this.owner.runtime.pixel_rounding&&(p=p+.5|0,w=w+.5|0);1>q||0===c||(q<a.minPointSize||q>a.maxPointSize?(a.setOpacity(c),a.quad(p,w,p+l,w,p+l,w+l,p,w+l)):a.point(this.x,
this.y,q,c))};b.prototype.left=function(){return this.x-this.size/2};b.prototype.right=function(){return this.x+this.size/2};b.prototype.top=function(){return this.y-this.size/2};b.prototype.bottom=function(){return this.y+this.size/2};z.Instance=function(a){this.type=a;this.runtime=a.runtime};N=z.Instance.prototype;var k=[];N.onCreate=function(){var a=this.properties;this.rate=a[0];this.spraycone=cr.to_radians(a[1]);this.spraytype=a[2];this.spraying=!0;this.initspeed=a[4];this.initsize=a[5];this.initopacity=
a[6]/100;this.growrate=a[7];this.xrandom=a[8];this.yrandom=a[9];this.speedrandom=a[10];this.sizerandom=a[11];this.growrandom=a[12];this.acc=a[13];this.g=a[14];this.lifeanglerandom=a[15];this.lifespeedrandom=a[16];this.lifeopacityrandom=a[17];this.destroymode=a[18];this.timeout=a[19];this.particleCreateCounter=0;this.particlescale=1;this.particleBoxLeft=this.x;this.particleBoxTop=this.y;this.particleBoxRight=this.x;this.particleBoxBottom=this.y;this.add_bbox_changed_callback(function(c){c.bbox.set(c.particleBoxLeft,
c.particleBoxTop,c.particleBoxRight,c.particleBoxBottom);c.bquad.set_from_rect(c.bbox);c.bbox_changed=!1;c.update_collision_cell();c.update_render_cell()});this.recycled||(this.particles=[]);this.runtime.tickMe(this);this.type.loadTextures();if(1===this.spraytype)for(a=0;a<this.rate;a++)this.allocateParticle().opacity=0;this.first_tick=!0};N.saveToJSON=function(){var a={r:this.rate,sc:this.spraycone,st:this.spraytype,s:this.spraying,isp:this.initspeed,isz:this.initsize,io:this.initopacity,gr:this.growrate,
xr:this.xrandom,yr:this.yrandom,spr:this.speedrandom,szr:this.sizerandom,grnd:this.growrandom,acc:this.acc,g:this.g,lar:this.lifeanglerandom,lsr:this.lifespeedrandom,lor:this.lifeopacityrandom,dm:this.destroymode,to:this.timeout,pcc:this.particleCreateCounter,ft:this.first_tick,p:[]},c,l=a.p;var q=0;for(c=this.particles.length;q<c;q++){var p=this.particles[q];l.push([p.x,p.y,p.speed,p.angle,p.opacity,p.grow,p.size,p.gs,p.age])}return a};N.loadFromJSON=function(a){this.rate=a.r;this.spraycone=a.sc;
this.spraytype=a.st;this.spraying=a.s;this.initspeed=a.isp;this.initsize=a.isz;this.initopacity=a.io;this.growrate=a.gr;this.xrandom=a.xr;this.yrandom=a.yr;this.speedrandom=a.spr;this.sizerandom=a.szr;this.growrandom=a.grnd;this.acc=a.acc;this.g=a.g;this.lifeanglerandom=a.lar;this.lifespeedrandom=a.lsr;this.lifeopacityrandom=a.lor;this.destroymode=a.dm;this.timeout=a.to;this.particleCreateCounter=a.pcc;this.first_tick=a.ft;k.push.apply(k,this.particles);cr.clearArray(this.particles);var c,l=a.p;a=
0;for(c=l.length;a<c;a++){var q=this.allocateParticle();var p=l[a];q.x=p[0];q.y=p[1];q.speed=p[2];q.angle=p[3];q.opacity=p[4];q.grow=p[5];q.size=p[6];q.gs=p[7];q.age=p[8]}};N.onDestroy=function(){k.push.apply(k,this.particles);cr.clearArray(this.particles)};N.allocateParticle=function(){if(k.length){var a=k.pop();a.owner=this}else a=new b(this);this.particles.push(a);a.active=!0;return a};N.tick=function(){var a=this.runtime.getDt(this),c;if(0===this.spraytype&&this.spraying){this.particleCreateCounter+=
a*this.rate;var l=cr.floor(this.particleCreateCounter);this.particleCreateCounter-=l;for(c=0;c<l;c++){var q=this.allocateParticle();q.init()}}this.particleBoxLeft=this.x;this.particleBoxTop=this.y;this.particleBoxRight=this.x;this.particleBoxBottom=this.y;var p=c=0;for(l=this.particles.length;c<l;c++)q=this.particles[c],this.particles[p]=q,this.runtime.redraw=!0,1===this.spraytype&&this.first_tick&&q.init(),q.tick(a),q.active?(q.left()<this.particleBoxLeft&&(this.particleBoxLeft=q.left()),q.right()>
this.particleBoxRight&&(this.particleBoxRight=q.right()),q.top()<this.particleBoxTop&&(this.particleBoxTop=q.top()),q.bottom()>this.particleBoxBottom&&(this.particleBoxBottom=q.bottom()),p++):k.push(q);cr.truncateArray(this.particles,p);this.set_bbox_changed();this.first_tick=!1;1===this.spraytype&&0===this.particles.length&&this.runtime.DestroyInstance(this)};N.draw=function(a){var c,l=this.layer;var q=0;for(c=this.particles.length;q<c;q++){var p=this.particles[q];p.right()>=l.viewLeft&&p.bottom()>=
l.viewTop&&p.left()<=l.viewRight&&p.top()<=l.viewBottom&&p.draw(a)}};N.drawGL=function(a){this.particlescale=this.layer.getScale();a.setTexture(this.type.webGL_texture);var c,l=this.layer;var q=0;for(c=this.particles.length;q<c;q++){var p=this.particles[q];p.right()>=l.viewLeft&&p.bottom()>=l.viewTop&&p.left()<=l.viewRight&&p.top()<=l.viewBottom&&p.drawGL(a)}};e.prototype.IsSpraying=function(){return this.spraying};z.cnds=new e;h.prototype.SetSpraying=function(a){this.spraying=0!==a};h.prototype.SetEffect=
function(a){this.blend_mode=a;this.compositeOp=cr.effectToCompositeOp(a);cr.setGLBlend(this,a,this.runtime.gl);this.runtime.redraw=!0};h.prototype.SetRate=function(a){this.rate=a;var c;if(1===this.spraytype&&this.first_tick)if(a<this.particles.length)for(a=this.particles.length-a,c=0;c<a;c++)k.push(this.particles.pop());else if(a>this.particles.length)for(a-=this.particles.length,c=0;c<a;c++)this.allocateParticle().opacity=0};h.prototype.SetSprayCone=function(a){this.spraycone=cr.to_radians(a)};h.prototype.SetInitSpeed=
function(a){this.initspeed=a};h.prototype.SetInitSize=function(a){this.initsize=a};h.prototype.SetInitOpacity=function(a){this.initopacity=a/100};h.prototype.SetGrowRate=function(a){this.growrate=a};h.prototype.SetXRandomiser=function(a){this.xrandom=a};h.prototype.SetYRandomiser=function(a){this.yrandom=a};h.prototype.SetSpeedRandomiser=function(a){this.speedrandom=a};h.prototype.SetSizeRandomiser=function(a){this.sizerandom=a};h.prototype.SetGrowRateRandomiser=function(a){this.growrandom=a};h.prototype.SetParticleAcc=
function(a){this.acc=a};h.prototype.SetGravity=function(a){this.g=a};h.prototype.SetAngleRandomiser=function(a){this.lifeanglerandom=a};h.prototype.SetLifeSpeedRandomiser=function(a){this.lifespeedrandom=a};h.prototype.SetOpacityRandomiser=function(a){this.lifeopacityrandom=a};h.prototype.SetTimeout=function(a){this.timeout=a};z.acts=new h;r.prototype.ParticleCount=function(a){a.set_int(this.particles.length)};r.prototype.Rate=function(a){a.set_float(this.rate)};r.prototype.SprayCone=function(a){a.set_float(cr.to_degrees(this.spraycone))};
r.prototype.InitSpeed=function(a){a.set_float(this.initspeed)};r.prototype.InitSize=function(a){a.set_float(this.initsize)};r.prototype.InitOpacity=function(a){a.set_float(100*this.initopacity)};r.prototype.InitGrowRate=function(a){a.set_float(this.growrate)};r.prototype.XRandom=function(a){a.set_float(this.xrandom)};r.prototype.YRandom=function(a){a.set_float(this.yrandom)};r.prototype.InitSpeedRandom=function(a){a.set_float(this.speedrandom)};r.prototype.InitSizeRandom=function(a){a.set_float(this.sizerandom)};
r.prototype.InitGrowRandom=function(a){a.set_float(this.growrandom)};r.prototype.ParticleAcceleration=function(a){a.set_float(this.acc)};r.prototype.Gravity=function(a){a.set_float(this.g)};r.prototype.ParticleAngleRandom=function(a){a.set_float(this.lifeanglerandom)};r.prototype.ParticleSpeedRandom=function(a){a.set_float(this.lifespeedrandom)};r.prototype.ParticleOpacityRandom=function(a){a.set_float(this.lifeopacityrandom)};r.prototype.Timeout=function(a){a.set_float(this.timeout)};z.exps=new r})();
var localForageInitFailed=!1;
try{!function(b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define([],b):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).localforage=b()}(function(){return function z(e,h,r){function N(c,l){if(!h[c]){if(!e[c]){var q="function"==typeof require&&require;if(!l&&q)return q(c,!0);if(k)return k(c,!0);l=Error("Cannot find module '"+c+"'");throw l.code="MODULE_NOT_FOUND",l;}l=h[c]={exports:{}};
e[c][0].call(l.exports,function(p){var w=e[c][1][p];return N(w?w:p)},l,l.exports,z,e,h,r)}return h[c].exports}for(var k="function"==typeof require&&require,a=0;a<r.length;a++)N(r[a]);return N}({1:[function(e,h,r){function z(t,C){t=t||[];C=C||{};try{return new Blob(t,C)}catch(W){if("TypeError"!==W.name)throw W;for(var F=new ("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),O=0;O<t.length;O+=
1)F.append(t[O]);return F.getBlob(C.type)}}function N(t,C){C&&t.then(function(F){C(null,F)},function(F){C(F)})}function k(t,C,F){"function"==typeof C&&t.then(C);"function"==typeof F&&t["catch"](F)}function a(t){return(new m(function(C){var F=t.transaction(G,"readwrite"),O=z([""]);F.objectStore(G).put(O,"key");F.onabort=function(W){W.preventDefault();W.stopPropagation();C(!1)};F.oncomplete=function(){var W=navigator.userAgent.match(/Chrome\/(\d+)/),T=navigator.userAgent.match(/Edge\//);C(T||!W||43<=
parseInt(W[1],10))}}))["catch"](function(){return!1})}function c(t){return"boolean"==typeof M?m.resolve(M):a(t).then(function(C){return M=C})}function l(t){t=d[t.name];var C={};C.promise=new m(function(F){C.resolve=F});t.deferredOperations.push(C);t.dbReady?t.dbReady=t.dbReady.then(function(){return C.promise}):t.dbReady=C.promise}function q(t,C){return new m(function(F,O){if(t.db){if(!C)return F(t.db);l(t);t.db.close()}var W=[t.name];C&&W.push(t.version);var T=Z.open.apply(Z,W);C&&(T.onupgradeneeded=
function(U){var Y=T.result;try{Y.createObjectStore(t.storeName),1>=U.oldVersion&&Y.createObjectStore(G)}catch(da){if("ConstraintError"!==da.name)throw da;console.warn('The database "'+t.name+'" has been upgraded from version '+U.oldVersion+" to version "+U.newVersion+', but the storage "'+t.storeName+'" already exists.')}});T.onerror=function(U){U.preventDefault();O(T.error)};T.onsuccess=function(){F(T.result);var U=d[t.name].deferredOperations.pop();U&&U.resolve()}})}function p(t){return new m(function(C,
F){var O=new FileReader;O.onerror=F;O.onloadend=function(W){W=btoa(W.target.result||"");C({__local_forage_encoded_blob:!0,data:W,type:t.type})};O.readAsBinaryString(t)})}function w(t){for(var C=atob(t.data),F=C.length,O=new ArrayBuffer(F),W=new Uint8Array(O),T=0;F>T;T++)W[T]=C.charCodeAt(T);return z([O],{type:t.type})}function K(t){var C=this,F=C._initReady().then(function(){var O=d[C._dbInfo.name];return O&&O.dbReady?O.dbReady:void 0});return k(F,t,t),F}function A(t){var C=.75*t.length;var F=t.length,
O=0;"="===t[t.length-1]&&(C--,"="===t[t.length-2]&&C--);var W=new ArrayBuffer(C),T=new Uint8Array(W);for(C=0;F>C;C+=4){var U=L.indexOf(t[C]);var Y=L.indexOf(t[C+1]);var da=L.indexOf(t[C+2]);var ia=L.indexOf(t[C+3]);T[O++]=U<<2|Y>>4;T[O++]=(15&Y)<<4|da>>2;T[O++]=(3&da)<<6|63&ia}return W}function J(t){var C=new Uint8Array(t),F="";for(t=0;t<C.length;t+=3)F+=L[C[t]>>2],F+=L[(3&C[t])<<4|C[t+1]>>4],F+=L[(15&C[t+1])<<2|C[t+2]>>6],F+=L[63&C[t+2]];return 2===C.length%3?F=F.substring(0,F.length-1)+"=":1===
C.length%3&&(F=F.substring(0,F.length-2)+"=="),F}function R(t,C,F,O){var W=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var T=new m(function(U,Y){W.ready().then(function(){void 0===C&&(C=null);var da=C,ia=W._dbInfo;ia.serializer.serialize(C,function(la,na){na?Y(na):ia.db.transaction(function(sa){sa.executeSql("INSERT OR REPLACE INTO "+ia.storeName+" (key, value) VALUES (?, ?)",[t,la],function(){U(da)},function(wa,Ba){Y(Ba)})},function(sa){if(sa.code===
sa.QUOTA_ERR){if(0<O)return void U(R.apply(W,[t,da,F,O-1]));Y(sa)}})})})["catch"](Y)});return N(T,F),T}function n(t,C){t[C]=function(){var F=arguments;return t.ready().then(function(){return t[C].apply(t,F)})}}function x(){for(var t=1;t<arguments.length;t++){var C=arguments[t];if(C)for(var F in C)C.hasOwnProperty(F)&&(B(C[F])?arguments[0][F]=C[F].slice():arguments[0][F]=C[F])}return arguments[0]}function E(t){for(var C in ha)if(ha.hasOwnProperty(C)&&ha[C]===t)return!0;return!1}var V="function"==typeof Symbol&&
"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},Z=function(){if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}();"undefined"==typeof Promise&&e("lie/polyfill");var M,d,m=Promise,
G="local-forage-detect-blob-support",f=Object.prototype.toString,y={_driver:"asyncStorage",_initStorage:function(t){function C(){return m.resolve()}var F=this,O={db:null};if(t)for(var W in t)O[W]=t[W];d||(d={});var T=d[O.name];T||(T={forages:[],db:null,dbReady:null,deferredOperations:[]},d[O.name]=T);T.forages.push(F);F._initReady||(F._initReady=F.ready,F.ready=K);t=[];for(W=0;W<T.forages.length;W++){var U=T.forages[W];U!==F&&t.push(U._initReady()["catch"](C))}var Y=T.forages.slice(0);return m.all(t).then(function(){return O.db=
T.db,q(O,!1)}).then(function(da){O.db=da;var ia=F._defaultConfig.version;if(O.db){var la=!O.db.objectStoreNames.contains(O.storeName),na=O.version>O.db.version;(O.version<O.db.version&&(O.version!==ia&&console.warn('The database "'+O.name+"\" can't be downgraded from version "+O.db.version+" to version "+O.version+"."),O.version=O.db.version),na||la)?(la&&(ia=O.db.version+1,ia>O.version&&(O.version=ia)),ia=!0):ia=!1}else ia=!0;return ia?q(O,!0):da}).then(function(da){O.db=T.db=da;F._dbInfo=O;for(da=
0;da<Y.length;da++){var ia=Y[da];ia!==F&&(ia._dbInfo.db=O.db,ia._dbInfo.version=O.version)}})},iterate:function(t,C){var F=this,O=new m(function(W,T){F.ready().then(function(){var U=F._dbInfo,Y=U.db.transaction(U.storeName,"readonly").objectStore(U.storeName).openCursor(),da=1;Y.onsuccess=function(){var ia=Y.result;if(ia){var la=ia.value;la&&la.__local_forage_encoded_blob&&(la=w(la));la=t(la,ia.key,da++);void 0!==la?W(la):ia["continue"]()}else W()};Y.onerror=function(){T(Y.error)}})["catch"](T)});
return N(O,C),O},getItem:function(t,C){var F=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var O=new m(function(W,T){F.ready().then(function(){var U=F._dbInfo,Y=U.db.transaction(U.storeName,"readonly").objectStore(U.storeName).get(t);Y.onsuccess=function(){var da=Y.result;void 0===da&&(da=null);da&&da.__local_forage_encoded_blob&&(da=w(da));W(da)};Y.onerror=function(){T(Y.error)}})["catch"](T)});return N(O,C),O},setItem:function(t,C,F){var O=this;
"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var W=new m(function(T,U){var Y;O.ready().then(function(){return Y=O._dbInfo,"[object Blob]"===f.call(C)?c(Y.db).then(function(da){return da?C:p(C)}):C}).then(function(da){var ia=Y.db.transaction(Y.storeName,"readwrite"),la=ia.objectStore(Y.storeName).put(da,t);null===da&&(da=void 0);ia.oncomplete=function(){void 0===da&&(da=null);T(da)};ia.onabort=ia.onerror=function(){U(la.error?la.error:la.transaction.error)}})["catch"](U)});
return N(W,F),W},removeItem:function(t,C){var F=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var O=new m(function(W,T){F.ready().then(function(){var U=F._dbInfo,Y=U.db.transaction(U.storeName,"readwrite"),da=Y.objectStore(U.storeName)["delete"](t);Y.oncomplete=function(){W()};Y.onerror=function(){T(da.error)};Y.onabort=function(){T(da.error?da.error:da.transaction.error)}})["catch"](T)});return N(O,C),O},clear:function(t){var C=this,F=new m(function(O,
W){C.ready().then(function(){var T=C._dbInfo,U=T.db.transaction(T.storeName,"readwrite"),Y=U.objectStore(T.storeName).clear();U.oncomplete=function(){O()};U.onabort=U.onerror=function(){W(Y.error?Y.error:Y.transaction.error)}})["catch"](W)});return N(F,t),F},length:function(t){var C=this,F=new m(function(O,W){C.ready().then(function(){var T=C._dbInfo,U=T.db.transaction(T.storeName,"readonly").objectStore(T.storeName).count();U.onsuccess=function(){O(U.result)};U.onerror=function(){W(U.error)}})["catch"](W)});
return N(F,t),F},key:function(t,C){var F=this,O=new m(function(W,T){return 0>t?void W(null):void F.ready().then(function(){var U=F._dbInfo,Y=!1,da=U.db.transaction(U.storeName,"readonly").objectStore(U.storeName).openCursor();da.onsuccess=function(){var ia=da.result;return ia?void(0===t?W(ia.key):Y?W(ia.key):(Y=!0,ia.advance(t))):void W(null)};da.onerror=function(){T(da.error)}})["catch"](T)});return N(O,C),O},keys:function(t){var C=this,F=new m(function(O,W){C.ready().then(function(){var T=C._dbInfo,
U=T.db.transaction(T.storeName,"readonly").objectStore(T.storeName).openCursor(),Y=[];U.onsuccess=function(){var da=U.result;return da?(Y.push(da.key),void da["continue"]()):void O(Y)};U.onerror=function(){W(U.error)}})["catch"](W)});return N(F,t),F}},L="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",P=/^~~local_forage_type~([^~]+)~/,X=Object.prototype.toString,ba={serialize:function(t,C){var F="";if(t&&(F=X.call(t)),t&&("[object ArrayBuffer]"===F||t.buffer&&"[object ArrayBuffer]"===
X.call(t.buffer))){var O,W="__lfsc__:";t instanceof ArrayBuffer?(O=t,W+="arbf"):(O=t.buffer,"[object Int8Array]"===F?W+="si08":"[object Uint8Array]"===F?W+="ui08":"[object Uint8ClampedArray]"===F?W+="uic8":"[object Int16Array]"===F?W+="si16":"[object Uint16Array]"===F?W+="ur16":"[object Int32Array]"===F?W+="si32":"[object Uint32Array]"===F?W+="ui32":"[object Float32Array]"===F?W+="fl32":"[object Float64Array]"===F?W+="fl64":C(Error("Failed to get type for BinaryArray")));C(W+J(O))}else if("[object Blob]"===
F)F=new FileReader,F.onload=function(){var T="~~local_forage_type~"+t.type+"~"+J(this.result);C("__lfsc__:blob"+T)},F.readAsArrayBuffer(t);else try{C(JSON.stringify(t))}catch(T){console.error("Couldn't convert value into a JSON string: ",t),C(null,T)}},deserialize:function(t){if("__lfsc__:"!==t.substring(0,9))return JSON.parse(t);var C=t.substring(13);t=t.substring(9,13);if("blob"===t&&P.test(C)){var F=C.match(P);var O=F[1];C=C.substring(F[0].length)}C=A(C);switch(t){case "arbf":return C;case "blob":return z([C],
{type:O});case "si08":return new Int8Array(C);case "ui08":return new Uint8Array(C);case "uic8":return new Uint8ClampedArray(C);case "si16":return new Int16Array(C);case "ur16":return new Uint16Array(C);case "si32":return new Int32Array(C);case "ui32":return new Uint32Array(C);case "fl32":return new Float32Array(C);case "fl64":return new Float64Array(C);default:throw Error("Unkown type: "+t);}},stringToBuffer:A,bufferToString:J},aa={_driver:"webSQLStorage",_initStorage:function(t){var C=this,F={db:null};
if(t)for(var O in t)F[O]="string"!=typeof t[O]?t[O].toString():t[O];t=new m(function(W,T){try{F.db=openDatabase(F.name,String(F.version),F.description,F.size)}catch(U){return T(U)}F.db.transaction(function(U){U.executeSql("CREATE TABLE IF NOT EXISTS "+F.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){C._dbInfo=F;W()},function(Y,da){T(da)})})});return F.serializer=ba,t},iterate:function(t,C){var F=this,O=new m(function(W,T){F.ready().then(function(){var U=F._dbInfo;U.db.transaction(function(Y){Y.executeSql("SELECT * FROM "+
U.storeName,[],function(da,ia){da=ia.rows;ia=da.length;for(var la=0;ia>la;la++){var na=da.item(la),sa=na.value;if(sa&&(sa=U.serializer.deserialize(sa)),sa=t(sa,na.key,la+1),void 0!==sa)return void W(sa)}W()},function(da,ia){T(ia)})})})["catch"](T)});return N(O,C),O},getItem:function(t,C){var F=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var O=new m(function(W,T){F.ready().then(function(){var U=F._dbInfo;U.db.transaction(function(Y){Y.executeSql("SELECT * FROM "+
U.storeName+" WHERE key = ? LIMIT 1",[t],function(da,ia){(da=ia.rows.length?ia.rows.item(0).value:null)&&(da=U.serializer.deserialize(da));W(da)},function(da,ia){T(ia)})})})["catch"](T)});return N(O,C),O},setItem:function(t,C,F){return R.apply(this,[t,C,F,1])},removeItem:function(t,C){var F=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var O=new m(function(W,T){F.ready().then(function(){var U=F._dbInfo;U.db.transaction(function(Y){Y.executeSql("DELETE FROM "+
U.storeName+" WHERE key = ?",[t],function(){W()},function(da,ia){T(ia)})})})["catch"](T)});return N(O,C),O},clear:function(t){var C=this,F=new m(function(O,W){C.ready().then(function(){var T=C._dbInfo;T.db.transaction(function(U){U.executeSql("DELETE FROM "+T.storeName,[],function(){O()},function(Y,da){W(da)})})})["catch"](W)});return N(F,t),F},length:function(t){var C=this,F=new m(function(O,W){C.ready().then(function(){var T=C._dbInfo;T.db.transaction(function(U){U.executeSql("SELECT COUNT(key) as c FROM "+
T.storeName,[],function(Y,da){Y=da.rows.item(0).c;O(Y)},function(Y,da){W(da)})})})["catch"](W)});return N(F,t),F},key:function(t,C){var F=this,O=new m(function(W,T){F.ready().then(function(){var U=F._dbInfo;U.db.transaction(function(Y){Y.executeSql("SELECT key FROM "+U.storeName+" WHERE id = ? LIMIT 1",[t+1],function(da,ia){da=ia.rows.length?ia.rows.item(0).key:null;W(da)},function(da,ia){T(ia)})})})["catch"](T)});return N(O,C),O},keys:function(t){var C=this,F=new m(function(O,W){C.ready().then(function(){var T=
C._dbInfo;T.db.transaction(function(U){U.executeSql("SELECT key FROM "+T.storeName,[],function(Y,da){Y=[];for(var ia=0;ia<da.rows.length;ia++)Y.push(da.rows.item(ia).key);O(Y)},function(Y,da){W(da)})})})["catch"](W)});return N(F,t),F}},ca={_driver:"localStorageWrapper",_initStorage:function(t){var C={};if(t)for(var F in t)C[F]=t[F];return C.keyPrefix=C.name+"/",C.storeName!==this._defaultConfig.storeName&&(C.keyPrefix+=C.storeName+"/"),this._dbInfo=C,C.serializer=ba,m.resolve()},iterate:function(t,
C){var F=this,O=F.ready().then(function(){for(var W=F._dbInfo,T=W.keyPrefix,U=T.length,Y=localStorage.length,da=1,ia=0;Y>ia;ia++){var la=localStorage.key(ia);if(0===la.indexOf(T)){var na=localStorage.getItem(la);if(na&&(na=W.serializer.deserialize(na)),na=t(na,la.substring(U),da++),void 0!==na)return na}}});return N(O,C),O},getItem:function(t,C){var F=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var O=F.ready().then(function(){var W=F._dbInfo,T=
localStorage.getItem(W.keyPrefix+t);return T&&(T=W.serializer.deserialize(T)),T});return N(O,C),O},setItem:function(t,C,F){var O=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var W=O.ready().then(function(){void 0===C&&(C=null);var T=C;return new m(function(U,Y){var da=O._dbInfo;da.serializer.serialize(C,function(ia,la){if(la)Y(la);else try{localStorage.setItem(da.keyPrefix+t,ia),U(T)}catch(na){"QuotaExceededError"!==na.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==
na.name||Y(na),Y(na)}})})});return N(W,F),W},removeItem:function(t,C){var F=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var O=F.ready().then(function(){localStorage.removeItem(F._dbInfo.keyPrefix+t)});return N(O,C),O},clear:function(t){var C=this,F=C.ready().then(function(){for(var O=C._dbInfo.keyPrefix,W=localStorage.length-1;0<=W;W--){var T=localStorage.key(W);0===T.indexOf(O)&&localStorage.removeItem(T)}});return N(F,t),F},length:function(t){var C=
this.keys().then(function(F){return F.length});return N(C,t),C},key:function(t,C){var F=this,O=F.ready().then(function(){var W=F._dbInfo;try{var T=localStorage.key(t)}catch(U){T=null}return T&&(T=T.substring(W.keyPrefix.length)),T});return N(O,C),O},keys:function(t){var C=this,F=C.ready().then(function(){for(var O=C._dbInfo,W=localStorage.length,T=[],U=0;W>U;U++)0===localStorage.key(U).indexOf(O.keyPrefix)&&T.push(localStorage.key(U).substring(O.keyPrefix.length));return T});return N(F,t),F}},ja=
{},ha={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},g="clear getItem iterate key keys length removeItem setItem".split(" "),u={description:"",driver:[ha.INDEXEDDB,ha.WEBSQL,ha.LOCALSTORAGE].slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},D={};D[ha.INDEXEDDB]=function(){try{if(!Z)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),
C="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||C)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(F){return!1}}();D[ha.WEBSQL]="function"==typeof openDatabase;e=ha.LOCALSTORAGE;try{var I="undefined"!=typeof localStorage&&"setItem"in localStorage&&localStorage.setItem}catch(t){I=!1}D[e]=I;var B=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};I=new (function(){function t(C){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");
this.INDEXEDDB=ha.INDEXEDDB;this.LOCALSTORAGE=ha.LOCALSTORAGE;this.WEBSQL=ha.WEBSQL;this._defaultConfig=x({},u);this._config=x({},this._defaultConfig,C);this._initDriver=this._driverSet=null;this._ready=!1;this._dbInfo=null;this._wrapLibraryMethodsWithReady();this.setDriver(this._config.driver)["catch"](function(){})}return t.prototype.config=function(C){if("object"===("undefined"==typeof C?"undefined":V(C))){if(this._ready)return Error("Can't call config() after localforage has been used.");for(var F in C){if("storeName"===
F&&(C[F]=C[F].replace(/\W/g,"_")),"version"===F&&"number"!=typeof C[F])return Error("Database version must be a number.");this._config[F]=C[F]}return"driver"in C&&C.driver?this.setDriver(this._config.driver):!0}return"string"==typeof C?this._config[C]:this._config},t.prototype.defineDriver=function(C,F,O){var W=new m(function(T,U){try{var Y=C._driver,da=Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),ia=Error("Custom driver name already in use: "+C._driver);
if(!C._driver)return void U(da);if(E(C._driver))return void U(ia);var la=g.concat("_initStorage");for(ia=0;ia<la.length;ia++){var na=la[ia];if(!na||!C[na]||"function"!=typeof C[na])return void U(da)}var sa=m.resolve(!0);"_support"in C&&(sa=C._support&&"function"==typeof C._support?C._support():m.resolve(!!C._support));sa.then(function(wa){D[Y]=wa;ja[Y]=C;T()},U)}catch(wa){U(wa)}});return k(W,F,O),W},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(C,F,O){var W=
this,T=m.resolve().then(function(){if(!E(C)){if(ja[C])return ja[C];throw Error("Driver not found.");}switch(C){case W.INDEXEDDB:return y;case W.LOCALSTORAGE:return ca;case W.WEBSQL:return aa}});return k(T,F,O),T},t.prototype.getSerializer=function(C){var F=m.resolve(ba);return k(F,C),F},t.prototype.ready=function(C){var F=this,O=F._driverSet.then(function(){return null===F._ready&&(F._ready=F._initDriver()),F._ready});return k(O,C,C),O},t.prototype.setDriver=function(C,F,O){function W(){Y._config.driver=
Y.driver()}function T(ia){return Y._extend(ia),W(),Y._ready=Y._initStorage(Y._config),Y._ready}function U(ia){return function(){function la(){for(;na<ia.length;){var sa=ia[na];return na++,Y._dbInfo=null,Y._ready=null,Y.getDriver(sa).then(T)["catch"](la)}W();return Y._driverSet=m.reject(Error("No available storage method found.")),Y._driverSet}var na=0;return la()}}var Y=this;B(C)||(C=[C]);var da=this._getSupportedDrivers(C);return this._driverSet=(null!==this._driverSet?this._driverSet["catch"](function(){return m.resolve()}):
m.resolve()).then(function(){var ia=da[0];return Y._dbInfo=null,Y._ready=null,Y.getDriver(ia).then(function(la){Y._driver=la._driver;W();Y._wrapLibraryMethodsWithReady();Y._initDriver=U(da)})})["catch"](function(){W();return Y._driverSet=m.reject(Error("No available storage method found.")),Y._driverSet}),k(this._driverSet,F,O),this._driverSet},t.prototype.supports=function(C){return!!D[C]},t.prototype._extend=function(C){x(this,C)},t.prototype._getSupportedDrivers=function(C){for(var F=[],O=0,W=
C.length;W>O;O++){var T=C[O];this.supports(T)&&F.push(T)}return F},t.prototype._wrapLibraryMethodsWithReady=function(){for(var C=0;C<g.length;C++)n(this,g[C])},t.prototype.createInstance=function(C){return new t(C)},t}());h.exports=I},{undefined:void 0}]},{},[1])(1)})}catch(b){localForageInitFailed=!0}cr.plugins_.LocalStorage=function(b){this.runtime=b};
(function(){function b(A){return A?"string"===typeof A?A:"string"===typeof A.message?A.message:"string"===typeof A.name?A.name:"string"===typeof A.data?A.data:"unknown error":"unknown error"}function e(A,J){l=J;A.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError,A)}function h(A){if(!q)return A;if(q?A.substr(0,q.length)===q:1)return A.substr(q.length)}function r(){}function z(){}function N(){}var k="",a="",c=[],l="",q="",p="undefined"!==typeof window.is_scirra_arcade;p&&(q="sa"+window.scirra_arcade_id+
"_");var w=cr.plugins_.LocalStorage.prototype;w.Type=function(A){this.plugin=A;this.runtime=A.runtime};w.Type.prototype.onCreate=function(){};w.Instance=function(A){this.type=A;this.runtime=A.runtime};var K=w.Instance.prototype;K.onCreate=function(){this.pendingGets=this.pendingSets=0};K.onDestroy=function(){};K.saveToJSON=function(){return{}};K.loadFromJSON=function(A){};r.prototype.OnItemSet=function(A){return k===A};r.prototype.OnAnyItemSet=function(){return!0};r.prototype.OnItemGet=function(A){return k===
A};r.prototype.OnAnyItemGet=function(){return!0};r.prototype.OnItemRemoved=function(A){return k===A};r.prototype.OnAnyItemRemoved=function(){return!0};r.prototype.OnCleared=function(){return!0};r.prototype.OnAllKeyNamesLoaded=function(){return!0};r.prototype.OnError=function(){return!0};r.prototype.OnItemExists=function(A){return k===A};r.prototype.OnItemMissing=function(A){return k===A};r.prototype.CompareKey=function(A,J){return cr.do_cmp(k,A,J)};r.prototype.CompareValue=function(A,J){return cr.do_cmp(a,
A,J)};r.prototype.IsProcessingSets=function(){return 0<this.pendingSets};r.prototype.IsProcessingGets=function(){return 0<this.pendingGets};r.prototype.OnAllSetsComplete=function(){return!0};r.prototype.OnAllGetsComplete=function(){return!0};w.cnds=new r;z.prototype.SetItem=function(A,J){if(localForageInitFailed)e(this,"storage failed to initialise - may be disabled in browser settings");else{var R=q+A;this.pendingSets++;var n=this;localforage.setItem(R,J,function(x,E){n.pendingSets--;x?(l=b(x),n.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError,
n)):(k=A,a=E,n.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnAnyItemSet,n),n.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnItemSet,n),a=k="");0===n.pendingSets&&n.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnAllSetsComplete,n)})}};z.prototype.GetItem=function(A){if(localForageInitFailed)e(this,"storage failed to initialise - may be disabled in browser settings");else{var J=q+A;this.pendingGets++;var R=this;localforage.getItem(J,function(n,x){R.pendingGets--;if(n)l=
b(n),R.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError,R);else{k=A;a=x;if("undefined"===typeof a||null===a)a="";R.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnAnyItemGet,R);R.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnItemGet,R);a=k=""}0===R.pendingGets&&R.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnAllGetsComplete,R)})}};z.prototype.CheckItemExists=function(A){if(localForageInitFailed)e(this,"storage failed to initialise - may be disabled in browser settings");
else{var J=this;localforage.getItem(q+A,function(R,n){R?(l=b(R),J.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError,J)):(k=A,null===n?(a="",J.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnItemMissing,J)):(a=n,J.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnItemExists,J)),a=k="")})}};z.prototype.RemoveItem=function(A){if(localForageInitFailed)e(this,"storage failed to initialise - may be disabled in browser settings");else{var J=this;localforage.removeItem(q+A,
function(R){R?(l=b(R),J.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError,J)):(k=A,a="",J.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnAnyItemRemoved,J),J.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnItemRemoved,J),k="")})}};z.prototype.ClearStorage=function(){if(localForageInitFailed)e(this,"storage failed to initialise - may be disabled in browser settings");else if(!p){var A=this;localforage.clear(function(J){J?(l=b(J),A.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError,
A)):(a=k="",cr.clearArray(c),A.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnCleared,A))})}};z.prototype.GetAllKeyNames=function(){if(localForageInitFailed)e(this,"storage failed to initialise - may be disabled in browser settings");else{var A=this;localforage.keys(function(J,R){var n;if(J)l=b(J),A.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnError,A);else{cr.clearArray(c);J=0;for(n=R.length;J<n;++J){var x=R[J];(q?x.substr(0,q.length)===q:1)&&c.push(h(x))}A.runtime.trigger(cr.plugins_.LocalStorage.prototype.cnds.OnAllKeyNamesLoaded,
A)}})}};w.acts=new z;N.prototype.ItemValue=function(A){A.set_any(a)};N.prototype.Key=function(A){A.set_string(k)};N.prototype.KeyCount=function(A){A.set_int(c.length)};N.prototype.KeyAt=function(A,J){J=Math.floor(J);0>J||J>=c.length?A.set_string(""):A.set_string(c[J])};N.prototype.ErrorMessage=function(A){A.set_string(l)};w.exps=new N})();cr.plugins_.Text=function(b){this.runtime=b};
(function(){function b(){return q.length?q.pop():{}}function e(p){var w;var K=0;for(w=p.length;K<w;K++)q.push(p[K]);cr.clearArray(p)}function h(p){return p.length&&" "===p.charAt(p.length-1)?p.substring(0,p.length-1):p}function r(){}function z(){}function N(){}var k=cr.plugins_.Text.prototype;k.onCreate=function(){k.acts.SetWidth=function(p){this.width!==p&&(this.width=p,this.text_changed=!0,this.set_bbox_changed())}};k.Type=function(p){this.plugin=p;this.runtime=p.runtime};var a=k.Type.prototype;
a.onCreate=function(){};a.onLostWebGLContext=function(){if(!this.is_family){var p;var w=0;for(p=this.instances.length;w<p;w++){var K=this.instances[w];K.mycanvas=null;K.myctx=null;K.mytex=null}}};k.Instance=function(p){this.type=p;this.runtime=p.runtime;this.recycled?cr.clearArray(this.lines):this.lines=[];this.text_changed=!0};a=k.Instance.prototype;var c={};a.onCreate=function(){this.text=this.properties[0];this.facename=this.properties[2];this.ptSize=this.properties[3];this.line_height_offset=
this.properties[4];this.isBold=this.properties[5];this.isItalic=this.properties[6];var p=this.properties[7];this.color="rgb("+Math.floor(255*p[0])+","+Math.floor(255*p[1])+","+Math.floor(255*p[2])+")";this.halign=this.properties[8];this.valign=this.properties[9];this.wrapbyword=0===this.properties[10];this.visible=this.properties[11];this.lastwrapwidth=this.lastwidth=this.width;this.lastheight=this.height;this.fontstyle=this.font="";this.textHeight=this.textWidth=this.pxHeight=0;this.updateFont();
this.mytex=this.myctx=this.mycanvas=null;this.need_text_redraw=!1;this.last_render_tick=this.runtime.tickcount;this.recycled?this.rcTex.set(0,0,1,1):this.rcTex=new cr.rect(0,0,1,1);this.runtime.glwrap&&this.runtime.tickMe(this)};a.saveToJSON=function(){return{t:this.text,f:this.font,c:this.color,ha:this.halign,va:this.valign,wr:this.wrapbyword,lho:this.line_height_offset,fn:this.facename,fs:this.fontstyle,ps:this.ptSize,pxh:this.pxHeight,tw:this.textWidth,th:this.textHeight,lrt:this.last_render_tick}};
a.loadFromJSON=function(p){this.text=p.t;this.font=p.f;this.color=p.c;this.halign=p.ha;this.valign=p.va;this.wrapbyword=p.wr;this.line_height_offset=p.lho;this.facename=p.fn;this.fontstyle=p.fs;this.ptSize=p.ps;this.pxHeight=p.pxh;this.textWidth=p.tw;this.textHeight=p.th;this.last_render_tick=p.lrt;this.isBold=0!==this.fontstyle.indexOf("bold");this.isItalic=0!==this.fontstyle.indexOf("italic");this.text_changed=!0;this.lastwrapwidth=this.lastwidth=this.width;this.lastheight=this.height};a.tick=function(){if(this.runtime.glwrap&&
this.mytex&&300<=this.runtime.tickcount-this.last_render_tick){var p=this.layer;this.update_bbox();var w=this.bbox;if(w.right<p.viewLeft||w.bottom<p.viewTop||w.left>p.viewRight||w.top>p.viewBottom)this.runtime.glwrap.deleteTexture(this.mytex),this.mycanvas=this.myctx=this.mytex=null}};a.onDestroy=function(){this.mycanvas=this.myctx=null;this.runtime.glwrap&&this.mytex&&this.runtime.glwrap.deleteTexture(this.mytex);this.mytex=null};a.updateFont=function(){this.pxHeight=Math.ceil(this.ptSize/72*96)+
4;var p=[];this.isBold&&p.push("bold");this.isItalic&&p.push("italic");this.fontstyle=p.join(" ");this.font=this.fontstyle+" "+this.ptSize.toString()+"pt '"+this.facename+"'";this.text_changed=!0;this.runtime.redraw=!0};a.draw=function(p,w){p.font=this.font;p.textBaseline="top";p.fillStyle=this.color;p.globalAlpha=w?1:this.opacity;if(w){var K=this.layer.getScale();p.save();p.scale(K,K)}if(this.text_changed||this.width!==this.lastwrapwidth)this.type.plugin.WordWrap(this.text,this.lines,p,this.width,
this.wrapbyword),this.text_changed=!1,this.lastwrapwidth=this.width;this.update_bbox();K=w?0:this.bquad.tlx;var A=w?0:this.bquad.tly;this.runtime.pixel_rounding&&(K=K+.5|0,A=A+.5|0);0===this.angle||w||(p.save(),p.translate(K,A),p.rotate(this.angle),A=K=0);var J=A+this.height,R=this.pxHeight;R+=this.line_height_offset;var n;1===this.valign?A+=Math.max(this.height/2-this.lines.length*R/2,0):2===this.valign&&(A+=Math.max(this.height-this.lines.length*R-2,0));for(n=0;n<this.lines.length;n++){var x=K;
1===this.halign?x=K+(this.width-this.lines[n].width)/2:2===this.halign&&(x=K+(this.width-this.lines[n].width));p.fillText(this.lines[n].text,x,A);A+=R;if(A>=J-R)break}(0!==this.angle||w)&&p.restore();this.last_render_tick=this.runtime.tickcount};a.drawGL=function(p){if(!(1>this.width||1>this.height)){var w=this.text_changed||this.need_text_redraw;this.need_text_redraw=!1;var K=this.layer.getScale(),A=this.layer.getAngle(),J=this.rcTex,R=K*this.width,n=K*this.height,x=Math.ceil(R),E=Math.ceil(n),V=
this.runtime.draw_width/2,Z=this.runtime.draw_height/2;this.myctx||(this.mycanvas=document.createElement("canvas"),this.mycanvas.width=x,this.mycanvas.height=E,this.lastwidth=x,this.lastheight=E,w=!0,this.myctx=this.mycanvas.getContext("2d"));if(x!==this.lastwidth||E!==this.lastheight)this.mycanvas.width=x,this.mycanvas.height=E,this.mytex&&(p.deleteTexture(this.mytex),this.mytex=null),w=!0;w&&(this.myctx.clearRect(0,0,x,E),this.draw(this.myctx,!0),this.mytex||(this.mytex=p.createEmptyTexture(x,E,
this.runtime.linearSampling,this.runtime.isMobile)),p.videoToTexture(this.mycanvas,this.mytex,this.runtime.isMobile));this.lastwidth=x;this.lastheight=E;p.setTexture(this.mytex);p.setOpacity(this.opacity);p.resetModelView();p.translate(-V,-Z);p.updateModelView();var M=this.bquad;w=this.layer.layerToCanvas(M.tlx,M.tly,!0,!0);V=this.layer.layerToCanvas(M.tlx,M.tly,!1,!0);Z=this.layer.layerToCanvas(M.trx,M.try_,!0,!0);var d=this.layer.layerToCanvas(M.trx,M.try_,!1,!0),m=this.layer.layerToCanvas(M.brx,
M.bry,!0,!0),G=this.layer.layerToCanvas(M.brx,M.bry,!1,!0),f=this.layer.layerToCanvas(M.blx,M.bly,!0,!0);M=this.layer.layerToCanvas(M.blx,M.bly,!1,!0);if(this.runtime.pixel_rounding||0===this.angle&&0===A){var y=(w+.5|0)-w,L=(V+.5|0)-V;w+=y;V+=L;Z+=y;d+=L;m+=y;G+=L;f+=y;M+=L}0===this.angle&&0===A?(Z=w+x,d=V,m=Z,G=V+E,f=w,M=G,J.right=1,J.bottom=1):(J.right=R/x,J.bottom=n/E);p.quadTex(w,V,Z,d,m,G,f,M,J);p.resetModelView();p.scale(K,K);p.rotateZ(-this.layer.getAngle());p.translate((this.layer.viewLeft+
this.layer.viewRight)/-2,(this.layer.viewTop+this.layer.viewBottom)/-2);p.updateModelView();this.last_render_tick=this.runtime.tickcount}};var l=[];k.TokeniseWords=function(p){cr.clearArray(l);for(var w="",K,A=0;A<p.length;)if(K=p.charAt(A),"\n"===K)w.length&&(l.push(w),w=""),l.push("\n"),++A;else if(" "===K||"\t"===K||"-"===K){do w+=p.charAt(A),A++;while(A<p.length&&(" "===p.charAt(A)||"\t"===p.charAt(A)));l.push(w);w=""}else A<p.length&&(w+=K,A++);w.length&&l.push(w)};var q=[];k.WordWrap=function(p,
w,K,A,J){if(p&&p.length)if(2>=A)e(w);else{if(100>=p.length&&-1===p.indexOf("\n")){var R=K.measureText(p).width;if(R<=A){e(w);w.push(b());w[0].text=p;w[0].width=R;return}}this.WrapText(p,w,K,A,J)}else e(w)};k.WrapText=function(p,w,K,A,J){J&&(this.TokeniseWords(p),p=l);var R="",n,x=0;for(n=0;n<p.length;n++)if("\n"===p[n]){x>=w.length&&w.push(b());R=h(R);var E=w[x];E.text=R;E.width=K.measureText(R).width;x++;R=""}else{var V=R;R+=p[n];E=K.measureText(h(R)).width;E>=A&&(x>=w.length&&w.push(b()),V=h(V),
E=w[x],E.text=V,E.width=K.measureText(V).width,x++,R=p[n],J||" "!==R||(R=""))}R.length&&(x>=w.length&&w.push(b()),R=h(R),E=w[x],E.text=R,E.width=K.measureText(R).width,x++);for(n=x;n<w.length;n++)q.push(w[n]);w.length=x};r.prototype.CompareText=function(p,w){return w?this.text==p:cr.equals_nocase(this.text,p)};k.cnds=new r;z.prototype.SetText=function(p){cr.is_number(p)&&1E9>p&&(p=Math.round(1E10*p)/1E10);p=p.toString();this.text!==p&&(this.text=p,this.text_changed=!0,this.runtime.redraw=!0)};z.prototype.AppendText=
function(p){cr.is_number(p)&&(p=Math.round(1E10*p)/1E10);if(p=p.toString())this.text+=p,this.text_changed=!0,this.runtime.redraw=!0};z.prototype.SetFontFace=function(p,w){var K=!1,A=!1;switch(w){case 1:K=!0;break;case 2:A=!0;break;case 3:A=K=!0}if(p!==this.facename||this.isBold!==K||this.isItalic!==A)this.facename=p,this.isBold=K,this.isItalic=A,this.updateFont()};z.prototype.SetFontSize=function(p){this.ptSize!==p&&(this.ptSize=p,this.updateFont())};z.prototype.SetFontColor=function(p){var w=cr.clamp(Math.floor(255*
cr.GetRValue(p)),0,255),K=cr.clamp(Math.floor(255*cr.GetGValue(p)),0,255);p=cr.clamp(Math.floor(255*cr.GetBValue(p)),0,255);w="rgb("+w+","+K+","+p+")";w!==this.color&&(this.color=w,this.need_text_redraw=!0,this.runtime.redraw=!0)};z.prototype.SetWebFont=function(p,w){var K=this,A=function(){K.runtime.redraw=!0;K.text_changed=!0};if(c.hasOwnProperty(w)){if(p="'"+p+"'",this.facename!==p)for(this.facename=p,this.updateFont(),p=1;10>p;p++)setTimeout(A,100*p),setTimeout(A,1E3*p)}else{var J=document.createElement("link");
J.href=w;J.rel="stylesheet";J.type="text/css";J.onload=A;document.getElementsByTagName("head")[0].appendChild(J);c[w]=!0;this.facename="'"+p+"'";this.updateFont();for(p=1;10>p;p++)setTimeout(A,100*p),setTimeout(A,1E3*p)}};z.prototype.SetEffect=function(p){this.blend_mode=p;this.compositeOp=cr.effectToCompositeOp(p);cr.setGLBlend(this,p,this.runtime.gl);this.runtime.redraw=!0};k.acts=new z;N.prototype.Text=function(p){p.set_string(this.text)};N.prototype.FaceName=function(p){p.set_string(this.facename)};
N.prototype.FaceSize=function(p){p.set_int(this.ptSize)};N.prototype.TextWidth=function(p){var w=0,K;var A=0;for(K=this.lines.length;A<K;A++){var J=this.lines[A].width;w<J&&(w=J)}p.set_int(w)};N.prototype.TextHeight=function(p){p.set_int(this.lines.length*(this.pxHeight+this.line_height_offset)-this.line_height_offset)};k.exps=new N})();cr.plugins_.TextBox=function(b){this.runtime=b};
(function(){function b(){}function e(){}function h(){}var r=cr.plugins_.TextBox.prototype;r.Type=function(k){this.plugin=k;this.runtime=k.runtime};r.Type.prototype.onCreate=function(){};r.Instance=function(k){this.type=k;this.runtime=k.runtime};var z=r.Instance.prototype,N="text password email number tel url textarea search".split(" ");-1<navigator.userAgent.indexOf("MSIE 9")&&(N[2]="text",N[3]="text",N[4]="text",N[5]="text",N[7]="text");z.onCreate=function(){6===this.properties[7]?(this.elem=document.createElement("textarea"),
this.elem.style.resize="none"):(this.elem=document.createElement("input"),this.elem.type=N[this.properties[7]]);this.elem.id=this.properties[9];document.body.appendChild(this.elem);this.elem.autocomplete="off";this.elem.value=this.properties[0];this.elem.placeholder=this.properties[1];this.elem.title=this.properties[2];this.elem.disabled=!this.properties[4];this.elem.readOnly=this.properties[5];this.elem.spellcheck=this.properties[6];this.autoFontSize=this.properties[8];this.element_hidden=!1;this.properties[3]||
(this.elem.style.display="none",this.visible=!1,this.element_hidden=!0);var k=function(a){return function(){a.runtime.trigger(cr.plugins_.TextBox.prototype.cnds.OnTextChanged,a)}}(this);this.elem.oninput=k;-1!==navigator.userAgent.indexOf("MSIE")&&(this.elem.oncut=k);this.elem.onclick=function(a){return function(c){c.stopPropagation();a.runtime.isInUserInputEvent=!0;a.runtime.trigger(cr.plugins_.TextBox.prototype.cnds.OnClicked,a);a.runtime.isInUserInputEvent=!1}}(this);this.elem.ondblclick=function(a){return function(c){c.stopPropagation();
a.runtime.isInUserInputEvent=!0;a.runtime.trigger(cr.plugins_.TextBox.prototype.cnds.OnDoubleClicked,a);a.runtime.isInUserInputEvent=!1}}(this);this.elem.addEventListener("touchstart",function(a){a.stopPropagation()},!1);this.elem.addEventListener("touchmove",function(a){a.stopPropagation()},!1);this.elem.addEventListener("touchend",function(a){a.stopPropagation()},!1);this.elem.addEventListener("mousedown",function(a){a.stopPropagation()});this.elem.addEventListener("mouseup",function(a){a.stopPropagation()});
this.elem.addEventListener("keydown",function(a){13!==a.which&&27!=a.which&&a.stopPropagation()});this.elem.addEventListener("keyup",function(a){13!==a.which&&27!=a.which&&a.stopPropagation()});this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0;this.updatePosition(!0);this.runtime.tickMe(this)};z.saveToJSON=function(){return{text:this.elem.value,placeholder:this.elem.placeholder,tooltip:this.elem.title,disabled:!!this.elem.disabled,readonly:!!this.elem.readOnly,
spellcheck:!!this.elem.spellcheck}};z.loadFromJSON=function(k){this.elem.value=k.text;this.elem.placeholder=k.placeholder;this.elem.title=k.tooltip;this.elem.disabled=k.disabled;this.elem.readOnly=k.readonly;this.elem.spellcheck=k.spellcheck};z.onDestroy=function(){this.elem.parentElement.removeChild(this.elem);this.elem=null};z.tick=function(){this.updatePosition()};z.updatePosition=function(k){var a=this.layer.layerToCanvas(this.x,this.y,!0),c=this.layer.layerToCanvas(this.x,this.y,!1),l=this.layer.layerToCanvas(this.x+
this.width,this.y+this.height,!0),q=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),p=this.runtime.width/this.runtime.devicePixelRatio,w=this.runtime.height/this.runtime.devicePixelRatio;!this.visible||!this.layer.visible||0>=l||0>=q||a>=p||c>=w?(this.element_hidden||(this.elem.style.display="none"),this.element_hidden=!0):(1>a&&(a=1),1>c&&(c=1),l>=p&&(l=p-1),q>=w&&(q=w-1),p=window.innerWidth,w=window.innerHeight,k||this.lastLeft!==a||this.lastTop!==c||this.lastRight!==l||this.lastBottom!==
q||this.lastWinWidth!==p||this.lastWinHeight!==w?(this.lastLeft=a,this.lastTop=c,this.lastRight=l,this.lastBottom=q,this.lastWinWidth=p,this.lastWinHeight=w,this.element_hidden&&(this.elem.style.display="",this.element_hidden=!1),k=Math.round(a)+this.runtime.canvas.offsetLeft,p=Math.round(c)+this.runtime.canvas.offsetTop,this.elem.style.position="absolute",this.elem.style.left=k+"px",this.elem.style.top=p+"px",this.elem.style.width=Math.round(l-a)+"px",this.elem.style.height=Math.round(q-c)+"px",
this.autoFontSize&&(this.elem.style.fontSize=this.layer.getScale(!0)/this.runtime.devicePixelRatio-.2+"em")):this.element_hidden&&(this.elem.style.display="",this.element_hidden=!1))};z.draw=function(k){};z.drawGL=function(k){};b.prototype.CompareText=function(k,a){return 0===a?cr.equals_nocase(this.elem.value,k):this.elem.value===k};b.prototype.OnTextChanged=function(){return!0};b.prototype.OnClicked=function(){return!0};b.prototype.OnDoubleClicked=function(){return!0};r.cnds=new b;e.prototype.SetText=
function(k){this.elem.value=k.toString()};e.prototype.SetPlaceholder=function(k){this.elem.placeholder=k};e.prototype.SetTooltip=function(k){this.elem.title=k};e.prototype.SetReadOnly=function(k){this.elem.readOnly=0===k};e.prototype.ScrollToBottom=function(){this.elem.scrollTop=this.elem.scrollHeight};r.acts=new e;h.prototype.Text=function(k){k.set_string(this.elem.value)};r.exps=new h})();cr.plugins_.AJAX=function(b){this.runtime=b};
(function(){function b(){}function e(){}function h(){}var r=!1,z=null,N=null,k="",a=cr.plugins_.AJAX.prototype;a.Type=function(p){this.plugin=p;this.runtime=p.runtime};a.Type.prototype.onCreate=function(){};a.Instance=function(p){this.type=p;this.runtime=p.runtime;this.curTag=this.lastData="";this.progress=0;this.timeout=-1;if(r=this.runtime.isNWjs)z=require("path"),N=require("fs"),k=z.dirname((window.process||nw.process).execPath)+"\\"};var c=a.Instance.prototype;c.onCreate=function(){};c.saveToJSON=
function(){return{lastData:this.lastData}};c.loadFromJSON=function(p){this.lastData=p.lastData;this.curTag="";this.progress=0};var l={},q="";c.doRequest=function(p,w,K,A){var J=this,R=null,n=function(){J.curTag=p;J.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyError,J);J.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,J)},x=function(){if(r){var Z=k+w;N.existsSync(Z)?N.readFile(Z,{encoding:"utf8"},function(M,d){M?n():(J.curTag=p,J.lastData=d.replace(/\r\n/g,"\n"),J.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyComplete,
J),J.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,J))}):n()}else n()},E=function(Z){Z.lengthComputable&&(J.progress=Z.loaded/Z.total,J.curTag=p,J.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnProgress,J))};try{R=this.runtime.isWindowsPhone8?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;R.onreadystatechange=function(){4===R.readyState&&(J.curTag=p,J.lastData=R.responseText?R.responseText.replace(/\r\n/g,"\n"):"",400<=R.status?(J.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyError,
J),J.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,J)):r&&!J.lastData.length||!r&&0===R.status&&!J.lastData.length||(J.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyComplete,J),J.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,J)))};this.runtime.isWindowsPhone8||(R.onerror=x,R.ontimeout=x,R.onabort=x,R.onprogress=E);R.open(K,w);!this.runtime.isWindowsPhone8&&0<=this.timeout&&"undefined"!==typeof R.timeout&&(R.timeout=this.timeout);R.responseType="text";A&&R.setRequestHeader&&
!l.hasOwnProperty("Content-Type")&&R.setRequestHeader("Content-Type","application/x-www-form-urlencoded");if(R.setRequestHeader){for(var V in l)if(l.hasOwnProperty(V))try{R.setRequestHeader(V,l[V])}catch(Z){}l={}}if(q&&R.overrideMimeType){try{R.overrideMimeType(q)}catch(Z){}q=""}A?R.send(A):R.send()}catch(Z){x()}};b.prototype.OnComplete=function(p){return cr.equals_nocase(p,this.curTag)};b.prototype.OnAnyComplete=function(p){return!0};b.prototype.OnError=function(p){return cr.equals_nocase(p,this.curTag)};
b.prototype.OnAnyError=function(p){return!0};b.prototype.OnProgress=function(p){return cr.equals_nocase(p,this.curTag)};a.cnds=new b;e.prototype.Request=function(p,w){var K=this;this.runtime.isWKWebView&&!this.runtime.isAbsoluteUrl(w)?this.runtime.fetchLocalFileViaCordovaAsText(w,function(A){K.curTag=p;K.lastData=A.replace(/\r\n/g,"\n");K.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyComplete,K);K.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,K)},function(A){K.curTag=p;K.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyError,
K);K.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,K)}):this.runtime.isPreview&&!this.runtime.isAbsoluteUrl(w)?this.doRequest(p,this.runtime.getLocalFileUrl(w),"GET"):this.doRequest(p,w,"GET")};e.prototype.RequestFile=function(p,w){var K=this;this.runtime.isWKWebView?this.runtime.fetchLocalFileViaCordovaAsText(w,function(A){K.curTag=p;K.lastData=A.replace(/\r\n/g,"\n");K.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyComplete,K);K.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,
K)},function(A){K.curTag=p;K.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyError,K);K.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,K)}):this.doRequest(p,this.runtime.getLocalFileUrl(w),"GET")};e.prototype.Post=function(p,w,K,A){this.doRequest(p,w,A,K)};e.prototype.SetTimeout=function(p){this.timeout=1E3*p};e.prototype.SetHeader=function(p,w){l[p]=w};e.prototype.OverrideMIMEType=function(p){q=p};a.acts=new e;h.prototype.LastData=function(p){p.set_string(this.lastData)};h.prototype.Progress=
function(p){p.set_float(this.progress)};h.prototype.Tag=function(p){p.set_string(this.curTag)};a.exps=new h})();cr.plugins_.TiledBg=function(b){this.runtime=b};
(function(){function b(){}function e(){}function h(){}var r=cr.plugins_.TiledBg.prototype;r.Type=function(N){this.plugin=N;this.runtime=N.runtime};var z=r.Type.prototype;z.onCreate=function(){this.is_family||(this.texture_img=this.runtime.findWaitingTexture(this.texture_file),this.texture_img||(this.texture_img=new Image,this.texture_img.cr_src=this.texture_file,this.texture_img.cr_filesize=this.texture_filesize,this.texture_img.c2webGL_texture=null,this.runtime.waitForImageLoad(this.texture_img,
this.texture_file)),this.webGL_texture=this.pattern=null)};z.onLostWebGLContext=function(){this.is_family||(this.webGL_texture=null)};z.onRestoreWebGLContext=function(){if(!this.is_family&&this.instances.length){this.webGL_texture||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat));var N;var k=0;for(N=this.instances.length;k<N;k++)this.instances[k].webGL_texture=this.webGL_texture}};z.loadTextures=function(){this.is_family||
this.webGL_texture||!this.runtime.glwrap||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat))};z.unloadTextures=function(){this.is_family||this.instances.length||!this.webGL_texture||(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)};z.preloadCanvas2D=function(N){N.drawImage(this.texture_img,0,0)};r.Instance=function(N){this.type=N;this.runtime=N.runtime};z=r.Instance.prototype;z.onCreate=function(){this.visible=
this.properties[0];this.rcTex=new cr.rect(0,0,0,0);this.has_own_texture=!1;this.texture_img=this.type.texture_img;this.runtime.glwrap?(this.type.loadTextures(),this.webGL_texture=this.type.webGL_texture):(this.type.pattern||(this.type.pattern=this.runtime.ctx.createPattern(this.type.texture_img,"repeat")),this.pattern=this.type.pattern)};z.afterLoad=function(){this.has_own_texture=!1;this.texture_img=this.type.texture_img};z.onDestroy=function(){this.runtime.glwrap&&this.has_own_texture&&this.webGL_texture&&
(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)};z.draw=function(N){N.globalAlpha=this.opacity;N.save();N.fillStyle=this.pattern;var k=this.x,a=this.y;this.runtime.pixel_rounding&&(k=Math.round(k),a=Math.round(a));var c=-(this.hotspotX*this.width),l=-(this.hotspotY*this.height),q=c%this.texture_img.width,p=l%this.texture_img.height;0>q&&(q+=this.texture_img.width);0>p&&(p+=this.texture_img.height);N.translate(k,a);N.rotate(this.angle);N.translate(q,p);N.fillRect(c-
q,l-p,this.width,this.height);N.restore()};z.drawGL_earlyZPass=function(N){this.drawGL(N)};z.drawGL=function(N){N.setTexture(this.webGL_texture);N.setOpacity(this.opacity);var k=this.rcTex;k.right=this.width/this.texture_img.width;k.bottom=this.height/this.texture_img.height;var a=this.bquad;if(this.runtime.pixel_rounding){var c=Math.round(this.x)-this.x,l=Math.round(this.y)-this.y;N.quadTex(a.tlx+c,a.tly+l,a.trx+c,a.try_+l,a.brx+c,a.bry+l,a.blx+c,a.bly+l,k)}else N.quadTex(a.tlx,a.tly,a.trx,a.try_,
a.brx,a.bry,a.blx,a.bly,k)};b.prototype.OnURLLoaded=function(){return!0};r.cnds=new b;e.prototype.SetEffect=function(N){this.blend_mode=N;this.compositeOp=cr.effectToCompositeOp(N);cr.setGLBlend(this,N,this.runtime.gl);this.runtime.redraw=!0};e.prototype.LoadURL=function(N,k){var a=new Image,c=this;a.onload=function(){c.texture_img=a;c.runtime.glwrap?(c.has_own_texture&&c.webGL_texture&&c.runtime.glwrap.deleteTexture(c.webGL_texture),c.webGL_texture=c.runtime.glwrap.loadTexture(a,!0,c.runtime.linearSampling)):
c.pattern=c.runtime.ctx.createPattern(a,"repeat");c.has_own_texture=!0;c.runtime.redraw=!0;c.runtime.trigger(cr.plugins_.TiledBg.prototype.cnds.OnURLLoaded,c)};"data:"!==N.substr(0,5)&&0===k&&(a.crossOrigin="anonymous");this.runtime.setImageSrc(a,N)};r.acts=new e;h.prototype.ImageWidth=function(N){N.set_float(this.texture_img.width)};h.prototype.ImageHeight=function(N){N.set_float(this.texture_img.height)};r.exps=new h})();cr.behaviors.Rotate=function(b){this.runtime=b};
(function(){function b(){}function e(){}function h(){}var r=cr.behaviors.Rotate.prototype;r.Type=function(N,k){this.behavior=N;this.objtype=k;this.runtime=N.runtime};r.Type.prototype.onCreate=function(){};r.Instance=function(N,k){this.type=N;this.behavior=N.behavior;this.inst=k;this.runtime=N.runtime};var z=r.Instance.prototype;z.onCreate=function(){this.speed=cr.to_radians(this.properties[0]);this.acc=cr.to_radians(this.properties[1]);this.enabled=this.properties[2]};z.saveToJSON=function(){return{speed:this.speed,
acc:this.acc,e:this.enabled}};z.loadFromJSON=function(N){this.speed=N.speed;this.acc=N.acc;N.hasOwnProperty("e")?this.enabled=N.e:this.enabled=!0};z.tick=function(){if(this.enabled){var N=this.runtime.getDt(this.inst);0!==N&&(0!==this.acc&&(this.speed+=this.acc*N),0!==this.speed&&(this.inst.angle=cr.clamp_angle(this.inst.angle+this.speed*N),this.inst.set_bbox_changed()))}};b.prototype.IsEnabled=function(){return this.enabled};r.cnds=new b;e.prototype.SetSpeed=function(N){this.speed=cr.to_radians(N)};
e.prototype.SetAcceleration=function(N){this.acc=cr.to_radians(N)};e.prototype.SetEnabled=function(N){this.enabled=1===N};r.acts=new e;h.prototype.Speed=function(N){N.set_float(cr.to_degrees(this.speed))};h.prototype.Acceleration=function(N){N.set_float(cr.to_degrees(this.acc))};r.exps=new h})();
var easeOutBounceArray=[],easeInElasticArray=[],easeOutElasticArray=[],easeInOutElasticArray=[],easeInCircle=[],easeOutCircle=[],easeInOutCircle=[],easeInBack=[],easeOutBack=[],easeInOutBack=[],litetween_precision=1E4,updateLimit=0;function easeOutBouncefunc(b){return result=(b/=1)<1/2.75?7.5625*b*b:b<2/2.75?7.5625*(b-=1.5/2.75)*b+.75:b<2.5/2.75?7.5625*(b-=2.25/2.75)*b+.9375:7.5625*(b-=2.625/2.75)*b+.984375}function integerize(b,e){return Math.round(b/e*litetween_precision)}
function easeFunc(b,e,h,r,z,N,k){var a=0;switch(b){case 0:a=r*e/z+h;break;case 1:a=r*(e/=z)*e+h;break;case 2:a=-r*(e/=z)*(e-2)+h;break;case 3:a=1>(e/=z/2)?r/2*e*e+h:-r/2*(--e*(e-2)-1)+h;break;case 4:a=r*(e/=z)*e*e+h;break;case 5:a=r*((e=e/z-1)*e*e+1)+h;break;case 6:a=1>(e/=z/2)?r/2*e*e*e+h:r/2*((e-=2)*e*e+2)+h;break;case 7:a=r*(e/=z)*e*e*e+h;break;case 8:a=-r*((e=e/z-1)*e*e*e-1)+h;break;case 9:a=1>(e/=z/2)?r/2*e*e*e*e+h:-r/2*((e-=2)*e*e*e-2)+h;break;case 10:a=r*(e/=z)*e*e*e*e+h;break;case 11:a=r*
((e=e/z-1)*e*e*e*e+1)+h;break;case 12:a=1>(e/=z/2)?r/2*e*e*e*e*e+h:r/2*((e-=2)*e*e*e*e+2)+h;break;case 13:a=k.optimized?easeInCircle[integerize(e,z)]:-(Math.sqrt(1-e*e)-1);break;case 14:a=k.optimized?easeOutCircle[integerize(e,z)]:Math.sqrt(1-(e-1)*(e-1));break;case 15:a=k.optimized?easeInOutCircle[integerize(e,z)]:1>(e/=z/2)?-r/2*(Math.sqrt(1-e*e)-1)+h:r/2*(Math.sqrt(1-(e-=2)*e)+1)+h;break;case 16:k.optimized?a=easeInBack[integerize(e,z)]:(k=k.s,a=r*(e/=z)*e*((k+1)*e-k)+h);break;case 17:k.optimized?
a=easeOutBack[integerize(e,z)]:(k=k.s,a=r*((e=e/z-1)*e*((k+1)*e+k)+1)+h);break;case 18:k.optimized?a=easeInOutBack[integerize(e,z)]:(k=k.s,a=1>(e/=z/2)?r/2*e*e*(((k*=1.525)+1)*e-k)+h:r/2*((e-=2)*e*(((k*=1.525)+1)*e+k)+2)+h);break;case 19:k.optimized?a=easeInElasticArray[integerize(e,z)]:(a=k.a,b=k.p,e/=z,0==b&&(b=.3*z),0==a||a<Math.abs(r)?(a=r,k=b/4):k=b/(2*Math.PI)*Math.asin(r/a),a=-(a*Math.pow(2,10*--e)*Math.sin(2*(e*z-k)*Math.PI/b))+h);break;case 20:k.optimized?a=easeOutElasticArray[integerize(e,
z)]:(a=k.a,b=k.p,e/=z,0==b&&(b=.3*z),0==a||a<Math.abs(r)?(a=r,k=b/4):k=b/(2*Math.PI)*Math.asin(r/a),a=a*Math.pow(2,-10*e)*Math.sin(2*(e*z-k)*Math.PI/b)+r+h);break;case 21:k.optimized?a=easeInOutElasticArray[integerize(e,z)]:(a=k.a,b=k.p,e/=z/2,0==b&&(b=.3*z*1.5),0==a||a<Math.abs(r)?(a=r,k=b/4):k=b/(2*Math.PI)*Math.asin(r/a),a=1>e?-.5*a*Math.pow(2,10*--e)*Math.sin(2*(e*z-k)*Math.PI/b)+h:a*Math.pow(2,-10*--e)*Math.sin(2*(e*z-k)*Math.PI/b)*.5+r+h);break;case 22:a=k.optimized?r-easeOutBounceArray[integerize(z-
e,z)]+h:r-easeOutBouncefunc(z-e/z)+h;break;case 23:a=k.optimized?easeOutBounceArray[integerize(e,z)]:easeOutBouncefunc(e/z);break;case 24:a=k.optimized?e<z/2?.5*(r-easeOutBounceArray[integerize(z-2*e,z)]+h)+h:.5*easeOutBounceArray[integerize(2*e-z,z)]+.5*r+h:e<z/2?.5*(r-easeOutBouncefunc(z-2*e)+h)+h:.5*easeOutBouncefunc((2*e-z)/z)+.5*r+h;break;case 25:e=e/z/2;a=2*e*e*(3-2*e);break;case 26:e=(e/z+1)/2;a=2*e*e*(3-2*e)-1;break;case 27:e/=z,a=e*e*(3-2*e)}return N?r-h-a:a}
(function(){for(var b,e,h,r,z=0;z<=litetween_precision;z++)h=z/litetween_precision,b=(h/=1)<1/2.75?7.5625*h*h:h<2/2.75?7.5625*(h-=1.5/2.75)*h+.75:h<2.5/2.75?7.5625*(h-=2.25/2.75)*h+.9375:7.5625*(h-=2.625/2.75)*h+.984375,easeOutBounceArray[z]=b,h=z/litetween_precision,e=b=0,h/=1,0==e&&(e=.3),0==b||1>b?(b=1,r=e/4):r=e/(2*Math.PI)*Math.asin(1/b),b=-(b*Math.pow(2,10*--h)*Math.sin(2*(1*h-r)*Math.PI/e)),easeInElasticArray[z]=b,h=z/litetween_precision,e=b=0,h/=1,0==e&&(e=.3),0==b||1>b?(b=1,r=e/4):r=e/(2*
Math.PI)*Math.asin(1/b),b=b*Math.pow(2,-10*h)*Math.sin(2*(1*h-r)*Math.PI/e)+1,easeOutElasticArray[z]=b,h=z/litetween_precision,e=b=0,h/=.5,0==e&&(e=.3*1.5),0==b||1>b?(b=1,r=e/4):r=e/(2*Math.PI)*Math.asin(1/b),b=1>h?-.5*b*Math.pow(2,10*--h)*Math.sin(2*(1*h-r)*Math.PI/e):b*Math.pow(2,-10*--h)*Math.sin(2*(1*h-r)*Math.PI/e)*.5+1,easeInOutElasticArray[z]=b,h=z/litetween_precision,easeInCircle[z]=-(Math.sqrt(1-h*h)-1),h=z/litetween_precision,easeOutCircle[z]=Math.sqrt(1-(h-1)*(h-1)),h=z/litetween_precision,
b=1>(h/=.5)?-.5*(Math.sqrt(1-h*h)-1):.5*(Math.sqrt(1-(h-=2)*h)+1),easeInOutCircle[z]=b,h=z/litetween_precision,r=0,0==r&&(r=1.70158),b=(h/=1)*h*((r+1)*h-r),easeInBack[z]=b,h=z/litetween_precision,r=0,0==r&&(r=1.70158),b=(h=h/1-1)*h*((r+1)*h+r)+1,easeOutBack[z]=b,h=z/litetween_precision,r=0,0==r&&(r=1.70158),b=1>(h/=.5)?.5*h*h*(((r*=1.525)+1)*h-r):.5*((h-=2)*h*(((r*=1.525)+1)*h+r)+2),easeInOutBack[z]=b})();
var TweenObject=function(){return function(b,e,h,r,z,N,k){this.name=b;this.value=0;this.setInitial(r);this.setTarget(z);this.easefunc=h;this.tweened=e;this.duration=N;this.state=this.progress=0;this.onReverseEnd=this.onReverseStart=this.onEnd=this.onStart=!1;this.lastKnownValue2=this.lastKnownValue=0;this.enforce=k;this.pingpong=1;this.flipEase=!1;this.easingparam=[];this.lastState=1;for(b=0;28>b;b++)this.easingparam[b]={},this.easingparam[b].a=0,this.easingparam[b].p=0,this.easingparam[b].t=0,this.easingparam[b].s=
0,this.easingparam[b].optimized=!0}}();
(function(){TweenObject.prototype={};TweenObject.prototype.flipTarget=function(){var b=this.initialparam1,e=this.initialparam2;this.initialparam1=this.targetparam1;this.initialparam2=this.targetparam2;this.targetparam1=b;this.targetparam2=e;this.lastKnownValue2=this.lastKnownValue=0};TweenObject.prototype.setInitial=function(b){this.initialparam1=parseFloat(b.split(",")[0]);this.initialparam2=parseFloat(b.split(",")[1]);this.lastKnownValue2=this.lastKnownValue=0};TweenObject.prototype.setTarget=function(b){this.targetparam1=
parseFloat(b.split(",")[0]);this.targetparam2=parseFloat(b.split(",")[1]);isNaN(this.targetparam2)&&(this.targetparam2=this.targetparam1)};TweenObject.prototype.OnTick=function(b){if(0===this.state)return-1;1===this.state&&(this.progress+=b);2===this.state&&(this.progress-=b);3===this.state&&(this.state=0);if(4===this.state||6===this.state)this.progress+=b*this.pingpong;5===this.state&&(this.progress+=b*this.pingpong);return 0>this.progress?(this.progress=0,4===this.state?this.pingpong=1:6===this.state?
(this.pingpong=1,this.flipEase=!1):this.state=0,this.onReverseEnd=!0,0):this.progress>this.duration?(this.progress=this.duration,4===this.state?this.pingpong=-1:6===this.state?(this.pingpong=-1,this.flipEase=!0):5===this.state?this.progress=0:this.state=0,this.onEnd=!0,1):this.flipEase?easeFunc(this.easefunc,this.duration-this.progress,0,1,this.duration,this.flipEase,this.easingparam[this.easefunc]):easeFunc(this.easefunc,this.progress,0,1,this.duration,this.flipEase,this.easingparam[this.easefunc])}})();
function trim(b){return b.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}cr.behaviors.lunarray_LiteTween=function(b){this.runtime=b};
(function(){var b=cr.behaviors.lunarray_LiteTween.prototype;b.Type=function(h,r){this.behavior=h;this.objtype=r;this.runtime=h.runtime};b.Type.prototype.onCreate=function(){};b.Instance=function(h,r){this.type=h;this.behavior=h.behavior;this.inst=r;this.runtime=h.runtime;this.i=0};var e=b.Instance.prototype;e.onCreate=function(){this.playmode=this.properties[0];this.active=1==this.playmode||2==this.playmode||3==this.playmode||4==this.playmode;this.tweened=this.properties[1];this.easing=this.properties[2];
this.target=this.properties[3];this.targetmode=this.properties[4];this.useCurrent=!1;1===this.targetmode&&(this.target="relative("+this.target+")");this.duration=this.properties[5];this.enforce=1===this.properties[6];this.value=0;this.tween_list={};this.addToTweenList("default",this.tweened,this.easing,"current",this.target,this.duration,this.enforce);1===this.properties[0]&&this.startTween(0);2===this.properties[0]&&this.startTween(2);3===this.properties[0]&&this.startTween(3);4===this.properties[0]&&
this.startTween(4)};e.parseCurrent=function(h,r){void 0===r&&(r="current");var z=trim(r);r=trim(r);var N=this.value;if("current"===r)switch(h){case 0:z=this.inst.x+","+this.inst.y;break;case 1:z=this.inst.width+","+this.inst.height;break;case 2:z=this.inst.width+","+this.inst.height;break;case 3:z=this.inst.width+","+this.inst.height;break;case 4:z=cr.to_degrees(this.inst.angle)+","+cr.to_degrees(this.inst.angle);break;case 5:z=100*this.inst.opacity+","+100*this.inst.opacity;break;case 6:z=N+","+
N;break;case 7:z=this.inst.x+","+this.inst.y;break;case 8:z=this.inst.x+","+this.inst.y;break;case 9:z=void 0!==this.inst.curFrame?this.inst.width/this.inst.curFrame.width+","+this.inst.height/this.inst.curFrame.height:"1,1"}if("relative"===r.substring(0,8)){if(r=r.match(/\((.*?)\)/))var k=parseFloat(r[1].split(",")[0]),a=parseFloat(r[1].split(",")[1]);isNaN(k)&&(k=0);isNaN(a)&&(a=0);switch(h){case 0:z=this.inst.x+k+","+(this.inst.y+a);break;case 1:z=this.inst.width+k+","+(this.inst.height+a);break;
case 2:z=this.inst.width+k+","+(this.inst.height+a);break;case 3:z=this.inst.width+k+","+(this.inst.height+a);break;case 4:z=cr.to_degrees(this.inst.angle)+k+","+(cr.to_degrees(this.inst.angle)+a);break;case 5:z=100*this.inst.opacity+k+","+(100*this.inst.opacity+a);break;case 6:z=N+k+","+N+k;break;case 7:z=this.inst.x+k+","+this.inst.y;break;case 8:z=this.inst.x+","+(this.inst.y+k);break;case 9:z=k+","+a}}return z};e.addToTweenList=function(h,r,z,N,k,a,c){N=this.parseCurrent(r,N);k=this.parseCurrent(r,
k);void 0!==this.tween_list[h]&&delete this.tween_list[h];this.tween_list[h]=new TweenObject(h,r,z,N,k,a,c);this.tween_list[h].dt=0};e.saveToJSON=function(){JSON.stringify(this.tween_list["default"]);return{playmode:this.playmode,active:this.active,tweened:this.tweened,easing:this.easing,target:this.target,targetmode:this.targetmode,useCurrent:this.useCurrent,duration:this.duration,enforce:this.enforce,value:this.value,tweenlist:JSON.stringify(this.tween_list["default"])}};TweenObject.Load=function(h,
r,z,N,k,a,c,l){r=new TweenObject(r,z,N,k,a,c,l);for(var q in h)r[q]=h[q];return r};e.loadFromJSON=function(h){var r=JSON.parse(h.tweenlist);r=TweenObject.Load(r,r.name,r.tweened,r.easefunc,r.initialparam1+","+r.initialparam2,r.targetparam1+","+r.targetparam2,r.duration,r.enforce);this.tween_list["default"]=r;this.playmode=h.playmode;this.active=h.active;this.movement=h.tweened;this.easing=h.easing;this.target=h.target;this.targetmode=h.targetmode;this.useCurrent=h.useCurrent;this.duration=h.duration;
this.enforce=h.enforce;this.value=h.value};e.setProgressTo=function(h){1<h&&(h=1);0>h&&(h=0);for(var r in this.tween_list){var z=this.tween_list[r];z.lastKnownValue=0;z.lastKnownValue2=0;z.state=3;z.progress=h*z.duration;var N=z.OnTick(0);this.updateTween(z,N)}};e.startTween=function(h){for(var r in this.tween_list){var z=this.tween_list[r];if(this.useCurrent){var N=this.parseCurrent(z.tweened,"current"),k=this.parseCurrent(z.tweened,this.target);z.setInitial(N);z.setTarget(k)}0===h&&(z.progress=
1E-6,z.lastKnownValue=0,z.lastKnownValue2=0,z.onStart=!0,z.state=1);1===h&&(z.state=z.lastState);if(2===h||4===h)z.progress=1E-6,z.lastKnownValue=0,z.lastKnownValue2=0,z.onStart=!0,2==h&&(z.state=4),4==h&&(z.state=6);3===h&&(z.progress=1E-6,z.lastKnownValue=0,z.lastKnownValue2=0,z.onStart=!0,z.state=5)}};e.stopTween=function(h){for(var r in this.tween_list){var z=this.tween_list[r];3!=z.state&&0!=z.state&&(z.lastState=z.state);1===h&&(z.progress=0);2===h&&(z.progress=z.duration);z.state=3;var N=z.OnTick(0);
this.updateTween(z,N)}};e.reverseTween=function(h){for(var r in this.tween_list){var z=this.tween_list[r];1===h&&(z.progress=z.duration,z.lastKnownValue=0,z.lastKnownValue2=0,z.onReverseStart=!0);z.state=2}};e.updateTween=function(h,r){if(0===h.tweened)h.enforce?(this.inst.x=h.initialparam1+(h.targetparam1-h.initialparam1)*r,this.inst.y=h.initialparam2+(h.targetparam2-h.initialparam2)*r):(this.inst.x+=(h.targetparam1-h.initialparam1)*r-h.lastKnownValue,this.inst.y+=(h.targetparam2-h.initialparam2)*
r-h.lastKnownValue2,h.lastKnownValue=(h.targetparam1-h.initialparam1)*r,h.lastKnownValue2=(h.targetparam2-h.initialparam2)*r);else if(1===h.tweened)h.enforce?(this.inst.width=h.initialparam1+(h.targetparam1-h.initialparam1)*r,this.inst.height=h.initialparam2+(h.targetparam2-h.initialparam2)*r):(this.inst.width+=(h.targetparam1-h.initialparam1)*r-h.lastKnownValue,this.inst.height+=(h.targetparam2-h.initialparam2)*r-h.lastKnownValue2,h.lastKnownValue=(h.targetparam1-h.initialparam1)*r,h.lastKnownValue2=
(h.targetparam2-h.initialparam2)*r);else if(2===h.tweened)h.enforce?this.inst.width=h.initialparam1+(h.targetparam1-h.initialparam1)*r:(this.inst.width+=(h.targetparam1-h.initialparam1)*r-h.lastKnownValue,h.lastKnownValue=(h.targetparam1-h.initialparam1)*r);else if(3===h.tweened)h.enforce?this.inst.height=h.initialparam2+(h.targetparam2-h.initialparam2)*r:(this.inst.height+=(h.targetparam2-h.initialparam2)*r-h.lastKnownValue2,h.lastKnownValue2=(h.targetparam2-h.initialparam2)*r);else if(4===h.tweened)if(h.enforce){var z=
h.initialparam1+(h.targetparam1-h.initialparam1)*r;this.inst.angle=cr.clamp_angle(cr.to_radians(z))}else z=(h.targetparam1-h.initialparam1)*r-h.lastKnownValue,this.inst.angle=cr.clamp_angle(this.inst.angle+cr.to_radians(z)),h.lastKnownValue=(h.targetparam1-h.initialparam1)*r;else if(5===h.tweened)h.enforce?this.inst.opacity=(h.initialparam1+(h.targetparam1-h.initialparam1)*r)/100:(this.inst.opacity+=((h.targetparam1-h.initialparam1)*r-h.lastKnownValue)/100,h.lastKnownValue=(h.targetparam1-h.initialparam1)*
r);else if(6===h.tweened)h.enforce?this.value=h.initialparam1+(h.targetparam1-h.initialparam1)*r:(this.value+=(h.targetparam1-h.initialparam1)*r-h.lastKnownValue,h.lastKnownValue=(h.targetparam1-h.initialparam1)*r);else if(7===h.tweened)h.enforce?this.inst.x=h.initialparam1+(h.targetparam1-h.initialparam1)*r:(this.inst.x+=(h.targetparam1-h.initialparam1)*r-h.lastKnownValue,h.lastKnownValue=(h.targetparam1-h.initialparam1)*r);else if(8===h.tweened)h.enforce?this.inst.y=h.initialparam2+(h.targetparam2-
h.initialparam2)*r:(this.inst.y+=(h.targetparam2-h.initialparam2)*r-h.lastKnownValue2,h.lastKnownValue2=(h.targetparam2-h.initialparam2)*r);else if(9===h.tweened){z=h.initialparam1+(h.targetparam1-h.initialparam1)*r;var N=h.initialparam2+(h.targetparam2-h.initialparam2)*r;0>this.inst.width&&(z=h.initialparam1+(h.targetparam1+h.initialparam1)*-r);0>this.inst.height&&(N=h.initialparam2+(h.targetparam2+h.initialparam2)*-r);h.enforce?(this.inst.width=this.inst.curFrame.width*z,this.inst.height=this.inst.curFrame.height*
N):(0>this.inst.width?(this.inst.width=this.inst.width/(-1+h.lastKnownValue)*z,h.lastKnownValue=z+1):(this.inst.width=this.inst.width/(1+h.lastKnownValue)*z,h.lastKnownValue=z-1),0>this.inst.height?(this.inst.height=this.inst.height/(-1+h.lastKnownValue2)*N,h.lastKnownValue2=N+1):(this.inst.height=this.inst.height/(1+h.lastKnownValue2)*N,h.lastKnownValue2=N-1))}this.inst.set_bbox_changed()};e.tick=function(){var h=this.runtime.getDt(this.inst),r=this.tween_list["default"];0!==r.state&&(r.onStart&&
(this.runtime.trigger(cr.behaviors.lunarray_LiteTween.prototype.cnds.OnStart,this.inst),r.onStart=!1),r.onReverseStart&&(this.runtime.trigger(cr.behaviors.lunarray_LiteTween.prototype.cnds.OnReverseStart,this.inst),r.onReverseStart=!1),this.active=1==r.state||2==r.state||4==r.state||5==r.state||6==r.state,h=r.OnTick(h),this.updateTween(r,h),r.onEnd&&(this.runtime.trigger(cr.behaviors.lunarray_LiteTween.prototype.cnds.OnEnd,this.inst),r.onEnd=!1),r.onReverseEnd&&(this.runtime.trigger(cr.behaviors.lunarray_LiteTween.prototype.cnds.OnReverseEnd,
this.inst),r.onReverseEnd=!1))};b.cnds={};e=b.cnds;e.IsActive=function(){return 0!==this.tween_list["default"].state};e.IsReversing=function(){return 2==this.tween_list["default"].state};e.CompareProgress=function(h,r){var z=this.tween_list["default"];return cr.do_cmp(z.progress/z.duration,h,r)};e.OnThreshold=function(h,r){var z=this.tween_list["default"];this.threshold=cr.do_cmp(z.progress/z.duration,h,r);if(h=this.oldthreshold!=this.threshold&&this.threshold)this.oldthreshold=this.threshold;return h};
e.OnStart=function(){return void 0===this.tween_list["default"]?!1:this.tween_list["default"].onStart};e.OnReverseStart=function(){return void 0===this.tween_list["default"]?!1:this.tween_list["default"].onReverseStart};e.OnEnd=function(){return void 0===this.tween_list["default"]?!1:this.tween_list["default"].onEnd};e.OnReverseEnd=function(){return void 0===this.tween_list["default"]?!1:this.tween_list["default"].onReverseEnd};b.acts={};e=b.acts;e.Start=function(h,r){this.oldthreshold=this.threshold=
!1;this.useCurrent=1==r;this.startTween(h)};e.Stop=function(h){this.stopTween(h)};e.Reverse=function(h){this.oldthreshold=this.threshold=!1;this.reverseTween(h)};e.ProgressTo=function(h){this.setProgressTo(h)};e.SetDuration=function(h){isNaN(h)||0>h||void 0===this.tween_list["default"]||(this.tween_list["default"].duration=h)};e.SetEnforce=function(h){void 0!==this.tween_list["default"]&&(this.tween_list["default"].enforce=1===h)};e.SetInitial=function(h){void 0!==this.tween_list["default"]&&(h=this.parseCurrent(this.tween_list["default"].tweened,
h),this.tween_list["default"].setInitial(h))};e.SetTarget=function(h,r,z){if(void 0!==this.tween_list["default"]&&!isNaN(z)){var N=this.tween_list["default"],k=z+"";this.targetmode=r;var a="",c="";if(1===r){this.target="relative("+k+")";switch(h){case 0:a=this.inst.x+z;c=N.targetparam2;break;case 1:a=N.targetparam1;c=this.inst.y+z;break;case 2:c=a=""+cr.to_degrees(this.inst.angle+cr.to_radians(z));break;case 3:c=a=""+100*this.inst.opacity+z;break;case 4:a=this.inst.width+z;c=N.targetparam2;break;
case 5:a=N.targetparam1;c=this.inst.height+z;break;case 6:c=a=z}k=a+","+c}else{switch(h){case 0:a=z;c=N.targetparam2;break;case 1:a=N.targetparam1;c=z;break;case 2:c=a=z;break;case 3:c=a=z;break;case 4:a=z;c=N.targetparam2;break;case 5:a=N.targetparam1;c=z;break;case 6:c=a=z}this.target=k=a+","+c}h=this.parseCurrent(this.tween_list["default"].tweened,"current");k=this.parseCurrent(this.tween_list["default"].tweened,k);N.setInitial(h);N.setTarget(k)}};e.SetTweenedProperty=function(h){void 0!==this.tween_list["default"]&&
(this.tween_list["default"].tweened=h)};e.SetEasing=function(h){void 0!==this.tween_list["default"]&&(this.tween_list["default"].easefunc=h)};e.SetEasingParam=function(h,r,z,N,k){void 0!==this.tween_list["default"]&&(this.tween_list["default"].easingparam[h].optimized=!1,this.tween_list["default"].easingparam[h].a=r,this.tween_list["default"].easingparam[h].p=z,this.tween_list["default"].easingparam[h].t=N,this.tween_list["default"].easingparam[h].s=k)};e.ResetEasingParam=function(){void 0!==this.tween_list["default"]&&
(this.tween_list["default"].optimized=!0)};e.SetValue=function(h){var r=this.tween_list["default"];this.value=h;6===r.tweened&&r.setInitial(this.parseCurrent(r.tweened,"current"))};e.SetParameter=function(h,r,z,N,k){if(void 0===this.tween_list["default"])this.addToTweenList("default",h,r,initial,z,N,k,0);else{var a=this.tween_list["default"];a.tweened=h;a.easefunc=r;a.setInitial(this.parseCurrent(h,"current"));a.setTarget(this.parseCurrent(h,z));a.duration=N;a.enforce=1===k}};b.exps={};b=b.exps;b.State=
function(h){var r="N/A";switch(this.tween_list["default"].state){case 0:r="paused";break;case 1:r="playing";break;case 2:r="reversing";break;case 3:r="seeking"}h.set_string(r)};b.Progress=function(h){h.set_float(this.tween_list["default"].progress/this.tween_list["default"].duration)};b.Duration=function(h){h.set_float(this.tween_list["default"].duration)};b.Target=function(h){var r=this.tween_list["default"],z="N/A";switch(r.tweened){case 0:z=r.targetparam1;break;case 1:z=r.targetparam2;break;case 2:z=
r.targetparam1;break;case 3:z=r.targetparam1;break;case 4:z=r.targetparam1;break;case 5:z=r.targetparam2;break;case 6:z=r.targetparam1}h.set_float(z)};b.Value=function(h){h.set_float(this.value)};b.Tween=function(h,r,z,N,k){N=1<N?1:N;k=easeFunc(k,0>N?0:N,0,1,1,!1,!1);h.set_float(r+k*(z-r))}})();
cr.getObjectRefTable=function(){return[cr.plugins_.Sprite,cr.plugins_.Touch,cr.plugins_.Arr,cr.plugins_.Function,cr.plugins_.Audio,cr.plugins_.Keyboard,cr.plugins_.Particles,cr.behaviors.Rotate,cr.plugins_.LocalStorage,cr.plugins_.Text,cr.plugins_.TextBox,cr.plugins_.AJAX,cr.plugins_.TiledBg,cr.behaviors.lunarray_LiteTween,cr.system_object.prototype.cnds.OnLayoutStart,cr.plugins_.Arr.prototype.acts.Clear,cr.system_object.prototype.acts.SetVar,cr.system_object.prototype.acts.SetTimescale,cr.plugins_.Sprite.prototype.acts.Destroy,
cr.system_object.prototype.exps.layoutwidth,cr.system_object.prototype.exps.layoutheight,cr.plugins_.Arr.prototype.acts.SetSize,cr.plugins_.Text.prototype.acts.SetVisible,cr.plugins_.Sprite.prototype.acts.SetVisible,cr.plugins_.Touch.prototype.cnds.OnTouchObject,cr.system_object.prototype.cnds.CompareVar,cr.plugins_.Audio.prototype.acts.SetPaused,cr.system_object.prototype.cnds.Else,cr.system_object.prototype.cnds.ForEach,cr.plugins_.Sprite.prototype.acts.SetSize,cr.plugins_.Touch.prototype.cnds.IsTouchingObject,
cr.plugins_.Sprite.prototype.cnds.IsBoolInstanceVarSet,cr.plugins_.Sprite.prototype.acts.SetAnimFrame,cr.plugins_.Arr.prototype.acts.SetXY,cr.plugins_.Sprite.prototype.exps.UID,cr.plugins_.Sprite.prototype.exps.X,cr.plugins_.Sprite.prototype.exps.Y,cr.system_object.prototype.cnds.CompareBetween,cr.system_object.prototype.exps.distance,cr.plugins_.Arr.prototype.exps.At,cr.plugins_.Function.prototype.acts.CallFunction,cr.plugins_.Sprite.prototype.cnds.CompareInstanceVar,cr.plugins_.Sprite.prototype.acts.SetPos,
cr.system_object.prototype.exps.lerp,cr.plugins_.Sprite.prototype.cnds.CompareX,cr.system_object.prototype.exps.clamp,cr.plugins_.Sprite.prototype.cnds.CompareY,cr.plugins_.Sprite.prototype.acts.SetInstanceVar,cr.system_object.prototype.exps.int,cr.plugins_.Touch.prototype.cnds.OnTouchEnd,cr.plugins_.Function.prototype.cnds.OnFunction,cr.plugins_.Arr.prototype.cnds.ArrForEach,cr.plugins_.Arr.prototype.cnds.CompareCurrent,cr.system_object.prototype.acts.CreateObject,cr.plugins_.Arr.prototype.exps.CurY,
cr.plugins_.Sprite.prototype.acts.SetCollisions,cr.plugins_.Sprite.prototype.acts.SetY,cr.plugins_.Arr.prototype.exps.CurX,cr.plugins_.Arr.prototype.acts.SetXYZ,cr.system_object.prototype.exps.random,cr.plugins_.Sprite.prototype.acts.SetAnim,cr.plugins_.Sprite.prototype.acts.SetBoolInstanceVar,cr.system_object.prototype.cnds.For,cr.plugins_.Function.prototype.exps.Param,cr.system_object.prototype.exps.loopindex,cr.plugins_.Sprite.prototype.acts.MoveAtAngle,cr.plugins_.Audio.prototype.acts.Play,cr.system_object.prototype.acts.AddVar,
cr.plugins_.Sprite.prototype.acts.MoveToBottom,cr.plugins_.Sprite.prototype.cnds.IsAnimPlaying,cr.plugins_.Sprite.prototype.acts.Spawn,cr.plugins_.Arr.prototype.cnds.Contains,cr.system_object.prototype.acts.Wait,cr.system_object.prototype.cnds.Compare,cr.plugins_.Sprite.prototype.cnds.PickByUID,cr.system_object.prototype.exps.dt,cr.system_object.prototype.cnds.Every,cr.plugins_.Sprite.prototype.cnds.IsOverlapping,cr.system_object.prototype.cnds.TriggerOnce,cr.system_object.prototype.cnds.OnLayoutEnd,
cr.system_object.prototype.cnds.EveryTick,cr.plugins_.Text.prototype.acts.SetText,cr.system_object.prototype.acts.SubVar,cr.system_object.prototype.acts.GoToLayout,cr.plugins_.LocalStorage.prototype.acts.SetItem,cr.plugins_.Sprite.prototype.cnds.IsOnScreen,cr.system_object.prototype.acts.RestartLayout,cr.system_object.prototype.acts.ResetGlobals,cr.plugins_.LocalStorage.prototype.acts.CheckItemExists,cr.plugins_.LocalStorage.prototype.cnds.OnItemMissing,cr.plugins_.LocalStorage.prototype.cnds.OnItemExists,
cr.plugins_.LocalStorage.prototype.acts.GetItem,cr.plugins_.LocalStorage.prototype.exps.ItemValue,cr.plugins_.LocalStorage.prototype.cnds.OnItemGet,cr.plugins_.Keyboard.prototype.cnds.OnKey,cr.plugins_.LocalStorage.prototype.acts.ClearStorage,cr.plugins_.Sprite.prototype.acts.SetOpacity,cr.plugins_.Audio.prototype.cnds.IsAnyPlaying,cr.plugins_.Touch.prototype.cnds.OnTapGestureObject,cr.behaviors.lunarray_LiteTween.prototype.acts.Start,cr.plugins_.TiledBg.prototype.acts.SetSize,cr.plugins_.Sprite.prototype.acts.SetPosToObject,
cr.behaviors.lunarray_LiteTween.prototype.cnds.OnEnd,cr.system_object.prototype.exps.zeropad,cr.plugins_.TextBox.prototype.cnds.OnTextChanged,cr.plugins_.TextBox.prototype.acts.SetEnabled,cr.system_object.prototype.cnds.RegexTest,cr.plugins_.TextBox.prototype.exps.Text,cr.system_object.prototype.exps.len,cr.plugins_.TextBox.prototype.acts.SetText,cr.system_object.prototype.exps.left,cr.system_object.prototype.exps.urlencode,cr.system_object.prototype.exps.floor,cr.system_object.prototype.exps.mid,
cr.plugins_.AJAX.prototype.acts.Post,cr.plugins_.TextBox.prototype.acts.SetVisible,cr.system_object.prototype.cnds.IsGroupActive,cr.plugins_.AJAX.prototype.cnds.OnProgress,cr.plugins_.AJAX.prototype.cnds.OnComplete,cr.plugins_.AJAX.prototype.exps.LastData]};
self.C3_JsPropNameTable=[{Block:0},{Col1:0},{Col2:0},{Touch:0},{SwapArray:0},{MainArray:0},{Function:0},{Audio:0},{Keyboard:0},{Particles:0},{PopUp:0},{Rotate:0},{Replybtn:0},{LocalStorage:0},{LoadingBar:0},{Sprite:0},{Sprite4:0},{Particles2:0},{Particles3:0},{Particles4:0},{Particles5:0},{Particles6:0},{Sprite5:0},{Sprite6:0},{Sprite7:0},{Sprite8:0},{black:0},{Sprite2:0},{menuplaybtn:0},{Sprite9:0},{Sprite10:0},{Sprite11:0},{FinalScore:0},{Textyours:0},{Texthi:0},{yourscoretxt:0},{yourhiscoretxt:0},
{Timer:0},{Sprite14:0},{Sprite15:0},{Sprite18:0},{Discore:0},{final:0},{Display:0},{NameText:0},{NameInput:0},{EmailText:0},{EmailInput:0},{Text2:0},{PhoneInput:0},{Confirmation:0},{replay:0},{home:0},{bg:0},{over:0},{submit_button:0},{Top_10:0},{High:0},{decor:0},{Top10:0},{Temp:0},{AJAX:0},{help:0},{LiteTween:0},{LiteTween2:0},{opacity:0},{instructions:0},{cross:0},{Group:0},{Mnemonic_main_page:0},{Mobile:0},{Untitled:0},{Input:0},{Pause:0},{HighScore:0},{GameOn:0},{Point:0},{IsMatched:0},{IsMoving:0},
{X:0},{Y:0},{On:0},{IsTouched:0},{Tile:0},{s:0},{web_app_url:0},{value0:0},{value1:0},{value2:0},{sum:0},{string0:0},{string1:0},{string2:0}];
